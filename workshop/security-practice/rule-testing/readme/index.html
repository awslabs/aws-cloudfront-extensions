<!doctype html><html lang=en class="js csstransforms3d"><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=generator content="Hugo 0.79.1"><meta name=description content><link rel="shortcut icon" href=https://awslabs.github.io/aws-cloudfront-extensions/workshop/images/favicon.ico type=image/x-icon><title>Web ACLs and Managed Rules :: CloudFront Extensions</title><link href=https://awslabs.github.io/aws-cloudfront-extensions/workshop/css/nucleus.css?1662538309 rel=stylesheet><link href=https://awslabs.github.io/aws-cloudfront-extensions/workshop/css/fontawesome-all.min.css?1662538309 rel=stylesheet><link href=https://awslabs.github.io/aws-cloudfront-extensions/workshop/css/hybrid.css?1662538309 rel=stylesheet><link href=https://awslabs.github.io/aws-cloudfront-extensions/workshop/css/featherlight.min.css?1662538309 rel=stylesheet><link href=https://awslabs.github.io/aws-cloudfront-extensions/workshop/css/perfect-scrollbar.min.css?1662538309 rel=stylesheet><link href=https://awslabs.github.io/aws-cloudfront-extensions/workshop/css/auto-complete.css?1662538309 rel=stylesheet><link href=https://awslabs.github.io/aws-cloudfront-extensions/workshop/css/atom-one-dark-reasonable.css?1662538309 rel=stylesheet><link href=https://awslabs.github.io/aws-cloudfront-extensions/workshop/css/theme.css?1662538309 rel=stylesheet><link href=https://awslabs.github.io/aws-cloudfront-extensions/workshop/css/hugo-theme.css?1662538309 rel=stylesheet><link href=https://awslabs.github.io/aws-cloudfront-extensions/workshop/css/theme-cloudfrontext.css?1662538309 rel=stylesheet><script src=https://awslabs.github.io/aws-cloudfront-extensions/workshop/js/jquery-3.3.1.min.js?1662538309></script><style>:root #header+#content>#left>#rlblock_left{display:none!important}</style></head><body data-url=https://awslabs.github.io/aws-cloudfront-extensions/workshop/security-practice/rule-testing/readme/><nav id=sidebar><div id=header-wrapper><div id=header><a id=logo href=https://awslabs.github.io/aws-cloudfront-extensions/workshop/><img src=https://awslabs.github.io/aws-cloudfront-extensions/workshop/images/logo.png alt="AWS Logo" width=44% height=44%></a></div><div class=searchbox><label for=search-by><i class="fas fa-search"></i></label><input data-search-input id=search-by type=search placeholder=Search...>
<span data-search-clear><i class="fas fa-times"></i></span></div><script type=text/javascript src=https://awslabs.github.io/aws-cloudfront-extensions/workshop/js/lunr.min.js?1662538309></script><script type=text/javascript src=https://awslabs.github.io/aws-cloudfront-extensions/workshop/js/auto-complete.js?1662538309></script><script type=text/javascript>var baseurl="https:\/\/awslabs.github.io\/aws-cloudfront-extensions\/workshop\/";</script><script type=text/javascript src=https://awslabs.github.io/aws-cloudfront-extensions/workshop/js/search.js?1662538309></script></div><div class=highlightable><ul class=topics><li data-nav-id=/prerequisite/ title=Prerequisite class=dd-item><a href=https://awslabs.github.io/aws-cloudfront-extensions/workshop/prerequisite/>Prerequisite</a><ul><li data-nav-id=/prerequisite/aws-cloudshell/readme/ title="AWS CloudShell" class=dd-item><a href=https://awslabs.github.io/aws-cloudfront-extensions/workshop/prerequisite/aws-cloudshell/readme/>AWS CloudShell</a></li><li data-nav-id=/prerequisite/aws-cdk/readme/ title="AWS CDK" class=dd-item><a href=https://awslabs.github.io/aws-cloudfront-extensions/workshop/prerequisite/aws-cdk/readme/>AWS CDK</a></li><li data-nav-id=/prerequisite/aws-config/readme/ title="Configure your credentials" class=dd-item><a href=https://awslabs.github.io/aws-cloudfront-extensions/workshop/prerequisite/aws-config/readme/>Configure your credentials</a></li></ul></li><li data-nav-id=/deploy/ title="Deploy with CloudFront Extensions" class=dd-item><a href=https://awslabs.github.io/aws-cloudfront-extensions/workshop/deploy/>Deploy with CloudFront Extensions</a><ul><li data-nav-id=/deploy/deploy-auth/readme/ title="Deploy a Lambda@Edge function to authenticate with Cognito" class=dd-item><a href=https://awslabs.github.io/aws-cloudfront-extensions/workshop/deploy/deploy-auth/readme/>Deploy a Lambda@Edge function to authenticate with Cognito</a></li><li data-nav-id=/deploy/deploy-device/readme/ title="Deploy a Lambda@Edge function to serve based on devices" class=dd-item><a href=https://awslabs.github.io/aws-cloudfront-extensions/workshop/deploy/deploy-device/readme/>Deploy a Lambda@Edge function to serve based on devices</a></li></ul></li><li data-nav-id=/develop/ title="Develop with CloudFront Extensions" class=dd-item><a href=https://awslabs.github.io/aws-cloudfront-extensions/workshop/develop/>Develop with CloudFront Extensions</a><ul><li data-nav-id=/develop/cloudfront-distribution/readme/ title="Create a CloudFront Distribution" class=dd-item><a href=https://awslabs.github.io/aws-cloudfront-extensions/workshop/develop/cloudfront-distribution/readme/>Create a CloudFront Distribution</a></li><li data-nav-id=/develop/download-code/readme/ title="Upload CloudFront Extensions code into CloudShell" class=dd-item><a href=https://awslabs.github.io/aws-cloudfront-extensions/workshop/develop/download-code/readme/>Upload CloudFront Extensions code into CloudShell</a></li><li data-nav-id=/develop/code-structure/readme/ title="Understand CloudFront Extensions code structure" class=dd-item><a href=https://awslabs.github.io/aws-cloudfront-extensions/workshop/develop/code-structure/readme/>Understand CloudFront Extensions code structure</a></li><li data-nav-id=/develop/edge-function/readme/ title="Create a Lambda@Edge function" class=dd-item><a href=https://awslabs.github.io/aws-cloudfront-extensions/workshop/develop/edge-function/readme/>Create a Lambda@Edge function</a></li><li data-nav-id=/develop/test-function/readme/ title="Test the Lambda@Edge function" class=dd-item><a href=https://awslabs.github.io/aws-cloudfront-extensions/workshop/develop/test-function/readme/>Test the Lambda@Edge function</a></li><li data-nav-id=/develop/trigger-function/readme/ title="Trigger from CloudFront" class=dd-item><a href=https://awslabs.github.io/aws-cloudfront-extensions/workshop/develop/trigger-function/readme/>Trigger from CloudFront</a></li></ul></li><li data-nav-id=/security/ title="WAF & Shield Deployment" class=dd-item><a href=https://awslabs.github.io/aws-cloudfront-extensions/workshop/security/>WAF & Shield Deployment</a><ul><li data-nav-id=/security/guide/readme/ title=Deployment class=dd-item><a href=https://awslabs.github.io/aws-cloudfront-extensions/workshop/security/guide/readme/>Deployment</a></li></ul></li><li data-nav-id=/security-practice/ title="WAF & Shield Best Practice" class="dd-item
parent"><a href=https://awslabs.github.io/aws-cloudfront-extensions/workshop/security-practice/>WAF & Shield Best Practice</a><ul><li data-nav-id=/security-practice/juice-shop/readme/ title="Deploy OWASP Juice Shop" class=dd-item><a href=https://awslabs.github.io/aws-cloudfront-extensions/workshop/security-practice/juice-shop/readme/>Deploy OWASP Juice Shop</a></li><li data-nav-id=/security-practice/deploy/readme/ title="Deploy WAF & Shield Automations" class=dd-item><a href=https://awslabs.github.io/aws-cloudfront-extensions/workshop/security-practice/deploy/readme/>Deploy WAF & Shield Automations</a></li><li data-nav-id=/security-practice/rule-testing/readme/ title="Web ACLs and Managed Rules" class="dd-item active"><a href=https://awslabs.github.io/aws-cloudfront-extensions/workshop/security-practice/rule-testing/readme/>Web ACLs and Managed Rules</a></li><li data-nav-id=/security-practice/flood-testing/readme/ title="Prevent DDoS attacks" class=dd-item><a href=https://awslabs.github.io/aws-cloudfront-extensions/workshop/security-practice/flood-testing/readme/>Prevent DDoS attacks</a></li></ul></li><li data-nav-id=/contribution/ title=Contribution class=dd-item><a href=https://awslabs.github.io/aws-cloudfront-extensions/workshop/contribution/>Contribution</a><ul><li data-nav-id=/contribution/pr/readme/ title="Contributing via pull requests" class=dd-item><a href=https://awslabs.github.io/aws-cloudfront-extensions/workshop/contribution/pr/readme/>Contributing via pull requests</a></li><li data-nav-id=/contribution/bug-report/readme/ title="Reporting issues" class=dd-item><a href=https://awslabs.github.io/aws-cloudfront-extensions/workshop/contribution/bug-report/readme/>Reporting issues</a></li></ul></li><li data-nav-id=/cleanup/ title=Cleanup class=dd-item><a href=https://awslabs.github.io/aws-cloudfront-extensions/workshop/cleanup/>Cleanup</a><ul><li data-nav-id=/cleanup/s3-bucket/readme/ title="S3 bucket" class=dd-item><a href=https://awslabs.github.io/aws-cloudfront-extensions/workshop/cleanup/s3-bucket/readme/>S3 bucket</a></li><li data-nav-id=/cleanup/cognito-user-pool/readme/ title="Cognito User Pool" class=dd-item><a href=https://awslabs.github.io/aws-cloudfront-extensions/workshop/cleanup/cognito-user-pool/readme/>Cognito User Pool</a></li><li data-nav-id=/cleanup/cf-distribution/readme/ title="CloudFront distribution" class=dd-item><a href=https://awslabs.github.io/aws-cloudfront-extensions/workshop/cleanup/cf-distribution/readme/>CloudFront distribution</a></li><li data-nav-id=/cleanup/cloudformation/readme/ title=CloudFormation class=dd-item><a href=https://awslabs.github.io/aws-cloudfront-extensions/workshop/cleanup/cloudformation/readme/>CloudFormation</a></li><li data-nav-id=/cleanup/cloudshell/readme/ title=CloudShell class=dd-item><a href=https://awslabs.github.io/aws-cloudfront-extensions/workshop/cleanup/cloudshell/readme/>CloudShell</a></li><li data-nav-id=/cleanup/waf/readme/ title="WAF & Shield Automations" class=dd-item><a href=https://awslabs.github.io/aws-cloudfront-extensions/workshop/cleanup/waf/readme/>WAF & Shield Automations</a></li></ul></li><li data-nav-id=/reference/ title="Reference & Resources" class=dd-item><a href=https://awslabs.github.io/aws-cloudfront-extensions/workshop/reference/>Reference & Resources</a></li></ul><section id=prefooter><hr><ul><li><a class=padding><i class="fas fa-language fa-fw"></i><div class=select-style><select id=select-language onchange="location=this.value;">
<option id=en value=https://awslabs.github.io/aws-cloudfront-extensions/workshop/security-practice/rule-testing/readme/ selected>English</option></select><svg id="Capa_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="255" height="255" viewBox="0 0 255 255" style="enable-background:new 0 0 255 255"><g><g id="arrow-drop-down"><polygon points="0,63.75 127.5,191.25 255,63.75"/></g></g></svg></div></a></li></ul></section><section id=footer><left><a class=github-button href=https://github.com/awslabs/aws-cloudfront-extensions data-icon=octicon-cloud-download aria-label="Repo of awslabs/aws-cloudfront-extension on GitHub">Repo</a>
<a class=github-button href=https://github.com/awslabs/aws-cloudfront-extensions data-icon=octicon-star data-show-count=false aria-label="Star awslabs/aws-cloudfront-extension on GitHub">Star</a>
<a class=github-button href=https://github.com/awslabs/aws-cloudfront-extensions/fork data-icon=octicon-repo-forked data-show-count=false aria-label="Fork awslabs/aws-cloudfront-extension on GitHub">Fork</a><p><a href="https://aws.amazon.com/privacy/?nc1=f_pr">Privacy</a> | <a href="https://aws.amazon.com/terms/?nc1=f_pr">Site Terms</a> | © 2021, Amazon Web Services, Inc. or its affiliates. All rights reserved</p></left><script async defer src=https://buttons.github.io/buttons.js></script></section></div></nav><section id=body><div id=overlay></div><div class="padding highlightable"><div><div id=top-bar><div id=breadcrumbs itemscope itemtype=http://data-vocabulary.org/Breadcrumb><span id=sidebar-toggle-span><a href=# id=sidebar-toggle data-sidebar-toggle><i class="fas fa-bars"></i></a></span><span id=toc-menu><i class="fas fa-list-alt"></i></span><span class=links><a href=https://awslabs.github.io/aws-cloudfront-extensions/workshop/>CloudFront Extensions workshop</a> > <a href=https://awslabs.github.io/aws-cloudfront-extensions/workshop/security-practice/>WAF & Shield Best Practice</a> > Web ACLs and Managed Rules</span></div><div class=progress><div class=wrapper><nav id=TableOfContents><ul><li><a href=#introduction>Introduction</a><ul><li><a href=#web-acls>Web ACLs</a></li><li><a href=#managed-rules>Managed Rules</a></li></ul></li><li><a href=#sql-injection-protection>SQL Injection protection</a></li><li><a href=#cross-site-scripting-xss-protection>Cross-Site Scripting (XSS) protection</a></li></ul></nav></div></div></div></div><div id=head-tags></div><div id=body-inner><h1>Web ACLs and Managed Rules</h1><p>In this step of the workshop, you will see how the AWS WAF protects against common attacks, such as SQL injection or Command Line attacks.</p><h2 id=introduction>Introduction</h2><h3 id=web-acls>Web ACLs</h3><p>A <a href=https://docs.aws.amazon.com/waf/latest/developerguide/web-acl.html>web ACL (Web Access Control List)</a> is the core resource in an AWS WAF deployment. It contains rules that are evaluated for each request that it receives. <a href=https://docs.aws.amazon.com/waf/latest/developerguide/web-acl-associating-aws-resource.html>A web ACL is associated to your web application</a> via either an Amazon CloudFront distribution, AWS API Gateway API or an AWS Application Load Balancer.</p><h3 id=managed-rules>Managed Rules</h3><p>In the AWS WAF & Shield console, you will see there are a set of pre-configured rules, these rules provide protection against common types of attacks.
<img src="https://awslabs.github.io/aws-cloudfront-extensions/workshop/images/managed_rules.png?width=50pc" alt="Managed Rules"></p><p>SQL Injection and XSS are two common attacks. The WAF & Shield Automations solution creates rules in AWS WAF to deny requests that contain SQL Injection or XSS. Let&rsquo;s try two attacks against the Juice Shop web application to demonstrate.</p><h2 id=sql-injection-protection>SQL Injection protection</h2><p>Attackers insert malicious SQL code into web requests in an effort to extract data from your database. This solution is designed to block web requests that contain potentially malicious SQL code.</p><ol><li><p>First, you can find the <code>JuiceShopUrl</code> variable in the WAFWorkshopSampleWebApp stack in the AWS CloudFormation console and open it in your browser, you will see the Juice Shop site:
<img src="https://awslabs.github.io/aws-cloudfront-extensions/workshop/images/juice_shop_main.png?width=50pc" alt="JUICE SHOP MAIN"></p></li><li><p>Go to the Login page via the ‘Account’ button in the top area of the Juice Shop web page.
Try to use <code>' OR true--</code> in the ‘Email’ field with any password and click the ‘Log in’ button, you will receive an HTML response stating the request was forbidden(403):
<img src="https://awslabs.github.io/aws-cloudfront-extensions/workshop/images/sql_block.png?width=30pc" alt="SQL BLOCK"></p></li><li><p>Compare to open the official Juice Shop demo site: <a href=https://demo.owasp-juice.shop/>https://demo.owasp-juice.shop/</a> and use the same Email/Password to login, you will login success without any blocking.</p></li></ol><h2 id=cross-site-scripting-xss-protection>Cross-Site Scripting (XSS) protection</h2><p>Also known as XSS, attackers use vulnerabilities in a benign website as a vehicle to inject malicious client-site scripts into a legitimate user’s web browser. This solution is designed to inspect commonly explored elements of incoming requests to identify and block XSS attacks.</p><p>You can test the XSS protection rule with the command below.</p><pre><code># This imitates a Cross-Site Scripting attack
# This request should be blocked.
curl -X POST http://*********.cloudfront.net -F &quot;&lt;iframe src='javascript:alert(xss)'&gt;&quot;
</code></pre><p>If a request is blocked, you will receive an HTML response stating the request was forbidden. Here’s a snippet of what to expect</p><pre><code>&lt;!DOCTYPE HTML PUBLIC &quot;-//W3C//DTD HTML 4.01 Transitional//EN&quot; &quot;http://www.w3.org/TR/html4/loose.dtd&quot;&gt;
&lt;HTML&gt;&lt;HEAD&gt;&lt;META HTTP-EQUIV=&quot;Content-Type&quot; CONTENT=&quot;text/html; charset=iso-8859-1&quot;&gt;
&lt;TITLE&gt;ERROR: The request could not be satisfied&lt;/TITLE&gt;
&lt;/HEAD&gt;&lt;BODY&gt;
&lt;H1&gt;403 ERROR&lt;/H1&gt;
&lt;H2&gt;The request could not be satisfied.&lt;/H2&gt;
&lt;HR noshade size=&quot;1px&quot;&gt;
Request blocked.
We can't connect to the server for this app or website at this time. There might be too much traffic or a configuration error. Try again later, or contact the app or website owner.
&lt;BR clear=&quot;all&quot;&gt;
If you provide content to customers through CloudFront, you can find steps to troubleshoot and help prevent this error by reviewing the CloudFront documentation.
&lt;BR clear=&quot;all&quot;&gt;
&lt;HR noshade size=&quot;1px&quot;&gt;
&lt;PRE&gt;
Generated by cloudfront (CloudFront)
Request ID: Lgu2bFNEeSihV-XqkrxO7ObnLb6NkLbxiGhctzZVyQ-pQzvYWmEssA==
&lt;/PRE&gt;
&lt;ADDRESS&gt;
&lt;/ADDRESS&gt;
&lt;/BODY&gt;&lt;/HTML&gt;%</code></pre><footer class=footline></footer></div></div><div id=navigation><a class="nav nav-prev" href=https://awslabs.github.io/aws-cloudfront-extensions/workshop/security-practice/deploy/readme/ title="Deploy WAF & Shield Automations"><i class="fa fa-chevron-left"></i></a><a class="nav nav-next" href=https://awslabs.github.io/aws-cloudfront-extensions/workshop/security-practice/flood-testing/readme/ title="Prevent DDoS attacks" style=margin-right:0><i class="fa fa-chevron-right"></i></a></div></section><div style=left:-1000px;overflow:scroll;position:absolute;top:-1000px;border:none;box-sizing:content-box;height:200px;margin:0;padding:0;width:200px><div style=border:none;box-sizing:content-box;height:200px;margin:0;padding:0;width:200px></div></div><script src=https://awslabs.github.io/aws-cloudfront-extensions/workshop/js/clipboard.min.js?1662538309></script><script src=https://awslabs.github.io/aws-cloudfront-extensions/workshop/js/perfect-scrollbar.min.js?1662538309></script><script src=https://awslabs.github.io/aws-cloudfront-extensions/workshop/js/perfect-scrollbar.jquery.min.js?1662538309></script><script src=https://awslabs.github.io/aws-cloudfront-extensions/workshop/js/jquery.sticky.js?1662538309></script><script src=https://awslabs.github.io/aws-cloudfront-extensions/workshop/js/featherlight.min.js?1662538309></script><script src=https://awslabs.github.io/aws-cloudfront-extensions/workshop/js/highlight.pack.js?1662538309></script><script>hljs.initHighlightingOnLoad();</script><script src=https://awslabs.github.io/aws-cloudfront-extensions/workshop/js/modernizr.custom-3.6.0.js?1662538309></script><script src=https://awslabs.github.io/aws-cloudfront-extensions/workshop/js/learn.js?1662538309></script><script src=https://awslabs.github.io/aws-cloudfront-extensions/workshop/js/hugo-learn.js?1662538309></script><script src=https://awslabs.github.io/aws-cloudfront-extensions/workshop/mermaid/mermaid.js?1662538309></script><script>mermaid.initialize({startOnLoad:true});</script></body></html>