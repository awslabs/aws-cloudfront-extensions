
<!doctype html>
<html lang="zh" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="CloudFront Extensions解决方案实施指南">
      
      
      
        <link rel="canonical" href="https://www.amazonaws.cn/solutions/cloudfront-extensions/">
      
      <link rel="icon" href="assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.2.3, mkdocs-material-8.2.1">
    
    
      
        <title>CloudFront Extensions解决方案</title>
      
    
    
      <link rel="stylesheet" href="assets/stylesheets/main.e8d9bf0c.min.css">
      
        
        <link rel="stylesheet" href="assets/stylesheets/palette.e6a45f82.min.css">
        
      
    
    
    
      
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL(".",location),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="" data-md-color-primary="none" data-md-color-accent="none">
  
    
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#amazon-cloudfront-extensions" class="md-skip">
          跳转至
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="页眉">
    <a href="." title="CloudFront Extensions解决方案" class="md-header__button md-logo" aria-label="CloudFront Extensions解决方案" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            CloudFront Extensions解决方案
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              概述
            
          </span>
        </div>
      </div>
    </div>
    
    
      <div class="md-header__option">
        <div class="md-select">
          
          <button class="md-header__button md-icon" aria-label="选择当前语言">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m12.87 15.07-2.54-2.51.03-.03A17.52 17.52 0 0 0 14.07 6H17V4h-7V2H8v2H1v2h11.17C11.5 7.92 10.44 9.75 9 11.35 8.07 10.32 7.3 9.19 6.69 8h-2c.73 1.63 1.73 3.17 2.98 4.56l-5.09 5.02L4 19l5-5 3.11 3.11.76-2.04M18.5 10h-2L12 22h2l1.12-3h4.75L21 22h2l-4.5-12m-2.62 7 1.62-4.33L19.12 17h-3.24z"/></svg>
          </button>
          <div class="md-select__inner">
            <ul class="md-select__list">
              
                <li class="md-select__item">
                  <a href="/cloudfront-extensions/en/" hreflang="en" class="md-select__link">
                    English
                  </a>
                </li>
                
                <li class="md-select__item">
                  <a href="/cloudfront-extensions/zh/" hreflang="zh" class="md-select__link">
                    中文
                  </a>
                </li>
                
            </ul>
          </div>
        </div>
      </div>
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="搜索" placeholder="搜索" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="查找">
        
        <button type="reset" class="md-search__icon md-icon" aria-label="清空当前内容" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            正在初始化搜索引擎
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/awslabs/cloudfront-extensions/" title="前往仓库" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


<nav class="md-nav md-nav--primary" aria-label="导航栏" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="." title="CloudFront Extensions解决方案" class="md-nav__button md-logo" aria-label="CloudFront Extensions解决方案" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    CloudFront Extensions解决方案
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/awslabs/cloudfront-extensions/" title="前往仓库" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          概述
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="." class="md-nav__link md-nav__link--active">
        概述
      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="目录">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      目录
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#lambdaedge-cloudfront-functions" class="md-nav__link">
    Lambda@Edge &amp; CloudFront Functions合集
  </a>
  
    <nav class="md-nav" aria-label="Lambda@Edge &amp; CloudFront Functions合集">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#lambdaedge" class="md-nav__link">
    Lambda@Edge
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cloudfront-functions" class="md-nav__link">
    CloudFront Functions
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#amazon-wafamazon-shieldcloudfront" class="md-nav__link">
    基于Amazon WAF与Amazon Shield的CloudFront安全自动化
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#cloudfrontapi" class="md-nav__link">
    CloudFront实时日志监控API
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="cost/" class="md-nav__link">
        成本预估
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="architecture/" class="md-nav__link">
        架构概览
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="security/" class="md-nav__link">
        安全信息
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="regions/" class="md-nav__link">
        区域支持
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="template/" class="md-nav__link">
        模板信息
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="deployment/" class="md-nav__link">
        部署解决方案
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="additional-resources/" class="md-nav__link">
        更多资源
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="uninstall/" class="md-nav__link">
        卸载解决方案
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="source/" class="md-nav__link">
        源代码
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="revisions/" class="md-nav__link">
        文档发布说明
      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="目录">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      目录
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#lambdaedge-cloudfront-functions" class="md-nav__link">
    Lambda@Edge &amp; CloudFront Functions合集
  </a>
  
    <nav class="md-nav" aria-label="Lambda@Edge &amp; CloudFront Functions合集">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#lambdaedge" class="md-nav__link">
    Lambda@Edge
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cloudfront-functions" class="md-nav__link">
    CloudFront Functions
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#amazon-wafamazon-shieldcloudfront" class="md-nav__link">
    基于Amazon WAF与Amazon Shield的CloudFront安全自动化
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#cloudfrontapi" class="md-nav__link">
    CloudFront实时日志监控API
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content" data-md-component="content">
            <article class="md-content__inner md-typeset">
              
                
<a href="https://github.com/awslabs/cloudfront-extensions/edit/master/docs/index.md" title="编辑此页" class="md-content__button md-icon">
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20.71 7.04c.39-.39.39-1.04 0-1.41l-2.34-2.34c-.37-.39-1.02-.39-1.41 0l-1.84 1.83 3.75 3.75M3 17.25V21h3.75L17.81 9.93l-3.75-3.75L3 17.25z"/></svg>
</a>



<h1 id="amazon-cloudfront-extensions">Amazon CloudFront Extensions</h1>
<p>Amazon CloudFront Extensions解决方案包含三个模块：Lambda@Edge和CloudFront Functions合集、基于Amazon WAF与Amazon Shield的CloudFront安全自动化，和监控API，从而帮助客户更方便地使用CloudFront的拓展功能。</p>
<h2 id="lambdaedge-cloudfront-functions">Lambda@Edge &amp; CloudFront Functions合集</h2>
<p>本模块包含了一系列Lambda@Edge和CloudFront Functions，覆盖了如鉴权验证、预热、根据设备类型跳转和图片缩放等常用的用户场景，具体信息见下表。</p>
<h4 id="lambdaedge">Lambda@Edge</h4>
<table>
<thead>
<tr>
<th><strong>名称</strong></th>
<th><strong>描述</strong></th>
<th><strong>示例</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td><a href="https://github.com/awslabs/aws-cloudfront-extensions/tree/main/edge/nodejs/authentication-with-cognito">Authentication with Cognito</a></td>
<td>Cognito是亚马逊的鉴权服务，当用户通过Cognito进行鉴权时，本Lambda可验证Cognito返回的token是否合法。</td>
<td>-</td>
</tr>
<tr>
<td><a href="https://github.com/awslabs/aws-cloudfront-extensions/blob/main/edge/nodejs/add-security-headers">Add security headers</a></td>
<td>在响应中增加安全标头。</td>
<td>例如，通过添加<code>HSTS'strict-transport-security'</code>强制浏览器使用HTTPS，添加<code>'x-frame-options'</code>预防点击劫持。</td>
</tr>
<tr>
<td><a href="https://github.com/awslabs/aws-cloudfront-extensions/tree/main/edge/nodejs/serving-based-on-device">Serve content based on device type</a></td>
<td>根据设备类型跳转到相应链接。</td>
<td>例如，如果通过手机访问，则跳转到适配手机样式的网站。</td>
</tr>
<tr>
<td><a href="https://github.com/awslabs/aws-cloudfront-extensions/tree/main/edge/nodejs/cross-origin-resource-sharing">Cross origin resource sharing</a></td>
<td>在响应中添加CORS (Cross Origin Resource Sharing)标头。</td>
<td>例如，增加<code>'access-control-allow-origin'</code>、<code>'access-control-allow-headers'</code>的标头。</td>
</tr>
<tr>
<td><a href="https://github.com/awslabs/aws-cloudfront-extensions/tree/main/edge/nodejs/modify-response-status-code">Modify response status code</a></td>
<td>修改响应的状态码。</td>
<td>例如，将状态码从500修改为200。</td>
</tr>
<tr>
<td><a href="https://github.com/awslabs/aws-cloudfront-extensions/tree/main/edge/nodejs/modify-response-header">Modify response header</a></td>
<td>修改响应的标头。</td>
<td>-</td>
</tr>
<tr>
<td><a href="https://github.com/awslabs/aws-cloudfront-extensions/tree/main/edge/nodejs/access-origin-by-weight-rate">Access origin by weight rate</a></td>
<td>根据提供的权重访问源站服务器。</td>
<td>例如，有两个源站服务器，权重分别是1和2，则会按照此权重比例进行回源。</td>
</tr>
<tr>
<td><a href="https://github.com/awslabs/aws-cloudfront-extensions/tree/main/edge/nodejs/multiple-origin-IP-retry">Failover to alternative origin</a></td>
<td>用户可提供一个源站服务器列表，当列表中的第一个源站服务器不可用时，自动切换到下一个，直到找到可用源站并发起请求。</td>
<td>-</td>
</tr>
<tr>
<td><a href="https://github.com/awslabs/aws-cloudfront-extensions/tree/main/edge/nodejs/http302-from-origin">Support 302 from origin</a></td>
<td>当收到302状态码时，直接请求相应的源站，而不需要返回给客户端进行302跳转。</td>
<td>-</td>
</tr>
<tr>
<td><a href="https://github.com/awslabs/aws-cloudfront-extensions/tree/main/edge/python/prewarm">Pre-warm</a></td>
<td>用户可指定区域进行预热。</td>
<td>例如，将100个url在美国东部进行预热。</td>
</tr>
<tr>
<td><a href="https://github.com/awslabs/aws-cloudfront-extensions/tree/main/edge/nodejs/resize-picture">Resize picture</a></td>
<td>根据提供的宽和高缩放图片，并将缩放后的图片保存到Amazon S3，提高下次相同请求的效率。</td>
<td>例如，将图片从<code>1000x1000</code>缩放为<code>200x300</code>。</td>
</tr>
<tr>
<td><a href="https://github.com/awslabs/aws-cloudfront-extensions/tree/main/edge/nodejs/anti-hotlinking">Anti-hotlinking</a></td>
<td>只允许referer白名单中的请求访问资源，从而达到防盗链的目的。目前白名单支持'*'、'?'等通配符。</td>
<td>例如，只允许referer是<code>www.example.com</code>的请求访问网站的图片。</td>
</tr>
<tr>
<td><a href="https://github.com/awslabs/aws-cloudfront-extensions/tree/main/edge/nodejs/normalize-query-string">Standardize query string</a></td>
<td>标准化query string从而提高缓存命中率（CHR），此Lambda会将query string转为小写字母并按照升序排列, 详情可参考<a href="https://docs.aws.amazon.com/AmazonCloudFront/latest/DeveloperGuide/cache-hit-ratio.html#cache-hit-ratio-query-string-parameters">链接</a>。</td>
<td>例如，原url是 https://d111111abcdef8.cloudfront.net/images/image.jpg?Type=demo&amp;Color=red, 标准化后会变为 https://d111111abcdef8.cloudfront.net/images/image.jpg?color=red&amp;type=demo</td>
</tr>
<tr>
<td><a href="https://github.com/awslabs/aws-cloudfront-extensions/tree/main/edge/nodejs/authentication-with-aliyun-cdn-typeA">Authentication with Alibaba Cloud</a></td>
<td>由Goclouds提供，实现基于阿里云的鉴权</td>
<td>-</td>
</tr>
<tr>
<td><a href="https://github.com/awslabs/aws-cloudfront-extensions/tree/main/edge/nodejs/rewrite-url">Rewrite host for custom origin</a></td>
<td>当CloudFront的源站是自定义源站时，此Lambda可以重写请求中的host字段，从而实现重定向到其他源站的功能。</td>
<td>-</td>
</tr>
<tr>
<td><a href="https://github.com/awslabs/aws-cloudfront-extensions/tree/main/edge/python/serverless-load-balancer">Serverless load balancer</a></td>
<td>通过Lambda@Edge实现负载均衡功能，负载会在Amazon DynamoDB表格中记录。</td>
<td>-</td>
</tr>
<tr>
<td><a href="https://github.com/awslabs/aws-cloudfront-extensions/tree/main/edge/nodejs/custom-response-with-replaced-url">Custom response with new URL</a></td>
<td>将响应中的body内容替换为自定义内容。</td>
<td>例如，响应返回的是个html，此Lambda可以将html中的所有'www.original.com'内容替换'www.new.com'，用户可通过此Lambda实现只维护一个S3桶，即可让两个不同的域名进行访问。</td>
</tr>
</tbody>
</table>
<h4 id="cloudfront-functions">CloudFront Functions</h4>
<table>
<thead>
<tr>
<th><strong>名称</strong></th>
<th><strong>描述</strong></th>
<th><strong>示例</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td><a href="https://github.com/awslabs/aws-cloudfront-extensions/tree/main/function/js/add-security-headers">Add security headers</a></td>
<td>在响应中增加安全标头。</td>
<td>例如，通过添加<code>HSTS'strict-transport-security'</code>强制浏览器使用HTTPS，添加<code>'x-frame-options'</code>预防点击劫持。</td>
</tr>
<tr>
<td><a href="https://github.com/awslabs/aws-cloudfront-extensions/tree/main/function/js/cross-origin-resource-sharing">Cross origin resource sharing</a></td>
<td>在响应中添加CORS (Cross Origin Resource Sharing)标头。</td>
<td>例如，增加<code>'access-control-allow-origin'</code>、<code>'access-control-allow-headers'</code>的标头。</td>
</tr>
<tr>
<td><a href="https://github.com/awslabs/aws-cloudfront-extensions/tree/main/function/js/add-cache-control-header">Add cache control headers</a></td>
<td>添加Cache-Control标头，从而允许浏览器本地缓存。</td>
<td>-</td>
</tr>
<tr>
<td><a href="https://github.com/awslabs/aws-cloudfront-extensions/tree/main/function/js/add-origin-header">Add origin headers</a></td>
<td>添加Origin标头。</td>
<td>-</td>
</tr>
<tr>
<td><a href="https://github.com/awslabs/aws-cloudfront-extensions/tree/main/function/js/add-true-client-ip-header">Add true client IP headers</a></td>
<td>添加True-Client-IP标头，此标头是真正最终连接CloudFront的客户端的IP。如果没有此标头，由CloudFront到源站服务器的连接（即源请求Origin request）只会包含CloudFront服务器的IP地址，而不是用户的客户端的IP地址。</td>
<td>-</td>
</tr>
<tr>
<td><a href="https://github.com/awslabs/aws-cloudfront-extensions/tree/main/function/js/redirect-based-on-country">Redirect based on country</a></td>
<td>根据用户所在地区返回相应的内容。</td>
<td>-</td>
</tr>
<tr>
<td><a href="https://github.com/awslabs/aws-cloudfront-extensions/tree/main/function/js/default-dir-index">Default dir index</a></td>
<td>为CloudFront的链接增加默认的结尾。</td>
<td>为所有以'/'结尾的url增加index.html。</td>
</tr>
<tr>
<td><a href="https://github.com/awslabs/aws-cloudfront-extensions/tree/main/function/js/verify-jwt">Verify JSON web token</a></td>
<td>验证query string中的JSON Web Token (JWT)，一般用于鉴权场景。</td>
<td>-</td>
</tr>
<tr>
<td><a href="https://github.com/awslabs/aws-cloudfront-extensions/tree/main/function/js/custom-host">Customize request host</a></td>
<td>将host替换为自定义的标头的内容。</td>
<td>例如，用户可自定义一个标头awscustomhost，最终host会被替换为此标头的内容。</td>
</tr>
</tbody>
</table>
<h2 id="amazon-wafamazon-shieldcloudfront">基于Amazon WAF与Amazon Shield的CloudFront安全自动化</h2>
<p>本模块提供了一个在Amazon CloudFront上快速使用Amazon WAF和Amazon Shield Advanced的模板，它可以自动向您的账号中部署一套WAF规则和Shield保护组，从而为您的CloudFront提供如下保护：</p>
<ul>
<li>
<p>SQL注入和XSS：该解决方案配置了两个本机WAF规则，旨在防止URI、查询字符串或请求正文中出现常见的SQL注入或跨站点脚本（XSS）模式。</p>
</li>
<li>
<p>HTTP泛洪：该组件可防止来自特定IP地址的大量请求构成的攻击，例如web层DDoS攻击或暴力登录尝试。</p>
</li>
<li>
<p>日志扫描器：该组件分析应用程序访问日志，搜索可疑行为，例如状态码为500。然后，它会在客户定义的一段时间内屏蔽这些可疑的源IP地址。</p>
</li>
<li>
<p>IP信誉列表：定期获取第三方提供的IP信誉列表，防止信誉差的IP访问您的网站。</p>
</li>
<li>
<p>爬虫：设置一个蜜罐链接，您可将其添加到网页中，通过将其设置为隐藏，从而保证用户无法看到此链接。如果此链接被点击时则是由爬虫触发的，从而识别出爬虫并进行防御。</p>
</li>
<li>
<p>IP黑名单和白名单：该组件创建两个特定的WAF规则，允许您手动插入要阻止或允许的IP地址。</p>
</li>
</ul>
<h2 id="cloudfrontapi">CloudFront实时日志监控API</h2>
<p>本模块通过分析CloudFront实时日志获取Cache Hit Rate（缓存命中率）、下载速率等指标，并通过RESTful API输出。</p>
<p>监控API可以满足灵活的定制化需求，根据您的特定需求从实时日志中自定义指标逻辑，只需要在Amazon Athena中通过SQL语句就可以实现。以下是提供的10个参考指标：</p>
<ul>
<li>request: 从客户端到CloudFront的请求数量</li>
<li>requestOrigin: 回源的请求数量</li>
<li>statusCode: 从客户端到CloudFront的状态码</li>
<li>statusCodeOrigin: 回源的状态码</li>
<li>bandwidth: 从客户端到CloudFront的带宽</li>
<li>bandwidthOrigin: 回源的带宽</li>
<li>chr: 通过请求数量计算的缓存命中率</li>
<li>chrBandWith: 通过带宽计算的缓存命中率</li>
<li>downloadSpeed: 从客户端到CloudFront的下载速率</li>
<li>downloadSpeedOrigin: 回源的下载速率</li>
</ul>
<p>上述参考指标有效地补充了目前CloudWatch对CloudFront的监控指标，可以帮助您从多个维度了解CloudFront的运行情况。有关CloudFront默认内置的监控指标，可以参考<a href="https://docs.aws.amazon.com/zh_cn/AmazonCloudFront/latest/DeveloperGuide/monitoring-using-cloudwatch.html">使用Amazon CloudWatch监控CloudFront</a>。</p>
<p>本实施指南介绍在Amazon Web Services（亚马逊云科技）云中部署解决方案的架构信息和具体配置步骤。它包含指向<a href="https://aws.amazon.com/en/cloudformation/">CloudFormation</a>模板的链接，这些模板使用亚马逊云科技在安全性和可用性方面的最佳实践来启动和配置本解决方案所需的亚马逊云科技服务。</p>
<p>本指南面向具有亚马逊云科技架构实践经验的IT架构师、开发人员等专业人士。</p>

              
            </article>
          </div>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
    <nav class="md-footer__inner md-grid" aria-label="页脚">
      
      
        
        <a href="cost/" class="md-footer__link md-footer__link--next" aria-label="下一页: 成本预估" rel="next">
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                下一页
              </span>
              成本预估
            </div>
          </div>
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4z"/></svg>
          </div>
        </a>
      
    </nav>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    <script id="__config" type="application/json">{"base": ".", "features": ["tabs", "search.suggest", "search.highlight"], "translations": {"clipboard.copy": "\u590d\u5236", "clipboard.copied": "\u5df2\u590d\u5236", "search.config.lang": "ja", "search.config.pipeline": "trimmer, stemmer", "search.config.separator": "[\\uff0c\\u3002]+", "search.placeholder": "\u641c\u7d22", "search.result.placeholder": "\u952e\u5165\u4ee5\u5f00\u59cb\u641c\u7d22", "search.result.none": "\u6ca1\u6709\u627e\u5230\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.one": "\u627e\u5230 1 \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.other": "# \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.more.one": "\u5728\u8be5\u9875\u4e0a\u8fd8\u6709 1 \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.more.other": "\u5728\u8be5\u9875\u4e0a\u8fd8\u6709 # \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.term.missing": "\u7f3a\u5c11", "select.version.title": "\u9009\u62e9\u5f53\u524d\u7248\u672c"}, "search": "assets/javascripts/workers/search.bd0b6b67.min.js"}</script>
    
    
      <script src="assets/javascripts/bundle.8aa65030.min.js"></script>
      
    
  </body>
</html>