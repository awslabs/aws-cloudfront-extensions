<!doctype html><html lang=en class="js csstransforms3d"><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=generator content="Hugo 0.79.1"><meta name=description content><link rel="shortcut icon" href=https://awslabs.github.io/aws-cloudfront-extensions/images/favicon.ico type=image/x-icon><title>Trigger from CloudFront :: CloudFront+</title><link href=https://awslabs.github.io/aws-cloudfront-extensions/css/nucleus.css?1624872388 rel=stylesheet><link href=https://awslabs.github.io/aws-cloudfront-extensions/css/fontawesome-all.min.css?1624872388 rel=stylesheet><link href=https://awslabs.github.io/aws-cloudfront-extensions/css/hybrid.css?1624872388 rel=stylesheet><link href=https://awslabs.github.io/aws-cloudfront-extensions/css/featherlight.min.css?1624872388 rel=stylesheet><link href=https://awslabs.github.io/aws-cloudfront-extensions/css/perfect-scrollbar.min.css?1624872388 rel=stylesheet><link href=https://awslabs.github.io/aws-cloudfront-extensions/css/auto-complete.css?1624872388 rel=stylesheet><link href=https://awslabs.github.io/aws-cloudfront-extensions/css/atom-one-dark-reasonable.css?1624872388 rel=stylesheet><link href=https://awslabs.github.io/aws-cloudfront-extensions/css/theme.css?1624872388 rel=stylesheet><link href=https://awslabs.github.io/aws-cloudfront-extensions/css/hugo-theme.css?1624872388 rel=stylesheet><link href=https://awslabs.github.io/aws-cloudfront-extensions/css/theme-cloudfrontext.css?1624872388 rel=stylesheet><script src=https://awslabs.github.io/aws-cloudfront-extensions/js/jquery-3.3.1.min.js?1624872388></script><style>:root #header+#content>#left>#rlblock_left{display:none!important}</style></head><body data-url=https://awslabs.github.io/aws-cloudfront-extensions/develop/trigger-function/readme/><nav id=sidebar><div id=header-wrapper><div id=header><a id=logo href=https://awslabs.github.io/aws-cloudfront-extensions/><img src=https://awslabs.github.io/aws-cloudfront-extensions/images/logo.png alt="AWS Logo" width=44% height=44%></a></div><div class=searchbox><label for=search-by><i class="fas fa-search"></i></label><input data-search-input id=search-by type=search placeholder=Search...>
<span data-search-clear><i class="fas fa-times"></i></span></div><script type=text/javascript src=https://awslabs.github.io/aws-cloudfront-extensions/js/lunr.min.js?1624872388></script><script type=text/javascript src=https://awslabs.github.io/aws-cloudfront-extensions/js/auto-complete.js?1624872388></script><script type=text/javascript>var baseurl="https:\/\/awslabs.github.io\/aws-cloudfront-extensions\/";</script><script type=text/javascript src=https://awslabs.github.io/aws-cloudfront-extensions/js/search.js?1624872388></script></div><div class=highlightable><ul class=topics><li data-nav-id=/prerequisite/ title=Prerequisite class=dd-item><a href=https://awslabs.github.io/aws-cloudfront-extensions/prerequisite/>Prerequisite</a><ul><li data-nav-id=/prerequisite/aws-cloudshell/readme/ title="AWS CloudShell" class=dd-item><a href=https://awslabs.github.io/aws-cloudfront-extensions/prerequisite/aws-cloudshell/readme/>AWS CloudShell</a></li><li data-nav-id=/prerequisite/aws-cdk/readme/ title="AWS CDK" class=dd-item><a href=https://awslabs.github.io/aws-cloudfront-extensions/prerequisite/aws-cdk/readme/>AWS CDK</a></li><li data-nav-id=/prerequisite/aws-config/readme/ title="Configure your credentials" class=dd-item><a href=https://awslabs.github.io/aws-cloudfront-extensions/prerequisite/aws-config/readme/>Configure your credentials</a></li></ul></li><li data-nav-id=/deploy/ title="Deploy with CloudFront Extensions" class=dd-item><a href=https://awslabs.github.io/aws-cloudfront-extensions/deploy/>Deploy with CloudFront Extensions</a><ul><li data-nav-id=/deploy/deploy-auth/readme/ title="Deploy a Lambda@Edge function to authenticate with Cognito" class=dd-item><a href=https://awslabs.github.io/aws-cloudfront-extensions/deploy/deploy-auth/readme/>Deploy a Lambda@Edge function to authenticate with Cognito</a></li><li data-nav-id=/deploy/deploy-device/readme/ title="Deploy a Lambda@Edge function to serve based on devices" class=dd-item><a href=https://awslabs.github.io/aws-cloudfront-extensions/deploy/deploy-device/readme/>Deploy a Lambda@Edge function to serve based on devices</a></li></ul></li><li data-nav-id=/develop/ title="Develop with CloudFront Extensions" class="dd-item
parent"><a href=https://awslabs.github.io/aws-cloudfront-extensions/develop/>Develop with CloudFront Extensions</a><ul><li data-nav-id=/develop/cloudfront-distribution/readme/ title="Create a CloudFront Distribution" class=dd-item><a href=https://awslabs.github.io/aws-cloudfront-extensions/develop/cloudfront-distribution/readme/>Create a CloudFront Distribution</a></li><li data-nav-id=/develop/download-code/readme/ title="Upload CloudFront Extensions code into CloudShell" class=dd-item><a href=https://awslabs.github.io/aws-cloudfront-extensions/develop/download-code/readme/>Upload CloudFront Extensions code into CloudShell</a></li><li data-nav-id=/develop/code-structure/readme/ title="Understand CloudFront Extensions code structure" class=dd-item><a href=https://awslabs.github.io/aws-cloudfront-extensions/develop/code-structure/readme/>Understand CloudFront Extensions code structure</a></li><li data-nav-id=/develop/edge-function/readme/ title="Create a Lambda@Edge function" class=dd-item><a href=https://awslabs.github.io/aws-cloudfront-extensions/develop/edge-function/readme/>Create a Lambda@Edge function</a></li><li data-nav-id=/develop/test-function/readme/ title="Test the Lambda@Edge function" class=dd-item><a href=https://awslabs.github.io/aws-cloudfront-extensions/develop/test-function/readme/>Test the Lambda@Edge function</a></li><li data-nav-id=/develop/trigger-function/readme/ title="Trigger from CloudFront" class="dd-item active"><a href=https://awslabs.github.io/aws-cloudfront-extensions/develop/trigger-function/readme/>Trigger from CloudFront</a></li></ul></li><li data-nav-id=/security/ title="WAF & Shield Deployment" class=dd-item><a href=https://awslabs.github.io/aws-cloudfront-extensions/security/>WAF & Shield Deployment</a><ul><li data-nav-id=/security/guide/readme/ title=Deployment class=dd-item><a href=https://awslabs.github.io/aws-cloudfront-extensions/security/guide/readme/>Deployment</a></li></ul></li><li data-nav-id=/security-practice/ title="WAF & Shield Best Practice" class=dd-item><a href=https://awslabs.github.io/aws-cloudfront-extensions/security-practice/>WAF & Shield Best Practice</a><ul><li data-nav-id=/security-practice/juice-shop/readme/ title="Deploy OWASP Juice Shop" class=dd-item><a href=https://awslabs.github.io/aws-cloudfront-extensions/security-practice/juice-shop/readme/>Deploy OWASP Juice Shop</a></li><li data-nav-id=/security-practice/deploy/readme/ title="Deploy WAF & Shield Automations" class=dd-item><a href=https://awslabs.github.io/aws-cloudfront-extensions/security-practice/deploy/readme/>Deploy WAF & Shield Automations</a></li><li data-nav-id=/security-practice/rule-testing/readme/ title="Web ACLs and Managed Rules" class=dd-item><a href=https://awslabs.github.io/aws-cloudfront-extensions/security-practice/rule-testing/readme/>Web ACLs and Managed Rules</a></li><li data-nav-id=/security-practice/flood-testing/readme/ title="Prevent DDoS attacks" class=dd-item><a href=https://awslabs.github.io/aws-cloudfront-extensions/security-practice/flood-testing/readme/>Prevent DDoS attacks</a></li></ul></li><li data-nav-id=/contribution/ title=Contribution class=dd-item><a href=https://awslabs.github.io/aws-cloudfront-extensions/contribution/>Contribution</a><ul><li data-nav-id=/contribution/pr/readme/ title="Contributing via pull requests" class=dd-item><a href=https://awslabs.github.io/aws-cloudfront-extensions/contribution/pr/readme/>Contributing via pull requests</a></li><li data-nav-id=/contribution/bug-report/readme/ title="Reporting issues" class=dd-item><a href=https://awslabs.github.io/aws-cloudfront-extensions/contribution/bug-report/readme/>Reporting issues</a></li></ul></li><li data-nav-id=/cleanup/ title=Cleanup class=dd-item><a href=https://awslabs.github.io/aws-cloudfront-extensions/cleanup/>Cleanup</a><ul><li data-nav-id=/cleanup/s3-bucket/readme/ title="S3 bucket" class=dd-item><a href=https://awslabs.github.io/aws-cloudfront-extensions/cleanup/s3-bucket/readme/>S3 bucket</a></li><li data-nav-id=/cleanup/cognito-user-pool/readme/ title="Cognito User Pool" class=dd-item><a href=https://awslabs.github.io/aws-cloudfront-extensions/cleanup/cognito-user-pool/readme/>Cognito User Pool</a></li><li data-nav-id=/cleanup/cf-distribution/readme/ title="CloudFront distribution" class=dd-item><a href=https://awslabs.github.io/aws-cloudfront-extensions/cleanup/cf-distribution/readme/>CloudFront distribution</a></li><li data-nav-id=/cleanup/cloudformation/readme/ title=CloudFormation class=dd-item><a href=https://awslabs.github.io/aws-cloudfront-extensions/cleanup/cloudformation/readme/>CloudFormation</a></li><li data-nav-id=/cleanup/cloudshell/readme/ title=CloudShell class=dd-item><a href=https://awslabs.github.io/aws-cloudfront-extensions/cleanup/cloudshell/readme/>CloudShell</a></li><li data-nav-id=/cleanup/waf/readme/ title="WAF & Shield Automations" class=dd-item><a href=https://awslabs.github.io/aws-cloudfront-extensions/cleanup/waf/readme/>WAF & Shield Automations</a></li></ul></li><li data-nav-id=/reference/ title="Reference & Resources" class=dd-item><a href=https://awslabs.github.io/aws-cloudfront-extensions/reference/>Reference & Resources</a></li></ul><section id=footer><left><a class=github-button href=https://github.com/awslabs/aws-cloudfront-extensions data-icon=octicon-cloud-download aria-label="Repo of awslabs/aws-cloudfront-extension on GitHub">Repo</a>
<a class=github-button href=https://github.com/awslabs/aws-cloudfront-extensions data-icon=octicon-star data-show-count=false aria-label="Star awslabs/aws-cloudfront-extension on GitHub">Star</a>
<a class=github-button href=https://github.com/awslabs/aws-cloudfront-extensions/fork data-icon=octicon-repo-forked data-show-count=false aria-label="Fork awslabs/aws-cloudfront-extension on GitHub">Fork</a><p><a href="https://aws.amazon.com/privacy/?nc1=f_pr">Privacy</a> | <a href="https://aws.amazon.com/terms/?nc1=f_pr">Site Terms</a> | Â© 2021, Amazon Web Services, Inc. or its affiliates. All rights reserved</p></left><script async defer src=https://buttons.github.io/buttons.js></script></section></div></nav><section id=body><div id=overlay></div><div class="padding highlightable"><div><div id=top-bar><div id=breadcrumbs itemscope itemtype=http://data-vocabulary.org/Breadcrumb><span id=sidebar-toggle-span><a href=# id=sidebar-toggle data-sidebar-toggle><i class="fas fa-bars"></i></a></span><span id=toc-menu><i class="fas fa-list-alt"></i></span><span class=links><a href=https://awslabs.github.io/aws-cloudfront-extensions/>CloudFront Extensions workshop</a> > <a href=https://awslabs.github.io/aws-cloudfront-extensions/develop/>Develop with CloudFront Extensions</a> > Trigger from CloudFront</span></div><div class=progress><div class=wrapper><nav id=TableOfContents><ul><li><a href=#add-a-cloudfront-trigger-to-run-the-function>Add a CloudFront Trigger to Run the Function</a></li><li><a href=#trigger-the-function-from-cloudfront>Trigger the function from CloudFront</a></li></ul></nav></div></div></div></div><div id=head-tags></div><div id=body-inner><h1>Trigger from CloudFront</h1><h2 id=add-a-cloudfront-trigger-to-run-the-function>Add a CloudFront Trigger to Run the Function</h2><p>Now that you have tested the Lambda function, in this step, you will configure the CloudFront trigger to run your function to add the headers in any response that CloudFront receives from the origin for your distribution.</p><p>To configure the CloudFront trigger for your function</p><ol><li><p>Choose <strong>Configuration</strong> tab and choose <strong>Triggers</strong>, you will see there is an API Gateway trigger which is deployed by hello world SAM template, delete it since you will not need it in this workshop</p><p><img src=https://awslabs.github.io/aws-cloudfront-extensions/images/api_trigger.png alt="Api Trigger"></p></li><li><p>Add Trigger and choose <strong>CloudFront</strong>, choose <strong>Deploy to Lambda@Edge</strong></p><p><img src=https://awslabs.github.io/aws-cloudfront-extensions/images/CF_trigger.png alt="CF Trigger"></p></li><li><p>On the <strong>Deploy to Lambda@Edge</strong> page, enter the following information:</p><ul><li><p>Distribution</p><p>The CloudFront distribution ID to associate with your function. In the drop-down list, choose the distribution ID.</p></li><li><p>CloudFront event</p><p>The trigger that specifies when your function runs. We want the function to run whenever CloudFront returns a response from the origin and then the function will modify/add the response headers. So in the drop-down list, choose <strong>Origin response</strong></p></li></ul><p>Choose <strong>Deploy</strong></p><p><img src=https://awslabs.github.io/aws-cloudfront-extensions/images/lambda_deploy.png alt="Lambda Deploy"></p></li><li><p>Wait for the function to replicate. This typically takes several minutes</p><p>You can check to see if replication is finished by going to the <a href=https://console.aws.amazon.com/cloudfront/>CloudFront console</a> and viewing your distribution. Wait for the distribution status to change from In Progress back to <strong>Deployed</strong>, which means that your function has been replicated</p><p><img src=https://awslabs.github.io/aws-cloudfront-extensions/images/cf_deployed.png alt="CF Deployed"></p></li></ol><h2 id=trigger-the-function-from-cloudfront>Trigger the function from CloudFront</h2><p>Now that you&rsquo;ve configured a trigger to run the function for a CloudFront distribution, check to make sure that the function is accomplishing what you expect it to. In this step, we will check the HTTP headers that CloudFront returns, to make sure that the workshop header is added</p><p>In <strong>Create a CloudFront Distribution</strong> section, you have created a CloudFront distribution which is similar with <a href=https://d1v2jstg89nnob.cloudfront.net/CloudFrontIcon.png>https://d1v2jstg89nnob.cloudfront.net/CloudFrontIcon.png</a></p><p>Open this link, you will see the workshop header is in the response header</p><p><img src=https://awslabs.github.io/aws-cloudfront-extensions/images/resp_header.png alt="Resp Header"></p><footer class=footline></footer></div></div><div id=navigation><a class="nav nav-prev" href=https://awslabs.github.io/aws-cloudfront-extensions/develop/test-function/readme/ title="Test the Lambda@Edge function"><i class="fa fa-chevron-left"></i></a><a class="nav nav-next" href=https://awslabs.github.io/aws-cloudfront-extensions/security/ title="WAF & Shield Deployment" style=margin-right:0><i class="fa fa-chevron-right"></i></a></div></section><div style=left:-1000px;overflow:scroll;position:absolute;top:-1000px;border:none;box-sizing:content-box;height:200px;margin:0;padding:0;width:200px><div style=border:none;box-sizing:content-box;height:200px;margin:0;padding:0;width:200px></div></div><script src=https://awslabs.github.io/aws-cloudfront-extensions/js/clipboard.min.js?1624872388></script><script src=https://awslabs.github.io/aws-cloudfront-extensions/js/perfect-scrollbar.min.js?1624872388></script><script src=https://awslabs.github.io/aws-cloudfront-extensions/js/perfect-scrollbar.jquery.min.js?1624872388></script><script src=https://awslabs.github.io/aws-cloudfront-extensions/js/jquery.sticky.js?1624872388></script><script src=https://awslabs.github.io/aws-cloudfront-extensions/js/featherlight.min.js?1624872388></script><script src=https://awslabs.github.io/aws-cloudfront-extensions/js/highlight.pack.js?1624872388></script><script>hljs.initHighlightingOnLoad();</script><script src=https://awslabs.github.io/aws-cloudfront-extensions/js/modernizr.custom-3.6.0.js?1624872388></script><script src=https://awslabs.github.io/aws-cloudfront-extensions/js/learn.js?1624872388></script><script src=https://awslabs.github.io/aws-cloudfront-extensions/js/hugo-learn.js?1624872388></script><script src=https://awslabs.github.io/aws-cloudfront-extensions/mermaid/mermaid.js?1624872388></script><script>mermaid.initialize({startOnLoad:true});</script></body></html>