{"config":{"indexing":"full","lang":["en"],"min_search_length":3,"prebuild_index":false,"separator":"[\\s\\-]+"},"docs":[{"location":"","text":"CloudFront Extensions is an out-of-box solution for advanced Amazon CloudFront users to manage dozens of CloudFront distributions regularly. The solution provides a set of management and automation functions and helps customers to improve the overall operational efficiency when using Amazon Edge products. The solution has the following major features: Monitoring : You can monitor CloudFront traffic such as cache hit ratio, bandwidth, and status code. For more information, refer to Monitoring . Distribution management : You can save one specific CloudFront distribution configuration as a snapshot, compare different snapshots and apply a snapshot to other distributions; audit all CloudFront distribution changes which will be saved automatically; automate the process from requesting new certificate or importing existing SSL certificates to CloudFront distributions. For more information, refer to Distribution Management . Extension repository : You can deploy commonly used out-of-box extensions such as Lambda@Edge functions, CloudFront functions, and CloudFormation templates through friendly user interface. You can use these extensions without any programming, and customize them to fit your specific needs. For more information, refer to Extensions Repository . After deploying the solution, you can perform tasks on a web console or use the functions via APIs. For more information, see API Reference Guide . This implementation guide describes architectural considerations and configuration steps for deploying CloudFront Extensions in the AWS Cloud. It includes links to an AWS CloudFormation template that launches and configures the services required to deploy this solution using AWS best practices for security and availability. The guide is intended for IT architects, and developers who have practical experience architecting in the AWS Cloud.","title":"Welcome"},{"location":"additional-resources/","text":"Amazon API Gateway Amazon Athena Amazon CloudFront Amazon CloudFront Functions AWS CloudFormation Amazon Cognito Amazon DynamoDB AWS Glue Amazon Kinesis Amazon Kinesis Data Firehose AWS Lambda AWS Lambda@Edge AWS Shield Amazon Simple Storage Service (Amazon S3) AWS WAF","title":"Additional resources"},{"location":"architecture/","text":"Deploying CloudFront Extensions solution with the default parameters builds the following environment in the AWS Cloud. Figure 1: CloudFront Extensions architecture Amazon CloudFront distributes the solution frontend web UI assets hosted in Amazon S3 bucket. Amazon Cognito user pool provides authentication for backend. Amazon AppSync provides the backend GraphQL APIs. Amazon API Gateway provides the backend RESTful APIs for SSL certificates and Monitoring features. Amazon DynamoDB stores the solution related information as backend database. Amazon Lambda interacts with other Amazon Services to process core logic of monitoring, SSL certificates and extensions repository, and obtains information updated in DynamoDB tables. AWS Step Functions orchestrate workflows for creating ACM certificates, importing existed certificates and creating CloudFront distributions. Extensions are shown in Extensions repository. AWS CloudFormation and AWS Serverless Application Repository will be triggered if you want to deploy an extension into your AWS account. AWS Lambda stores CloudFront configuration changes into S3 bucket, and you can view the difference between two CloudFront configuration versions and apply the configuration. Amazon Athena queries CloudFront standard logs or real-time logs to get CloudFront metrics and output it by API Gateway. You can also view the metrics by monitoring dashboard.","title":"Architecture overview"},{"location":"cost/","text":"You are responsible for the cost of the AWS services used while running this solution. We recommend creating a budget through AWS Cost Explorer to help manage costs. For full details, refer to the pricing webpage for each service used in this solution. CloudFront configuration snapshot As of August 2022, if the configuration of CloudFront distributions are changed 30 times and create 10 snapshots, the estimated cost of using this solution is $0.63 per month in the US East (N. Virginia) Region (excludes free tier). Service Dimensions Cost/Month AWS Lambda 200 invocations average 60 seconds and 256MB memory $0.01 AWS Appsync 100 requests $0.0004 Amazon Simple Storage Service (S3) 5GB $0.12 Amazon DynamoDB 2GB data storage $0.50 Total ~$0.63 SSL certificates As of August 2022, if user create 2000 ACM certificates and 2000 CloudFront distribution per month, the estimated cost of using this solution is $0 per month in the US East (N. Virginia) Region (excludes free tier). Service Dimensions Cost/Month AWS Lambda 11140 invocations average 500 millisecond and 256MB memory $0 Amazon API Gateway 5000 requests $0 AWS Appsync 5000 requests $0.02 Step Functions 8 x 500 = 4000 states transitions $0 Amazon DynamoDB 1000MB data storage $26.64 Amazon Simple Storage Service (S3) 1GB storage $0.02 Total $26.68 Non-real time monitoring with CloudFront standard logs As of August 2022, to monitor 10 metrics for one CloudFront distribution which has 60 records (2KB) every second, the estimated cost of using this solution is $22.40 per month in the US East (N. Virginia) Region (excludes free tier). Service Dimensions Cost/Month AWS Lambda 86K invocations average 500 millisecond and 512MB memory $0.38 Amazon API Gateway 86K requests $0.09 Amazon Athena 86K queries 35MB data scanned per query ~$14.42 Amazon Simple Storage Service (S3) 295GB $6.79 Amazon DynamoDB 1GB data storage 2 writes per minute 1 read every 2 minutes $0.72 Total $22.40 Real time monitoring with CloudFront real-time logs As of August 2022, to monitor 10 metrics for one CloudFront distribution which has 60 records (2KB) every second, the estimated cost of using this solution is $88.56 per month in the US East (N. Virginia) Region (excludes free tier). Service Dimensions Cost/Month Amazon Kinesis Data Firehose 60 records(2KB)/second Dynamic Partitioning enabled $36.9 Amazon Kinesis Data Stream 1 shard 60 records(2KB)/second 168 hours data retention $27.76 AWS Lambda 86K invocations average 500 millisecond and 512MB memory $0.38 Amazon API Gateway 86K requests $0.09 Amazon Athena 86K queries 35MB data scanned per query $14.42 Amazon Simple Storage Service (S3) 295GB $6.79 Amazon Cognito 30 MAU $1.5 Amazon DynamoDB 1GB data storage 2 writes per minute 1 read every 2 minutes $0.72 Total $88.56 Pre-warming Example 1: Pre-warm 500 resources daily, the size of each resource is 500MB As of August 2022, the estimated cost of using this solution is $171.27 per month in the US East (N. Virginia) Region (excludes free tier). Service Dimensions Cost/Month Amazon EC2 Launch 50 EC2 spot instance (c6g.large), run 2 hours to pre-warm 500 URI daily 150GB EBS $165.97 Amazon Lambda 45K requests 256MB memory ARM64 $3.67 Amazon API Gateway 30K requests REST API $0.03 Amazon Simple Queue Service Standard queue 2GB DTO $0.18 Amazon DynamoDB 2GB data storage 15K writes 15K reads $0.52 Amazon CloudWatch 1 metric and alarm $0.90 Total $171.27 Example 2: Pre-warm 200 resources in one month, the size of each resource is 1GB As of August 2022, the estimated cost of using this solution is $11.78 per month in the US East (N. Virginia) Region (excludes free tier). Service Dimensions Cost/Month Amazon EC2 m5dn.xlarge Spot instance 150GB EBS $10.59 Amazon Lambda 28 requests 256MB memory ARM64 $0.01 Amazon API Gateway 24 requests REST API $0.0001 Amazon Simple Queue Service Standard queue 1GB DTO $0.02 Amazon DynamoDB 1GB data storage 2K writes 200 reads $0.25 Amazon CloudWatch 1 metric and alarm $0.90 Total $11.78","title":"Cost"},{"location":"cost/#cloudfront-configuration-snapshot","text":"As of August 2022, if the configuration of CloudFront distributions are changed 30 times and create 10 snapshots, the estimated cost of using this solution is $0.63 per month in the US East (N. Virginia) Region (excludes free tier). Service Dimensions Cost/Month AWS Lambda 200 invocations average 60 seconds and 256MB memory $0.01 AWS Appsync 100 requests $0.0004 Amazon Simple Storage Service (S3) 5GB $0.12 Amazon DynamoDB 2GB data storage $0.50 Total ~$0.63","title":"CloudFront configuration snapshot"},{"location":"cost/#ssl-certificates","text":"As of August 2022, if user create 2000 ACM certificates and 2000 CloudFront distribution per month, the estimated cost of using this solution is $0 per month in the US East (N. Virginia) Region (excludes free tier). Service Dimensions Cost/Month AWS Lambda 11140 invocations average 500 millisecond and 256MB memory $0 Amazon API Gateway 5000 requests $0 AWS Appsync 5000 requests $0.02 Step Functions 8 x 500 = 4000 states transitions $0 Amazon DynamoDB 1000MB data storage $26.64 Amazon Simple Storage Service (S3) 1GB storage $0.02 Total $26.68","title":"SSL certificates"},{"location":"cost/#non-real-time-monitoring-with-cloudfront-standard-logs","text":"As of August 2022, to monitor 10 metrics for one CloudFront distribution which has 60 records (2KB) every second, the estimated cost of using this solution is $22.40 per month in the US East (N. Virginia) Region (excludes free tier). Service Dimensions Cost/Month AWS Lambda 86K invocations average 500 millisecond and 512MB memory $0.38 Amazon API Gateway 86K requests $0.09 Amazon Athena 86K queries 35MB data scanned per query ~$14.42 Amazon Simple Storage Service (S3) 295GB $6.79 Amazon DynamoDB 1GB data storage 2 writes per minute 1 read every 2 minutes $0.72 Total $22.40","title":"Non-real time monitoring with CloudFront standard logs"},{"location":"cost/#real-time-monitoring-with-cloudfront-real-time-logs","text":"As of August 2022, to monitor 10 metrics for one CloudFront distribution which has 60 records (2KB) every second, the estimated cost of using this solution is $88.56 per month in the US East (N. Virginia) Region (excludes free tier). Service Dimensions Cost/Month Amazon Kinesis Data Firehose 60 records(2KB)/second Dynamic Partitioning enabled $36.9 Amazon Kinesis Data Stream 1 shard 60 records(2KB)/second 168 hours data retention $27.76 AWS Lambda 86K invocations average 500 millisecond and 512MB memory $0.38 Amazon API Gateway 86K requests $0.09 Amazon Athena 86K queries 35MB data scanned per query $14.42 Amazon Simple Storage Service (S3) 295GB $6.79 Amazon Cognito 30 MAU $1.5 Amazon DynamoDB 1GB data storage 2 writes per minute 1 read every 2 minutes $0.72 Total $88.56","title":"Real time monitoring with CloudFront real-time logs"},{"location":"cost/#pre-warming","text":"","title":"Pre-warming"},{"location":"cost/#example-1-pre-warm-500-resources-daily-the-size-of-each-resource-is-500mb","text":"As of August 2022, the estimated cost of using this solution is $171.27 per month in the US East (N. Virginia) Region (excludes free tier). Service Dimensions Cost/Month Amazon EC2 Launch 50 EC2 spot instance (c6g.large), run 2 hours to pre-warm 500 URI daily 150GB EBS $165.97 Amazon Lambda 45K requests 256MB memory ARM64 $3.67 Amazon API Gateway 30K requests REST API $0.03 Amazon Simple Queue Service Standard queue 2GB DTO $0.18 Amazon DynamoDB 2GB data storage 15K writes 15K reads $0.52 Amazon CloudWatch 1 metric and alarm $0.90 Total $171.27","title":"Example 1: Pre-warm 500 resources daily, the size of each resource is 500MB"},{"location":"cost/#example-2-pre-warm-200-resources-in-one-month-the-size-of-each-resource-is-1gb","text":"As of August 2022, the estimated cost of using this solution is $11.78 per month in the US East (N. Virginia) Region (excludes free tier). Service Dimensions Cost/Month Amazon EC2 m5dn.xlarge Spot instance 150GB EBS $10.59 Amazon Lambda 28 requests 256MB memory ARM64 $0.01 Amazon API Gateway 24 requests REST API $0.0001 Amazon Simple Queue Service Standard queue 1GB DTO $0.02 Amazon DynamoDB 1GB data storage 2K writes 200 reads $0.25 Amazon CloudWatch 1 metric and alarm $0.90 Total $11.78","title":"Example 2: Pre-warm 200 resources in one month, the size of each resource is 1GB"},{"location":"deployment/","text":"Before you launch the solution, review the architecture, supported regions, and other considerations discussed in this guide. Follow the step-by-step instructions in this section to configure and deploy the solution into your account. CloudFront Extensions Console Time to deploy : Approximately 15 minutes Deployment steps Sign in to the AWS Management Console and select the button to launch the CloudFormation template. You can also download the template as a starting point for your own implementation. The template launches in the US East (N. Virginia) Region by default. To launch the solution in a different AWS Region, use the Region selector in the console navigation bar. Under Parameters, review the parameters for the template, and modify them as necessary. Parameter Default value Description EmailAddress - Email address to receive SSL certificates notification. InitialUserEmail - The initial user email for the web console. InitialUserName - The initial username for the web console. InitialUserPassword - The Initial Password for the web console. Monitoring no You can set it to yes-Realtime to get monitoring metrics from realtime loge, or set it to yes-Non-Realtime to get monitoring metrics from standard log. By default, it is no , which means it will not deploy monitoring feature. See Monitoring for more information. CloudFrontDomainList - The CloudFront domain name list. Use comma as separation for multiple domain names. Use 'ALL' to monitoring all domains in your AWS account CloudFrontLogKeepDays 120 The number of days to keep CloudFront logs in the S3 bucket. DeleteLog false You can set it to true to delete original CloudFront standard logs in S3 bucket. By default, it is false .. UseStartTime false You can set it to true if the Time in metric data is based on start time, or set it to false if the Time in metric data is based on end time. Choose Next . On the Configure stack options page, you can specify tags (key-value pairs) for resources in your stack and set additional options, and then choose Next . On the Review page, review and confirm the settings. Check the boxes acknowledging that the template will create AWS Identity and Access Management (IAM) resources and any additional capabilities required. Choose Create to deploy the stack. You can view the status of the stack in the CloudFormation Console in the Status column. You should receive a CREATE_COMPLETE status in approximately 15 minutes. Follow-up Actions To see details for the stack resources, choose the Outputs tab. You will find CloudFront Extensions console URL in WebConsoleCloudFrontURL . The initial user name and password are defined in InitialUserName and InitialUserPassword parameters when you deploy the CloudFormation stack. As for monitoring API, the solution will create a nested stack whose name contains NonRealtimeNestedStack or RealtimeNestedStack , you will find the monitoring metric API in the Outputs tab of the nested stack. The CloudFormation stack deploys below modules: Monitoring: if you set Monitoring to yes-Realtime or yes-Non-Realtime, it will deploy the monitoring feature, see monitoring for more details. Distribution management: you can manage snapshots and SSL certificates, see distribution management for more details. Extensions repository: you can deploy a set of ready-to-use extensions (Lambda@Edge functions, CloudFront functions, CloudFormation templates). See extensions repository for more details. Lambda@Edge & CloudFront Functions collection Time to deploy : Approximately 3 minutes Deployment overview Click below deploy button to deploy this solution in your AWS account. As for Lambda@Edge functions, you can also find and configure them by searching aws-cloudfront-extensions in the Amazon SAR (Serverless Application Repository). Lambda@Edge Name Deploy Authentication with Cognito Adding security header Serve content based on device type Cross origin resource sharing Modify response status code Modify response header Access origin by weight rate Failover to alternative origin Support 302 from origin Pre-warm Resize picture Anti-hotlinking Standardize query string Authentication with Alibaba Cloud Rewrite host for custom origin Serverless load balancer Custom response with new URL CloudFront Functions Name Deploy Add security headers Cross origin resource sharing Add cache control headers Add origin headers Add true client IP headers Redirect based on country Default dir index Verify JSON web token Customize request host Lambda@Edge Deployment in SAR Access the AWS Serverless Application Repository page in the Console. Check Show apps that create custom IAM roles or resource policies . Search aws-cloudfront-extensions to display all extensions, and choose an application (for example, serving-based-on-device) and click Deploy . On the application detail page, check I acknowledge that this app creates custom IAM roles . Choose Deploy . After the deployment is completed, it will redirect to Lambda application page, and you can deploy it to Lambda@Edge.","title":"Deploy the solution"},{"location":"deployment/#cloudfront-extensions-console","text":"Time to deploy : Approximately 15 minutes","title":"CloudFront Extensions Console"},{"location":"deployment/#deployment-steps","text":"Sign in to the AWS Management Console and select the button to launch the CloudFormation template. You can also download the template as a starting point for your own implementation. The template launches in the US East (N. Virginia) Region by default. To launch the solution in a different AWS Region, use the Region selector in the console navigation bar. Under Parameters, review the parameters for the template, and modify them as necessary. Parameter Default value Description EmailAddress - Email address to receive SSL certificates notification. InitialUserEmail - The initial user email for the web console. InitialUserName - The initial username for the web console. InitialUserPassword - The Initial Password for the web console. Monitoring no You can set it to yes-Realtime to get monitoring metrics from realtime loge, or set it to yes-Non-Realtime to get monitoring metrics from standard log. By default, it is no , which means it will not deploy monitoring feature. See Monitoring for more information. CloudFrontDomainList - The CloudFront domain name list. Use comma as separation for multiple domain names. Use 'ALL' to monitoring all domains in your AWS account CloudFrontLogKeepDays 120 The number of days to keep CloudFront logs in the S3 bucket. DeleteLog false You can set it to true to delete original CloudFront standard logs in S3 bucket. By default, it is false .. UseStartTime false You can set it to true if the Time in metric data is based on start time, or set it to false if the Time in metric data is based on end time. Choose Next . On the Configure stack options page, you can specify tags (key-value pairs) for resources in your stack and set additional options, and then choose Next . On the Review page, review and confirm the settings. Check the boxes acknowledging that the template will create AWS Identity and Access Management (IAM) resources and any additional capabilities required. Choose Create to deploy the stack. You can view the status of the stack in the CloudFormation Console in the Status column. You should receive a CREATE_COMPLETE status in approximately 15 minutes.","title":"Deployment steps"},{"location":"deployment/#follow-up-actions","text":"To see details for the stack resources, choose the Outputs tab. You will find CloudFront Extensions console URL in WebConsoleCloudFrontURL . The initial user name and password are defined in InitialUserName and InitialUserPassword parameters when you deploy the CloudFormation stack. As for monitoring API, the solution will create a nested stack whose name contains NonRealtimeNestedStack or RealtimeNestedStack , you will find the monitoring metric API in the Outputs tab of the nested stack. The CloudFormation stack deploys below modules: Monitoring: if you set Monitoring to yes-Realtime or yes-Non-Realtime, it will deploy the monitoring feature, see monitoring for more details. Distribution management: you can manage snapshots and SSL certificates, see distribution management for more details. Extensions repository: you can deploy a set of ready-to-use extensions (Lambda@Edge functions, CloudFront functions, CloudFormation templates). See extensions repository for more details.","title":"Follow-up Actions"},{"location":"deployment/#lambdaedge-cloudfront-functions-collection","text":"Time to deploy : Approximately 3 minutes","title":"Lambda@Edge &amp; CloudFront Functions collection"},{"location":"deployment/#deployment-overview","text":"Click below deploy button to deploy this solution in your AWS account. As for Lambda@Edge functions, you can also find and configure them by searching aws-cloudfront-extensions in the Amazon SAR (Serverless Application Repository).","title":"Deployment overview"},{"location":"deployment/#lambdaedge","text":"Name Deploy Authentication with Cognito Adding security header Serve content based on device type Cross origin resource sharing Modify response status code Modify response header Access origin by weight rate Failover to alternative origin Support 302 from origin Pre-warm Resize picture Anti-hotlinking Standardize query string Authentication with Alibaba Cloud Rewrite host for custom origin Serverless load balancer Custom response with new URL","title":"Lambda@Edge"},{"location":"deployment/#cloudfront-functions","text":"Name Deploy Add security headers Cross origin resource sharing Add cache control headers Add origin headers Add true client IP headers Redirect based on country Default dir index Verify JSON web token Customize request host","title":"CloudFront Functions"},{"location":"deployment/#lambdaedge-deployment-in-sar","text":"Access the AWS Serverless Application Repository page in the Console. Check Show apps that create custom IAM roles or resource policies . Search aws-cloudfront-extensions to display all extensions, and choose an application (for example, serving-based-on-device) and click Deploy . On the application detail page, check I acknowledge that this app creates custom IAM roles . Choose Deploy . After the deployment is completed, it will redirect to Lambda application page, and you can deploy it to Lambda@Edge.","title":"Lambda@Edge Deployment in SAR"},{"location":"notices/","text":"Customers are responsible for making their own independent assessment of the information in this document. This document: (a) is for informational purposes only, (b) represents Amazon Web Services current product offerings and practices, which are subject to change without notice, and (c) does not create any commitments or assurances from Amazon Web Services and its affiliates, suppliers or licensors. Amazon Web Services products or services are provided \u201cas is\u201d without warranties, representations, or conditions of any kind, whether express or implied. Amazon Web Services responsibilities and liabilities to its customers are controlled by Amazon Web Services agreements, and this document is not part of, nor does it modify, any agreement between Amazon Web Services and its customers. The CloudFront Extensions solution is licensed under the terms of the Apache License Version 2.0 available at The Apache Software Foundation .","title":"Notices"},{"location":"regions/","text":"Regional deployment As of August 2022, this solution is supported in the following AWS Regions: Region Name Region ID US East (N. Virginia) us-east-1 US East (Ohio) us-east-2 US West (N. California) us-west-1 US West (Oregon) us-west-2 Asia Pacific (Mumbai) ap-south-1 Asia Pacific (Tokyo) ap-northeast-1 Asia Pacific (Seoul) ap-northeast-2 Asia Pacific (Singapore) ap-southeast-1 Asia Pacific (Sydney) ap-southeast-2 Canada (Central) ca-central-1 Europe (Ireland) eu-west-1 Europe (London) eu-west-2 Europe (Paris) eu-west-3 Europe (Stockholm) eu-north-1 Europe (Frankfurt) eu-central-1 South America (S\u00e3o Paulo) sa-east-1 Quotas There are quotas on using SSL/TLS certificates with CloudFront. Refer to the documentation for more details. Item Quota Remarks Maximum number of certificates per CloudFront distribution 1 Maximum number of certificates that you can import into ACM 2500 Maximum number of certificates per AWS account (dedicated IP addresses only) 2 One for everyday use and one for when you need to rotate certificates for multiple distributions. Using the same certificate for CloudFront distributions that were created by using different AWS accounts No Using the same certificate for CloudFront and for other AWS services Yes","title":"Design considerations"},{"location":"regions/#regional-deployment","text":"As of August 2022, this solution is supported in the following AWS Regions: Region Name Region ID US East (N. Virginia) us-east-1 US East (Ohio) us-east-2 US West (N. California) us-west-1 US West (Oregon) us-west-2 Asia Pacific (Mumbai) ap-south-1 Asia Pacific (Tokyo) ap-northeast-1 Asia Pacific (Seoul) ap-northeast-2 Asia Pacific (Singapore) ap-southeast-1 Asia Pacific (Sydney) ap-southeast-2 Canada (Central) ca-central-1 Europe (Ireland) eu-west-1 Europe (London) eu-west-2 Europe (Paris) eu-west-3 Europe (Stockholm) eu-north-1 Europe (Frankfurt) eu-central-1 South America (S\u00e3o Paulo) sa-east-1","title":"Regional deployment"},{"location":"regions/#quotas","text":"There are quotas on using SSL/TLS certificates with CloudFront. Refer to the documentation for more details. Item Quota Remarks Maximum number of certificates per CloudFront distribution 1 Maximum number of certificates that you can import into ACM 2500 Maximum number of certificates per AWS account (dedicated IP addresses only) 2 One for everyday use and one for when you need to rotate certificates for multiple distributions. Using the same certificate for CloudFront distributions that were created by using different AWS accounts No Using the same certificate for CloudFront and for other AWS services Yes","title":"Quotas"},{"location":"revisions/","text":"Date Change March 2021 Initial release of version 1.0.0 July 2021 Released version 1.1.0 1. Added 12 Lambda@Edge functions and 9 CloudFront Functions; 2. Added CloudFront security automation with AWS WAF and AWS Shield Advanced December 2021 Released version 1.2.0 1. Added 10 Lambda@Edge functions and 2 CloudFront functions February 2022 Released version 1.3.0 1. Added a CloudFront real-time log monitoring API which provides performance metrics August 2022 Released version 2.0.0 1. Added a user-friendly web console","title":"Revisions"},{"location":"security/","text":"When you build systems on AWS infrastructure, security responsibilities are shared between you and Amazon Web Services. This shared model reduces your operational burden because Amazon Web Services operates, manages, and controls the components including the host operating system, the virtualization layer, and the physical security of the facilities in which the services operate. For more information about Amazon Web Services security, visit AWS Cloud Security . IAM roles AWS Identity and Access Management (IAM) roles allow customers to assign granular access policies and permissions to services and users on the AWS Cloud. This solution creates IAM roles that grant the solution\u2019s access between the solution components.","title":"Security"},{"location":"security/#iam-roles","text":"AWS Identity and Access Management (IAM) roles allow customers to assign granular access policies and permissions to services and users on the AWS Cloud. This solution creates IAM roles that grant the solution\u2019s access between the solution components.","title":"IAM roles"},{"location":"source/","text":"Visit our GitHub repository to download the templates and scripts for this solution. The CloudFront Extensions template is generated using the Amazon Cloud Development Kit (CDK) . Refer to the README.md file for additional information.","title":"Source code"},{"location":"template/","text":"To automate deployment, this solution uses the following AWS CloudFormation templates, which you can download before deployment: CloudFront Extensions Console CloudFrontExtnConsoleStack.template.json : Use this template to launch the solution and all associated components. The default configuration deploys monitoring dashboard, distribution management and extension repository, but you can customize the template to meet your specific needs.","title":"Template"},{"location":"template/#cloudfront-extensions-console","text":"CloudFrontExtnConsoleStack.template.json : Use this template to launch the solution and all associated components. The default configuration deploys monitoring dashboard, distribution management and extension repository, but you can customize the template to meet your specific needs.","title":"CloudFront Extensions Console"},{"location":"trouble-shooting/","text":"Troubleshooting Errors The following help you to fix errors or problems that you might encounter when using CloudFront Extensions. SSL Certificates Failed to request ACM certificate When you \"request new certificates\" from Web UI or api , you may find job failed, following is an example screenshot: The detailed error message will show up in the Step section in red color. You can see in this case the error is caused by domain name is not valid which caused backend request ACM certificate fail.","title":"Troubleshooting Errors"},{"location":"trouble-shooting/#troubleshooting-errors","text":"The following help you to fix errors or problems that you might encounter when using CloudFront Extensions.","title":"Troubleshooting Errors"},{"location":"trouble-shooting/#ssl-certificates","text":"","title":"SSL Certificates"},{"location":"trouble-shooting/#failed-to-request-acm-certificate","text":"When you \"request new certificates\" from Web UI or api , you may find job failed, following is an example screenshot: The detailed error message will show up in the Step section in red color. You can see in this case the error is caused by domain name is not valid which caused backend request ACM certificate fail.","title":"Failed to request ACM certificate"},{"location":"uninstall/","text":"To uninstall the CloudFront Extensions solution, you must delete the AWS CloudFormation stack. You can use either the AWS Management Console or the AWS Command Line Interface (AWS CLI) to delete the CloudFormation stack. Uninstall the stack using the AWS Management Console Sign in to the AWS CloudFormation console. Select this solution\u2019s installation parent stack. Choose Delete . Uninstall the stack using AWS Command Line Interface Determine whether the AWS CLI is available in your environment. For installation instructions, refer to What Is the AWS Command Line Interface in the AWS CLI User Guide . After confirming that the AWS CLI is available, run the following command. aws cloudformation delete-stack --stack-name <installation-stack-name> --region <aws-region>","title":"Uninstall the solution"},{"location":"uninstall/#uninstall-the-stack-using-the-aws-management-console","text":"Sign in to the AWS CloudFormation console. Select this solution\u2019s installation parent stack. Choose Delete .","title":"Uninstall the stack using the AWS Management Console"},{"location":"uninstall/#uninstall-the-stack-using-aws-command-line-interface","text":"Determine whether the AWS CLI is available in your environment. For installation instructions, refer to What Is the AWS Command Line Interface in the AWS CLI User Guide . After confirming that the AWS CLI is available, run the following command. aws cloudformation delete-stack --stack-name <installation-stack-name> --region <aws-region>","title":"Uninstall the stack using AWS Command Line Interface"},{"location":"api-reference-guide/distribution-management/","text":"SSL Certificate related API import-create-ssl cert_list list_ssl_certification_with_jobId list_cloudfront_arn_with_jobId list_ssl_jobs get_ssl_job Snapshot related API create_snapshot delete_snapshot list_snapshots diff_cloudfront_snapshot get_snapshot_link apply_snapshot config_snapshot_tag_update","title":"Distribution Management"},{"location":"api-reference-guide/distribution-management/#ssl-certificate-related-api","text":"import-create-ssl cert_list list_ssl_certification_with_jobId list_cloudfront_arn_with_jobId list_ssl_jobs get_ssl_job","title":"SSL Certificate related API"},{"location":"api-reference-guide/distribution-management/#snapshot-related-api","text":"create_snapshot delete_snapshot list_snapshots diff_cloudfront_snapshot get_snapshot_link apply_snapshot config_snapshot_tag_update","title":"Snapshot related API"},{"location":"api-reference-guide/extension-repository/","text":"Pre-warming HTTP request method: POST Request { \"url_list\": [ \"https://{host}/index.html\", \"https://{host}/images/demo.png\" ], \"cf_domain\": \"d3hvi5wvyqg3lv.cloudfront.net\", // Optional, if not set cf_domain, it will find cf_domain according to CName in the url list \"region\": [\"ATL56-C1\", \"DFW55-C3\"]|\"all\"|\"apac\"|\"au\"|\"ca\"|\"sa\"|\"eu\"|\"jp\"|\"us\" // \"all\" to prewarm all pop node } Request body parameters url_list: The list of urls for prewarm. cf_domain: CloudFront domain name which ends with cloudfront.net . If not set, it will find cf_domain according to CNAME in the url list. region: The region for prewarm. You can specify 3 types of value. all: prewarm in all regions pop id list such as [\"ATL56-C1\", \"DFW55-C3\"]: prewarm in the PoP location in the list region code: pre-warm in a specific region, the available regions are: apac: Asia-Pacific au: Australia ca: Canada sa: South Africa eu: Europe jp: Japan us: United States Response { \"requestID\": \"4f780687-9774-48cd-bd7d-db836abf45af\" } Response parameters requestID : The request ID, which you can use in PrewarmStatus API to get the prewarm status. PrewarmStatus HTTP request method: GET Request { \"requestID\": \"4f780687-9774-48cd-bd7d-db836abf45af\" } Request body parameters requestID : a unique ID for each request. Response { \"status\": \"COMPLETED\" | \"IN_PROGRESS\" | \"TIMEOUT\" | \"FAILED\", \"total\": 20, \"completed\": 17, \"inProgress\": 3, \"failedUrl\": [\"https://www.example.com/images/demo.png\"] \"inProgressUrl\": [\"https://www.example.com/images/demo1.png\"] \"successUrl\": [\"https://www.example.com/images/xx.png\"] } Response parameters status : the overall prewarm status total : total url count to pre-warm completed : the count of urls which are prewarmed inProgress : the count of urls which are being prewarmed failedUrl : the list of urls which are failed to prewarm inProgressUrl : the list of urls which are being prewarmed successUrl : the list of urls which are successfully prewarmed","title":"Extension repository"},{"location":"api-reference-guide/extension-repository/#pre-warming","text":"HTTP request method: POST Request { \"url_list\": [ \"https://{host}/index.html\", \"https://{host}/images/demo.png\" ], \"cf_domain\": \"d3hvi5wvyqg3lv.cloudfront.net\", // Optional, if not set cf_domain, it will find cf_domain according to CName in the url list \"region\": [\"ATL56-C1\", \"DFW55-C3\"]|\"all\"|\"apac\"|\"au\"|\"ca\"|\"sa\"|\"eu\"|\"jp\"|\"us\" // \"all\" to prewarm all pop node } Request body parameters url_list: The list of urls for prewarm. cf_domain: CloudFront domain name which ends with cloudfront.net . If not set, it will find cf_domain according to CNAME in the url list. region: The region for prewarm. You can specify 3 types of value. all: prewarm in all regions pop id list such as [\"ATL56-C1\", \"DFW55-C3\"]: prewarm in the PoP location in the list region code: pre-warm in a specific region, the available regions are: apac: Asia-Pacific au: Australia ca: Canada sa: South Africa eu: Europe jp: Japan us: United States Response { \"requestID\": \"4f780687-9774-48cd-bd7d-db836abf45af\" } Response parameters requestID : The request ID, which you can use in PrewarmStatus API to get the prewarm status.","title":"Pre-warming"},{"location":"api-reference-guide/extension-repository/#prewarmstatus","text":"HTTP request method: GET Request { \"requestID\": \"4f780687-9774-48cd-bd7d-db836abf45af\" } Request body parameters requestID : a unique ID for each request. Response { \"status\": \"COMPLETED\" | \"IN_PROGRESS\" | \"TIMEOUT\" | \"FAILED\", \"total\": 20, \"completed\": 17, \"inProgress\": 3, \"failedUrl\": [\"https://www.example.com/images/demo.png\"] \"inProgressUrl\": [\"https://www.example.com/images/demo1.png\"] \"successUrl\": [\"https://www.example.com/images/xx.png\"] } Response parameters status : the overall prewarm status total : total url count to pre-warm completed : the count of urls which are prewarmed inProgress : the count of urls which are being prewarmed failedUrl : the list of urls which are failed to prewarm inProgressUrl : the list of urls which are being prewarmed successUrl : the list of urls which are successfully prewarmed","title":"PrewarmStatus"},{"location":"api-reference-guide/monitoring/","text":"CloudFront real-time log analysis and standard log analysis have the same API format. The metric data are collected every 5 minutes, you can customize it by update the metricCollector Lambda functions. NonRealTimeMonitoringMetrics HTTP request method: GET Request { \"StartTime\": \"2021-10-21 11:00:00\", \"EndTime\": \"2021-10-21 11:00:00\", \"Metric\": \"all\" | \"request\" | \"requestOrigin\" | \"statusCode\" | \"statusCodeOrigin\" | \"chr\" | \"chrBandWith\" | \"bandwidth\" | \"bandwidthOrigin\" | \"topNUrlRequests\" | \"topNUrlSize\" | \"downstreamTraffic\" } Request body parameters StartTime: start time to get the metric data EndTime: end time to get the metric data Metric: metric type, use all if you want to get all metrics Response { \"Response\": { \"Data\": [ { \"CdnData\": [ { \"Metric\": \"request\", \"DetailData\": [ { \"Time\": \"2022-06-23 12:50:00\", \"Value\": \"41\" }, { \"Time\": \"2022-06-23 12:55:00\", \"Value\": \"45\" }, { \"Time\": \"2022-06-23 13:00:00\", \"Value\": \"39\" } ] } ] } ], \"RequestId\": \"05228fbe-65b1-4670-85ba-0d7307ece749\", \"Interval\": \"5min\" } } Parameters CdnData: CloudFront metric data Metric: the metric type DetailData: detailed metric data in each timestamp RequestId: a unique ID for each request Interval: the interval for collecting metric data, and the default value is 5 minutes RealTimeMonitoringMetrics HTTP request method: GET Request { \"StartTime\": \"2021-10-21 11:00:00\", \"EndTime\": \"2021-10-21 11:00:00\", \"Metric\": \"all\" | \"request\" | \"requestOrigin\" | \"statusCode\" | \"statusCodeOrigin\" | \"chr\" | \"chrBandWith\" | \"bandwidth\" | \"bandwidthOrigin\" | \"downloadSpeed\" | \"downloadSpeedOrigin\" | \"topNUrlRequests\" | \"topNUrlSize\" | \"downstreamTraffic\" } Request body parameters StartTime: start time to get the metric data EndTime: end time to get the metric data Metric: metric type, use all if you want to get all metrics Response { \"Response\": { \"Data\": [ { \"CdnData\": [ { \"Metric\": \"request\", \"DetailData\": [ { \"Time\": \"2022-06-23 12:50:00\", \"Value\": \"41\" }, { \"Time\": \"2022-06-23 12:55:00\", \"Value\": \"45\" }, { \"Time\": \"2022-06-23 13:00:00\", \"Value\": \"39\" } ] } ] } ], \"RequestId\": \"05228fbe-65b1-4670-85ba-0d7307ece749\", \"Interval\": \"5min\" } } Parameters CdnData: CloudFront metric data Metric: the metric type DetailData: detailed metric data in each timestamp RequestId: a unique ID for each request Interval: the interval for collecting metric data, and the default value is 5 minutes More example API URI format https://domain-name.com/prod/metric?StartTime=2021-10-21%2011:00:00&EndTime=2021-10-21%2011:30:00&Metric=all&Domain=example.cloudfront.net Response The metric data are collected every 5 minutes, you can customize it by update the metricCollector Lambda functions Request number { \"Response\": { \"Data\": [ { \"CdnData\": [ { \"Metric\": \"request\", \"DetailData\": [ { \"Time\": \"2021-10-21 11:05:00\", \"Value\": \"430\" }, { \"Time\": \"2021-10-21 11:10:00\", \"Value\": \"124\" }, { \"Time\": \"2021-10-21 11:15:00\", \"Value\": \"355\" }, { \"Time\": \"2021-10-21 11:20:00\", \"Value\": \"65\" }, { \"Time\": \"2021-10-21 11:25:00\", \"Value\": \"361\" }, { \"Time\": \"2021-10-21 11:30:00\", \"Value\": \"83\" } ] } ] } ], \"RequestId\": \"7569bbc3-a3ec-4ff3-94ec-f81a63ff5587\", \"Interval\": \"5min\" } } Bandwidth { \"Response\": { \"Data\": [ { \"CdnData\": [ { \"Metric\": \"bandwidth\", \"DetailData\": [ { \"Time\": \"2021-10-21 11:05:00\", \"Value\": \"3434275\" }, { \"Time\": \"2021-10-21 11:10:00\", \"Value\": \"1385221\" }, { \"Time\": \"2021-10-21 11:15:00\", \"Value\": \"2248372\" }, { \"Time\": \"2021-10-21 11:20:00\", \"Value\": \"410043\" }, { \"Time\": \"2021-10-21 11:25:00\", \"Value\": \"2261034\" }, { \"Time\": \"2021-10-21 11:30:00\", \"Value\": \"522360\" } ] } ] } ], \"RequestId\": \"7569bbc3-a3ec-4ff3-94ec-f81a63ff5587\", \"Interval\": \"5min\" } } Download speed { \"Response\": { \"Data\": [ { \"CdnData\": [ { \"Metric\": \"downloadSpeed\", \"DetailData\": [ { \"Time\": \"2021-10-21 11:05:00\", \"Value\": { \"CN\": { \"Beijing Guanghuan Xinwang Digital\": { \"750K\": \"0\", \"250K\": \"0.25\", \"4M\": \"0\", \"3M\": \"0\", \"2M\": \"0\", \"1M\": \"0\", \"500K\": \"0.75\", \"Other\": \"0\" } }, \"IT\": { \"G-Core Labs S.A.\": { \"750K\": \"0\", \"250K\": \"0\", \"4M\": \"1\", \"3M\": \"0\", \"2M\": \"0\", \"1M\": \"0\", \"500K\": \"0\", \"Other\": \"0\" }, \"Aruba S.p.A.\": { \"750K\": \"0\", \"250K\": \"1\", \"4M\": \"0\", \"3M\": \"0\", \"2M\": \"0\", \"1M\": \"0\", \"500K\": \"0\", \"Other\": \"0\" }, \"Seflow S.N.C. Di Marco Brame' & C.\": { \"750K\": \"0\", \"250K\": \"1\", \"4M\": \"0\", \"3M\": \"0\", \"2M\": \"0\", \"1M\": \"0\", \"500K\": \"0\", \"Other\": \"0\" } }, \"timestamp\": \"1634814300\", \"domain\": \"example.cloudfront.net\" } } ] } ] } ], \"RequestId\": \"7569bbc3-a3ec-4ff3-94ec-f81a63ff5587\", \"Interval\": \"5min\" } } CHR { \"Response\": { \"Data\": [ { \"CdnData\": [ { \"Metric\": \"chr\", \"DetailData\": [ { \"Time\": \"2021-10-21 11:05:00\", \"Value\": \"94.83\" }, { \"Time\": \"2021-10-21 11:10:00\", \"Value\": \"98.98\" }, { \"Time\": \"2021-10-21 11:15:00\", \"Value\": \"95.35\" }, { \"Time\": \"2021-10-21 11:20:00\", \"Value\": \"100.00\" }, { \"Time\": \"2021-10-21 11:25:00\", \"Value\": \"99.02\" }, { \"Time\": \"2021-10-21 11:30:00\", \"Value\": \"92.65\" } ] } ] } ], \"RequestId\": \"7569bbc3-a3ec-4ff3-94ec-f81a63ff5587\", \"Interval\": \"5min\" } } Status code { \"Response\": { \"Data\": [ { \"CdnData\": [ { \"Metric\": \"statusCode\", \"DetailData\": [ { \"Time\": \"2021-10-21 11:05:00\", \"Value\": [ { \"StatusCode\": \"403\", \"Count\": \"80\" }, { \"StatusCode\": \"200\", \"Count\": \"348\" }, { \"StatusCode\": \"499\", \"Count\": \"2\" } ] }, { \"Time\": \"2021-10-21 11:10:00\", \"Value\": [ { \"StatusCode\": \"200\", \"Count\": \"98\" }, { \"StatusCode\": \"403\", \"Count\": \"26\" } ] }, { \"Time\": \"2021-10-21 11:15:00\", \"Value\": [ { \"StatusCode\": \"200\", \"Count\": \"299\" }, { \"StatusCode\": \"403\", \"Count\": \"56\" } ] }, { \"Time\": \"2021-10-21 11:20:00\", \"Value\": [ { \"StatusCode\": \"200\", \"Count\": \"54\" }, { \"StatusCode\": \"403\", \"Count\": \"11\" } ] }, { \"Time\": \"2021-10-21 11:25:00\", \"Value\": [ { \"StatusCode\": \"403\", \"Count\": \"56\" }, { \"StatusCode\": \"200\", \"Count\": \"304\" }, { \"StatusCode\": \"499\", \"Count\": \"1\" } ] }, { \"Time\": \"2021-10-21 11:30:00\", \"Value\": [ { \"StatusCode\": \"403\", \"Count\": \"15\" }, { \"StatusCode\": \"200\", \"Count\": \"68\" } ] } ] } ] } ], \"RequestId\": \"7569bbc3-a3ec-4ff3-94ec-f81a63ff5587\", \"Interval\": \"5min\" } }","title":"Monitoring"},{"location":"api-reference-guide/monitoring/#nonrealtimemonitoringmetrics","text":"HTTP request method: GET Request { \"StartTime\": \"2021-10-21 11:00:00\", \"EndTime\": \"2021-10-21 11:00:00\", \"Metric\": \"all\" | \"request\" | \"requestOrigin\" | \"statusCode\" | \"statusCodeOrigin\" | \"chr\" | \"chrBandWith\" | \"bandwidth\" | \"bandwidthOrigin\" | \"topNUrlRequests\" | \"topNUrlSize\" | \"downstreamTraffic\" } Request body parameters StartTime: start time to get the metric data EndTime: end time to get the metric data Metric: metric type, use all if you want to get all metrics Response { \"Response\": { \"Data\": [ { \"CdnData\": [ { \"Metric\": \"request\", \"DetailData\": [ { \"Time\": \"2022-06-23 12:50:00\", \"Value\": \"41\" }, { \"Time\": \"2022-06-23 12:55:00\", \"Value\": \"45\" }, { \"Time\": \"2022-06-23 13:00:00\", \"Value\": \"39\" } ] } ] } ], \"RequestId\": \"05228fbe-65b1-4670-85ba-0d7307ece749\", \"Interval\": \"5min\" } } Parameters CdnData: CloudFront metric data Metric: the metric type DetailData: detailed metric data in each timestamp RequestId: a unique ID for each request Interval: the interval for collecting metric data, and the default value is 5 minutes","title":"NonRealTimeMonitoringMetrics"},{"location":"api-reference-guide/monitoring/#realtimemonitoringmetrics","text":"HTTP request method: GET Request { \"StartTime\": \"2021-10-21 11:00:00\", \"EndTime\": \"2021-10-21 11:00:00\", \"Metric\": \"all\" | \"request\" | \"requestOrigin\" | \"statusCode\" | \"statusCodeOrigin\" | \"chr\" | \"chrBandWith\" | \"bandwidth\" | \"bandwidthOrigin\" | \"downloadSpeed\" | \"downloadSpeedOrigin\" | \"topNUrlRequests\" | \"topNUrlSize\" | \"downstreamTraffic\" } Request body parameters StartTime: start time to get the metric data EndTime: end time to get the metric data Metric: metric type, use all if you want to get all metrics Response { \"Response\": { \"Data\": [ { \"CdnData\": [ { \"Metric\": \"request\", \"DetailData\": [ { \"Time\": \"2022-06-23 12:50:00\", \"Value\": \"41\" }, { \"Time\": \"2022-06-23 12:55:00\", \"Value\": \"45\" }, { \"Time\": \"2022-06-23 13:00:00\", \"Value\": \"39\" } ] } ] } ], \"RequestId\": \"05228fbe-65b1-4670-85ba-0d7307ece749\", \"Interval\": \"5min\" } } Parameters CdnData: CloudFront metric data Metric: the metric type DetailData: detailed metric data in each timestamp RequestId: a unique ID for each request Interval: the interval for collecting metric data, and the default value is 5 minutes","title":"RealTimeMonitoringMetrics"},{"location":"api-reference-guide/monitoring/#more-example-api","text":"","title":"More example API"},{"location":"api-reference-guide/monitoring/#uri-format","text":"https://domain-name.com/prod/metric?StartTime=2021-10-21%2011:00:00&EndTime=2021-10-21%2011:30:00&Metric=all&Domain=example.cloudfront.net","title":"URI format"},{"location":"api-reference-guide/monitoring/#response","text":"The metric data are collected every 5 minutes, you can customize it by update the metricCollector Lambda functions","title":"Response"},{"location":"api-reference-guide/monitoring/#request-number","text":"{ \"Response\": { \"Data\": [ { \"CdnData\": [ { \"Metric\": \"request\", \"DetailData\": [ { \"Time\": \"2021-10-21 11:05:00\", \"Value\": \"430\" }, { \"Time\": \"2021-10-21 11:10:00\", \"Value\": \"124\" }, { \"Time\": \"2021-10-21 11:15:00\", \"Value\": \"355\" }, { \"Time\": \"2021-10-21 11:20:00\", \"Value\": \"65\" }, { \"Time\": \"2021-10-21 11:25:00\", \"Value\": \"361\" }, { \"Time\": \"2021-10-21 11:30:00\", \"Value\": \"83\" } ] } ] } ], \"RequestId\": \"7569bbc3-a3ec-4ff3-94ec-f81a63ff5587\", \"Interval\": \"5min\" } }","title":"Request number"},{"location":"api-reference-guide/monitoring/#bandwidth","text":"{ \"Response\": { \"Data\": [ { \"CdnData\": [ { \"Metric\": \"bandwidth\", \"DetailData\": [ { \"Time\": \"2021-10-21 11:05:00\", \"Value\": \"3434275\" }, { \"Time\": \"2021-10-21 11:10:00\", \"Value\": \"1385221\" }, { \"Time\": \"2021-10-21 11:15:00\", \"Value\": \"2248372\" }, { \"Time\": \"2021-10-21 11:20:00\", \"Value\": \"410043\" }, { \"Time\": \"2021-10-21 11:25:00\", \"Value\": \"2261034\" }, { \"Time\": \"2021-10-21 11:30:00\", \"Value\": \"522360\" } ] } ] } ], \"RequestId\": \"7569bbc3-a3ec-4ff3-94ec-f81a63ff5587\", \"Interval\": \"5min\" } }","title":"Bandwidth"},{"location":"api-reference-guide/monitoring/#download-speed","text":"{ \"Response\": { \"Data\": [ { \"CdnData\": [ { \"Metric\": \"downloadSpeed\", \"DetailData\": [ { \"Time\": \"2021-10-21 11:05:00\", \"Value\": { \"CN\": { \"Beijing Guanghuan Xinwang Digital\": { \"750K\": \"0\", \"250K\": \"0.25\", \"4M\": \"0\", \"3M\": \"0\", \"2M\": \"0\", \"1M\": \"0\", \"500K\": \"0.75\", \"Other\": \"0\" } }, \"IT\": { \"G-Core Labs S.A.\": { \"750K\": \"0\", \"250K\": \"0\", \"4M\": \"1\", \"3M\": \"0\", \"2M\": \"0\", \"1M\": \"0\", \"500K\": \"0\", \"Other\": \"0\" }, \"Aruba S.p.A.\": { \"750K\": \"0\", \"250K\": \"1\", \"4M\": \"0\", \"3M\": \"0\", \"2M\": \"0\", \"1M\": \"0\", \"500K\": \"0\", \"Other\": \"0\" }, \"Seflow S.N.C. Di Marco Brame' & C.\": { \"750K\": \"0\", \"250K\": \"1\", \"4M\": \"0\", \"3M\": \"0\", \"2M\": \"0\", \"1M\": \"0\", \"500K\": \"0\", \"Other\": \"0\" } }, \"timestamp\": \"1634814300\", \"domain\": \"example.cloudfront.net\" } } ] } ] } ], \"RequestId\": \"7569bbc3-a3ec-4ff3-94ec-f81a63ff5587\", \"Interval\": \"5min\" } }","title":"Download speed"},{"location":"api-reference-guide/monitoring/#chr","text":"{ \"Response\": { \"Data\": [ { \"CdnData\": [ { \"Metric\": \"chr\", \"DetailData\": [ { \"Time\": \"2021-10-21 11:05:00\", \"Value\": \"94.83\" }, { \"Time\": \"2021-10-21 11:10:00\", \"Value\": \"98.98\" }, { \"Time\": \"2021-10-21 11:15:00\", \"Value\": \"95.35\" }, { \"Time\": \"2021-10-21 11:20:00\", \"Value\": \"100.00\" }, { \"Time\": \"2021-10-21 11:25:00\", \"Value\": \"99.02\" }, { \"Time\": \"2021-10-21 11:30:00\", \"Value\": \"92.65\" } ] } ] } ], \"RequestId\": \"7569bbc3-a3ec-4ff3-94ec-f81a63ff5587\", \"Interval\": \"5min\" } }","title":"CHR"},{"location":"api-reference-guide/monitoring/#status-code","text":"{ \"Response\": { \"Data\": [ { \"CdnData\": [ { \"Metric\": \"statusCode\", \"DetailData\": [ { \"Time\": \"2021-10-21 11:05:00\", \"Value\": [ { \"StatusCode\": \"403\", \"Count\": \"80\" }, { \"StatusCode\": \"200\", \"Count\": \"348\" }, { \"StatusCode\": \"499\", \"Count\": \"2\" } ] }, { \"Time\": \"2021-10-21 11:10:00\", \"Value\": [ { \"StatusCode\": \"200\", \"Count\": \"98\" }, { \"StatusCode\": \"403\", \"Count\": \"26\" } ] }, { \"Time\": \"2021-10-21 11:15:00\", \"Value\": [ { \"StatusCode\": \"200\", \"Count\": \"299\" }, { \"StatusCode\": \"403\", \"Count\": \"56\" } ] }, { \"Time\": \"2021-10-21 11:20:00\", \"Value\": [ { \"StatusCode\": \"200\", \"Count\": \"54\" }, { \"StatusCode\": \"403\", \"Count\": \"11\" } ] }, { \"Time\": \"2021-10-21 11:25:00\", \"Value\": [ { \"StatusCode\": \"403\", \"Count\": \"56\" }, { \"StatusCode\": \"200\", \"Count\": \"304\" }, { \"StatusCode\": \"499\", \"Count\": \"1\" } ] }, { \"Time\": \"2021-10-21 11:30:00\", \"Value\": [ { \"StatusCode\": \"403\", \"Count\": \"15\" }, { \"StatusCode\": \"200\", \"Count\": \"68\" } ] } ] } ] } ], \"RequestId\": \"7569bbc3-a3ec-4ff3-94ec-f81a63ff5587\", \"Interval\": \"5min\" } }","title":"Status code"},{"location":"api-reference-guide/overview/","text":"API reference guide You can use the functions through the web console or via API calls: Monitoring Extensions repository Distribution management","title":"Overview"},{"location":"api-reference-guide/overview/#api-reference-guide","text":"You can use the functions through the web console or via API calls: Monitoring Extensions repository Distribution management","title":"API reference guide"},{"location":"api-reference-guide/snapshot/apply-snapshot/","text":"apply_snapshot HTTP request method: POST Request /snapshot/apply_snapshot?src_distribution_id= E3K4JDLORL0EUD&target_distribution_ids=E3K4JDLORL0EUD&snapshot_name= snapshot1 Request body parameters src_distribution_id: String target_distribution_ids: String (use \",\" to seperate multiple target distribution) snapshot_name: String Response { \"statusCode\": 200, \"body\": \"succeed apply snapshot to target distributions\" }","title":"Apply snapshot"},{"location":"api-reference-guide/snapshot/apply-snapshot/#apply_snapshot","text":"HTTP request method: POST Request /snapshot/apply_snapshot?src_distribution_id= E3K4JDLORL0EUD&target_distribution_ids=E3K4JDLORL0EUD&snapshot_name= snapshot1 Request body parameters src_distribution_id: String target_distribution_ids: String (use \",\" to seperate multiple target distribution) snapshot_name: String Response { \"statusCode\": 200, \"body\": \"succeed apply snapshot to target distributions\" }","title":"apply_snapshot"},{"location":"api-reference-guide/snapshot/config_snapshot_tag_update/","text":"config_snapshot_tag_update HTTP request method: POST Request /snapshot/config_snapshot_tag_update?distribution_id=E3K4JDLORL0EUD&snapshot_name=snapshot1&note=\u6d4b\u8bd5\u7248\u672csnapshot Request body parameters distribution_id: String note: String snapshot_name: String Response { \"Attributes\": { \"note\": \"Test snapshot\" }, \"ResponseMetadata\": { \"RequestId\": \"5GLP3OHORDIUPQPUFP50394ARJVV4KQNSO5AEMVJF66Q9ASUAAJG\", \"HTTPStatusCode\": 200, \"HTTPHeaders\": { \"server\": \"Server\", \"date\": \"Thu, 04 Aug 2022 05:14:11 GMT\", \"content-type\": \"application/x-amz-json-1.0\", \"content-length\": \"52\", \"connection\": \"keep-alive\", \"x-amzn-requestid\": \"5GLP3OHORDIUPQPUFP50394ARJVV4KQNSO5AEMVJF66Q9ASUAAJG\", \"x-amz-crc32\": \"1735756187\" }, \"RetryAttempts\": 0 } }","title":"Config snapshot tag update"},{"location":"api-reference-guide/snapshot/config_snapshot_tag_update/#config_snapshot_tag_update","text":"HTTP request method: POST Request /snapshot/config_snapshot_tag_update?distribution_id=E3K4JDLORL0EUD&snapshot_name=snapshot1&note=\u6d4b\u8bd5\u7248\u672csnapshot Request body parameters distribution_id: String note: String snapshot_name: String Response { \"Attributes\": { \"note\": \"Test snapshot\" }, \"ResponseMetadata\": { \"RequestId\": \"5GLP3OHORDIUPQPUFP50394ARJVV4KQNSO5AEMVJF66Q9ASUAAJG\", \"HTTPStatusCode\": 200, \"HTTPHeaders\": { \"server\": \"Server\", \"date\": \"Thu, 04 Aug 2022 05:14:11 GMT\", \"content-type\": \"application/x-amz-json-1.0\", \"content-length\": \"52\", \"connection\": \"keep-alive\", \"x-amzn-requestid\": \"5GLP3OHORDIUPQPUFP50394ARJVV4KQNSO5AEMVJF66Q9ASUAAJG\", \"x-amz-crc32\": \"1735756187\" }, \"RetryAttempts\": 0 } }","title":"config_snapshot_tag_update"},{"location":"api-reference-guide/snapshot/create_snapshot/","text":"create_snapshot HTTP request method: POST Request /snapshot/create_snapshot?distributionId=E20GR9AX7K798K&snapShotName=ReleaseSnapshot&snapShotNote=\"This is for Testing\" Request body parameters distributionId: String snapShotName: String snapShotNote: String Response { \"statusCode\": 200, \"body\": \"succeed create new snapshot\" }","title":"Create snapshot"},{"location":"api-reference-guide/snapshot/create_snapshot/#create_snapshot","text":"HTTP request method: POST Request /snapshot/create_snapshot?distributionId=E20GR9AX7K798K&snapShotName=ReleaseSnapshot&snapShotNote=\"This is for Testing\" Request body parameters distributionId: String snapShotName: String snapShotNote: String Response { \"statusCode\": 200, \"body\": \"succeed create new snapshot\" }","title":"create_snapshot"},{"location":"api-reference-guide/snapshot/delete_snapshot/","text":"delete_snapshot HTTP request method: POST Request /snapshot/delete_snapshot?distributionId=E20GR9AX7K798K&snapShotName=dfdfd Request body parameters distributionId: String snapShotName: String Response { \"statusCode\": 200, \"body\": \"succeed delete snapshot\" }","title":"Delete snapshot"},{"location":"api-reference-guide/snapshot/delete_snapshot/#delete_snapshot","text":"HTTP request method: POST Request /snapshot/delete_snapshot?distributionId=E20GR9AX7K798K&snapShotName=dfdfd Request body parameters distributionId: String snapShotName: String Response { \"statusCode\": 200, \"body\": \"succeed delete snapshot\" }","title":"delete_snapshot"},{"location":"api-reference-guide/snapshot/diff_cloudfront_snapshot/","text":"diff_cloudfront_snapshot HTTP request method: POST Request /snapshot/diff_cloudfront_snapshot?distribution_id=E20GR9AX7K798K&snapshot1=first Snapshot&snapshot2=snapshot2 Request body parameters distribution_id: String snapshot1: String snapshot2: String Response \"diff --git a/tmp/E20GR9AX7K798K_3.json b/tmp/E20GR9AX7K798K_6.json\\nindex 4bded46..cb7824e 100644\\n--- a/tmp/E20GR9AX7K798K_3.json\\n+++ b/tmp/E20GR9AX7K798K_6.json\\n@@ -99,7 +99,7 @@\\n \\\"CustomErrorResponses\\\": {\\n \\\"Quantity\\\": 0\\n },\\n- \\\"Comment\\\": \\\"my test for cf\\\",\\n+ \\\"Comment\\\": \\\"my test for cf a new one\\\",\\n \\\"Logging\\\": {\\n \\\"Enabled\\\": false,\\n \\\"IncludeCookies\\\": false,\\n\"","title":"Diff cloudfront snapshot"},{"location":"api-reference-guide/snapshot/diff_cloudfront_snapshot/#diff_cloudfront_snapshot","text":"HTTP request method: POST Request /snapshot/diff_cloudfront_snapshot?distribution_id=E20GR9AX7K798K&snapshot1=first Snapshot&snapshot2=snapshot2 Request body parameters distribution_id: String snapshot1: String snapshot2: String Response \"diff --git a/tmp/E20GR9AX7K798K_3.json b/tmp/E20GR9AX7K798K_6.json\\nindex 4bded46..cb7824e 100644\\n--- a/tmp/E20GR9AX7K798K_3.json\\n+++ b/tmp/E20GR9AX7K798K_6.json\\n@@ -99,7 +99,7 @@\\n \\\"CustomErrorResponses\\\": {\\n \\\"Quantity\\\": 0\\n },\\n- \\\"Comment\\\": \\\"my test for cf\\\",\\n+ \\\"Comment\\\": \\\"my test for cf a new one\\\",\\n \\\"Logging\\\": {\\n \\\"Enabled\\\": false,\\n \\\"IncludeCookies\\\": false,\\n\"","title":"diff_cloudfront_snapshot"},{"location":"api-reference-guide/snapshot/get_snapshot_link/","text":"get_snapshot_link HTTP request method: POST Request /snapshot/get_snapshot_link?distributionId=E20GR9AX7K798K&snapShotName=snapshot2 Request body parameters distributionId: String snapShotName: String Response { \"config_link\": \"s3://cloudfrontconfigversions-cloudfrontconfigversions-rtzhljpc7u0i/E20GR9AX7K798K/2022/06/30/E20GR9AX7K798K_2022-06-30-12-10-14.json\" }","title":"Get snapshot link"},{"location":"api-reference-guide/snapshot/get_snapshot_link/#get_snapshot_link","text":"HTTP request method: POST Request /snapshot/get_snapshot_link?distributionId=E20GR9AX7K798K&snapShotName=snapshot2 Request body parameters distributionId: String snapShotName: String Response { \"config_link\": \"s3://cloudfrontconfigversions-cloudfrontconfigversions-rtzhljpc7u0i/E20GR9AX7K798K/2022/06/30/E20GR9AX7K798K_2022-06-30-12-10-14.json\" }","title":"get_snapshot_link"},{"location":"api-reference-guide/snapshot/list_snapshots/","text":"list_snapshots HTTP request method: POST Request /snapshot/list_snapshots?distributionId=E20GR9AX7K798K Request body parameters distributionId: String Response [ { \"id\": \"snapshot2\", \"distribution_id\": \"E20GR9AX7K798K\", \"snapshot_name\": \"snapshot2\", \"note\": \"test note\", \"dateTime\": \"2022-06-30-12-10-16\", \"config_link\": \"s3://cloudfrontconfigversions-cloudfrontconfigversions-rtzhljpc7u0i/E20GR9AX7K798K/2022/06/30/E20GR9AX7K798K_2022-06-30-12-10-14.json\", \"s3_bucket\": \"cloudfrontconfigversions-cloudfrontconfigversions-rtzhljpc7u0i\", \"s3_key\": \"E20GR9AX7K798K/2022/06/30/E20GR9AX7K798K_2022-06-30-12-10-14.json\" }, { \"id\": \"first Snapshot\", \"distribution_id\": \"E20GR9AX7K798K\", \"snapshot_name\": \"first Snapshot\", \"note\": \"This is my first snapshot\", \"dateTime\": \"2022-06-30-11-44-32\", \"config_link\": \"s3://cloudfrontconfigversions-cloudfrontconfigversions-rtzhljpc7u0i/E20GR9AX7K798K/2022/06/30/E20GR9AX7K798K_2022-06-30-11-44-07.json\", \"s3_bucket\": \"cloudfrontconfigversions-cloudfrontconfigversions-rtzhljpc7u0i\", \"s3_key\": \"E20GR9AX7K798K/2022/06/30/E20GR9AX7K798K_2022-06-30-11-44-07.json\" }, { \"id\": \"_LATEST_\", \"distribution_id\": \"E20GR9AX7K798K\", \"snapshot_name\": \"_LATEST_\", \"note\": \"\", \"dateTime\": \"2022-06-30-11-42-39\", \"config_link\": \"s3://cloudfrontconfigversions-cloudfrontconfigversions-rtzhljpc7u0i/E20GR9AX7K798K/2022/07/31/E20GR9AX7K798K_2022-07-31-09-18-43.json\", \"s3_bucket\": \"cloudfrontconfigversions-cloudfrontconfigversions-rtzhljpc7u0i\", \"s3_key\": \"E20GR9AX7K798K/2022/07/31/E20GR9AX7K798K_2022-07-31-09-18-43.json\" } ]","title":"List snapshots"},{"location":"api-reference-guide/snapshot/list_snapshots/#list_snapshots","text":"HTTP request method: POST Request /snapshot/list_snapshots?distributionId=E20GR9AX7K798K Request body parameters distributionId: String Response [ { \"id\": \"snapshot2\", \"distribution_id\": \"E20GR9AX7K798K\", \"snapshot_name\": \"snapshot2\", \"note\": \"test note\", \"dateTime\": \"2022-06-30-12-10-16\", \"config_link\": \"s3://cloudfrontconfigversions-cloudfrontconfigversions-rtzhljpc7u0i/E20GR9AX7K798K/2022/06/30/E20GR9AX7K798K_2022-06-30-12-10-14.json\", \"s3_bucket\": \"cloudfrontconfigversions-cloudfrontconfigversions-rtzhljpc7u0i\", \"s3_key\": \"E20GR9AX7K798K/2022/06/30/E20GR9AX7K798K_2022-06-30-12-10-14.json\" }, { \"id\": \"first Snapshot\", \"distribution_id\": \"E20GR9AX7K798K\", \"snapshot_name\": \"first Snapshot\", \"note\": \"This is my first snapshot\", \"dateTime\": \"2022-06-30-11-44-32\", \"config_link\": \"s3://cloudfrontconfigversions-cloudfrontconfigversions-rtzhljpc7u0i/E20GR9AX7K798K/2022/06/30/E20GR9AX7K798K_2022-06-30-11-44-07.json\", \"s3_bucket\": \"cloudfrontconfigversions-cloudfrontconfigversions-rtzhljpc7u0i\", \"s3_key\": \"E20GR9AX7K798K/2022/06/30/E20GR9AX7K798K_2022-06-30-11-44-07.json\" }, { \"id\": \"_LATEST_\", \"distribution_id\": \"E20GR9AX7K798K\", \"snapshot_name\": \"_LATEST_\", \"note\": \"\", \"dateTime\": \"2022-06-30-11-42-39\", \"config_link\": \"s3://cloudfrontconfigversions-cloudfrontconfigversions-rtzhljpc7u0i/E20GR9AX7K798K/2022/07/31/E20GR9AX7K798K_2022-07-31-09-18-43.json\", \"s3_bucket\": \"cloudfrontconfigversions-cloudfrontconfigversions-rtzhljpc7u0i\", \"s3_key\": \"E20GR9AX7K798K/2022/07/31/E20GR9AX7K798K_2022-07-31-09-18-43.json\" } ]","title":"list_snapshots"},{"location":"api-reference-guide/ssl-certificates/get-ssl-job/","text":"get_ssl_job HTTP request method: GET Request /ssl_for_saas/get_ssl_job?jobId=f48db3b2-90e4-43b2-a46d-bd0e8530bc42 Request body parameters jobId: String Response { \"distList\": [], \"jobId\": \"f48db3b2-90e4-43b2-a46d-bd0e8530bc42\", \"creationDate\": \"2022-08-01-06-44-44\", \"cloudfront_distribution_total_number\": \"1\", \"certValidationStageStatus\": \"SUCCESS\", \"cert_total_number\": \"1\", \"certCreateStageStatus\": \"SUCCESS\", \"jobType\": \"create\", \"job_input\": \"{\\n \\\"acm_op\\\": \\\"create\\\",\\n \\\"auto_creation\\\": \\\"true\\\",\\n \\\"dist_aggregate\\\": \\\"false\\\",\\n \\\"enable_cname_check\\\": \\\"false\\\",\\n \\\"cnameList\\\": [\\n {\\n \\\"domainName\\\": \\\"web1.ssl-for-saas.demo.solutions.aws.a2z.org.cn\\\",\\n \\\"sanList\\\": [\\n \\\"web1.ssl-for-saas.demo.solutions.aws.a2z.org.cn\\\"\\n ],\\n \\\"originsItemsDomainName\\\": \\\"\\\",\\n \\\"existing_cf_info\\\": {\\n \\\"distribution_id\\\": \\\"E30J9PCOB6KHJV\\\",\\n \\\"config_version_id\\\": \\\"1\\\"\\n }\\n }\\n ],\\n \\\"aws_request_id\\\": \\\"f48db3b2-90e4-43b2-a46d-bd0e8530bc42\\\"\\n}\", \"certList\": [], \"cloudfront_distribution_created_number\": \"1\", \"promptInfo\": \"\", \"cert_completed_number\": \"1\", \"distStageStatus\": \"SUCCESS\" }","title":"Get ssl job"},{"location":"api-reference-guide/ssl-certificates/get-ssl-job/#get_ssl_job","text":"HTTP request method: GET Request /ssl_for_saas/get_ssl_job?jobId=f48db3b2-90e4-43b2-a46d-bd0e8530bc42 Request body parameters jobId: String Response { \"distList\": [], \"jobId\": \"f48db3b2-90e4-43b2-a46d-bd0e8530bc42\", \"creationDate\": \"2022-08-01-06-44-44\", \"cloudfront_distribution_total_number\": \"1\", \"certValidationStageStatus\": \"SUCCESS\", \"cert_total_number\": \"1\", \"certCreateStageStatus\": \"SUCCESS\", \"jobType\": \"create\", \"job_input\": \"{\\n \\\"acm_op\\\": \\\"create\\\",\\n \\\"auto_creation\\\": \\\"true\\\",\\n \\\"dist_aggregate\\\": \\\"false\\\",\\n \\\"enable_cname_check\\\": \\\"false\\\",\\n \\\"cnameList\\\": [\\n {\\n \\\"domainName\\\": \\\"web1.ssl-for-saas.demo.solutions.aws.a2z.org.cn\\\",\\n \\\"sanList\\\": [\\n \\\"web1.ssl-for-saas.demo.solutions.aws.a2z.org.cn\\\"\\n ],\\n \\\"originsItemsDomainName\\\": \\\"\\\",\\n \\\"existing_cf_info\\\": {\\n \\\"distribution_id\\\": \\\"E30J9PCOB6KHJV\\\",\\n \\\"config_version_id\\\": \\\"1\\\"\\n }\\n }\\n ],\\n \\\"aws_request_id\\\": \\\"f48db3b2-90e4-43b2-a46d-bd0e8530bc42\\\"\\n}\", \"certList\": [], \"cloudfront_distribution_created_number\": \"1\", \"promptInfo\": \"\", \"cert_completed_number\": \"1\", \"distStageStatus\": \"SUCCESS\" }","title":"get_ssl_job"},{"location":"api-reference-guide/ssl-certificates/import-create-ssl/","text":"import-create-ssl Important Please do not include more than 100 cname or pems records in one request. Too many requesting items in one request will cause backend ACM service and Cloudfront service throttle our request and cause the backend workflow failure. HTTP request method: POST Request Create one ACM certificate and auto create CloudFront distribution from existing distribution id and version id json { \"acm_op\": \"create\", \"auto_creation\": \"true\", \"cnameList\": [ { \"domainName\": \"YOURDOMAINNAME.COM\", \"sanList\": [ \"YOURDOMAINNAME.COM\", \"YOURDOMAINNAMEALIAS1.COM\" ], \"existing_cf_info\": { \"distribution_id\": \"E195R1W5GIVPF5\", \"config_version_id\": \"1\" } } ] } Create one ACM certificate and auto create CloudFront distribution from existing distribution id json { \"acm_op\": \"create\", \"auto_creation\": \"true\", \"cnameList\": [ { \"domainName\": \"YOURDOMAINNAME.COM\", \"sanList\": [ \"YOURDOMAINNAME.COM\", \"YOURDOMAINNAMEALIAS1.COM\" ], \"existing_cf_info\": { \"distribution_id\": \"E195R1W5GIVPF5\", } } ] } Create two ACM certificates and auto create CloudFront distribution from existing distribution id json { \"acm_op\": \"create\", \"auto_creation\": \"true\", \"cnameList\": [ { \"domainName\": \"YOURDOMAINNAME1.COM\", \"sanList\": [ \"YOURDOMAINNAME1.COM\", \"YOURDOMAINNAME1ALIAS1.COM\", \"YOURDOMAINNAME1ALIAS2.COM\" ], \"existing_cf_info\": { \"distribution_id\": \"E195R1W5GIVPF5\", } }, { \"domainName\": \"YOURDOMAINNAME2.COM\", \"sanList\": [ \"YOURDOMAINNAME2.COM\", \"YOURDOMAINNAME2ALIAS1.COM\", \"YOURDOMAINNAME2ALIAS1.COM\" ], \"existing_cf_info\": { \"distribution_id\": \"E195R1W5GIVPF5\", } } ] } Import one ACM certificate and auto create CloudFront distribution from existing distribution id json { \"acm_op\": \"import\", \"auto_creation\": \"true\", \"cnameList\": [], \"pemList\": [ { \"CertPem\": \"-----BEGIN CERTIFICATE-----\\nXXXXXXXXXXXX\\n-----END CERTIFICATE-----\", \"PrivateKeyPem\": \"-----BEGIN PRIVATE KEY-----\\nXXXXXXXXXXXX\\n-----END PRIVATE KEY-----\", \"ChainPem\": \"-----BEGIN CERTIFICATE-----\\nAAAAAAAAAAA\\n-----END CERTIFICATE-----\\n-----BEGIN CERTIFICATE-----\\nBBBBBBBBBBB\\n-----END CERTIFICATE-----\\n-----BEGIN CERTIFICATE-----\\nCCCCCCCCCCC\\n-----END CERTIFICATE-----\", \"existing_cf_info\": { \"distribution_id\": \"E1DACGTRXKKWCH\" } } ] } Import two ACM certificates and auto create CloudFront distribution from existing distribution id json { \"acm_op\": \"import\", \"auto_creation\": \"true\", \"cnameList\": [], \"pemList\": [ { \"CertPem\": \"-----BEGIN CERTIFICATE-----\\nXXXXXXXXXXXX\\n-----END CERTIFICATE-----\", \"PrivateKeyPem\": \"-----BEGIN PRIVATE KEY-----\\nXXXXXXXXXXXX\\n-----END PRIVATE KEY-----\", \"ChainPem\": \"-----BEGIN CERTIFICATE-----\\nAAAAAAAAAAA\\n-----END CERTIFICATE-----\\n-----BEGIN CERTIFICATE-----\\nBBBBBBBBBBB\\n-----END CERTIFICATE-----\\n-----BEGIN CERTIFICATE-----\\nCCCCCCCCCCC\\n-----END CERTIFICATE-----\", \"existing_cf_info\": { \"distribution_id\": \"E1DACGTRXKKWCH\" } }, { \"CertPem\": \"-----BEGIN CERTIFICATE-----\\nXXXXXXXXXXXX\\n-----END CERTIFICATE-----\", \"PrivateKeyPem\": \"-----BEGIN PRIVATE KEY-----\\nXXXXXXXXXXXX\\n-----END PRIVATE KEY-----\", \"ChainPem\": \"-----BEGIN CERTIFICATE-----\\nAAAAAAAAAAA\\n-----END CERTIFICATE-----\\n-----BEGIN CERTIFICATE-----\\nBBBBBBBBBBB\\n-----END CERTIFICATE-----\\n-----BEGIN CERTIFICATE-----\\nCCCCCCCCCCC\\n-----END CERTIFICATE-----\", \"existing_cf_info\": { \"distribution_id\": \"E1DACGTRXKKWCH\" } } ] } Response { \"statusCode\": 200, \"body\": \"21b370eb-6c6f-4f2a-8a84-e3cbfdc00318\" } Response parameters Name Type Description statusCode String 200 body String jobId of the backend processing, you can use returned jobId to get current status of backend workflow, please refer to get_ssl_job","title":"Import create ssl"},{"location":"api-reference-guide/ssl-certificates/import-create-ssl/#import-create-ssl","text":"Important Please do not include more than 100 cname or pems records in one request. Too many requesting items in one request will cause backend ACM service and Cloudfront service throttle our request and cause the backend workflow failure. HTTP request method: POST Request Create one ACM certificate and auto create CloudFront distribution from existing distribution id and version id json { \"acm_op\": \"create\", \"auto_creation\": \"true\", \"cnameList\": [ { \"domainName\": \"YOURDOMAINNAME.COM\", \"sanList\": [ \"YOURDOMAINNAME.COM\", \"YOURDOMAINNAMEALIAS1.COM\" ], \"existing_cf_info\": { \"distribution_id\": \"E195R1W5GIVPF5\", \"config_version_id\": \"1\" } } ] } Create one ACM certificate and auto create CloudFront distribution from existing distribution id json { \"acm_op\": \"create\", \"auto_creation\": \"true\", \"cnameList\": [ { \"domainName\": \"YOURDOMAINNAME.COM\", \"sanList\": [ \"YOURDOMAINNAME.COM\", \"YOURDOMAINNAMEALIAS1.COM\" ], \"existing_cf_info\": { \"distribution_id\": \"E195R1W5GIVPF5\", } } ] } Create two ACM certificates and auto create CloudFront distribution from existing distribution id json { \"acm_op\": \"create\", \"auto_creation\": \"true\", \"cnameList\": [ { \"domainName\": \"YOURDOMAINNAME1.COM\", \"sanList\": [ \"YOURDOMAINNAME1.COM\", \"YOURDOMAINNAME1ALIAS1.COM\", \"YOURDOMAINNAME1ALIAS2.COM\" ], \"existing_cf_info\": { \"distribution_id\": \"E195R1W5GIVPF5\", } }, { \"domainName\": \"YOURDOMAINNAME2.COM\", \"sanList\": [ \"YOURDOMAINNAME2.COM\", \"YOURDOMAINNAME2ALIAS1.COM\", \"YOURDOMAINNAME2ALIAS1.COM\" ], \"existing_cf_info\": { \"distribution_id\": \"E195R1W5GIVPF5\", } } ] } Import one ACM certificate and auto create CloudFront distribution from existing distribution id json { \"acm_op\": \"import\", \"auto_creation\": \"true\", \"cnameList\": [], \"pemList\": [ { \"CertPem\": \"-----BEGIN CERTIFICATE-----\\nXXXXXXXXXXXX\\n-----END CERTIFICATE-----\", \"PrivateKeyPem\": \"-----BEGIN PRIVATE KEY-----\\nXXXXXXXXXXXX\\n-----END PRIVATE KEY-----\", \"ChainPem\": \"-----BEGIN CERTIFICATE-----\\nAAAAAAAAAAA\\n-----END CERTIFICATE-----\\n-----BEGIN CERTIFICATE-----\\nBBBBBBBBBBB\\n-----END CERTIFICATE-----\\n-----BEGIN CERTIFICATE-----\\nCCCCCCCCCCC\\n-----END CERTIFICATE-----\", \"existing_cf_info\": { \"distribution_id\": \"E1DACGTRXKKWCH\" } } ] } Import two ACM certificates and auto create CloudFront distribution from existing distribution id json { \"acm_op\": \"import\", \"auto_creation\": \"true\", \"cnameList\": [], \"pemList\": [ { \"CertPem\": \"-----BEGIN CERTIFICATE-----\\nXXXXXXXXXXXX\\n-----END CERTIFICATE-----\", \"PrivateKeyPem\": \"-----BEGIN PRIVATE KEY-----\\nXXXXXXXXXXXX\\n-----END PRIVATE KEY-----\", \"ChainPem\": \"-----BEGIN CERTIFICATE-----\\nAAAAAAAAAAA\\n-----END CERTIFICATE-----\\n-----BEGIN CERTIFICATE-----\\nBBBBBBBBBBB\\n-----END CERTIFICATE-----\\n-----BEGIN CERTIFICATE-----\\nCCCCCCCCCCC\\n-----END CERTIFICATE-----\", \"existing_cf_info\": { \"distribution_id\": \"E1DACGTRXKKWCH\" } }, { \"CertPem\": \"-----BEGIN CERTIFICATE-----\\nXXXXXXXXXXXX\\n-----END CERTIFICATE-----\", \"PrivateKeyPem\": \"-----BEGIN PRIVATE KEY-----\\nXXXXXXXXXXXX\\n-----END PRIVATE KEY-----\", \"ChainPem\": \"-----BEGIN CERTIFICATE-----\\nAAAAAAAAAAA\\n-----END CERTIFICATE-----\\n-----BEGIN CERTIFICATE-----\\nBBBBBBBBBBB\\n-----END CERTIFICATE-----\\n-----BEGIN CERTIFICATE-----\\nCCCCCCCCCCC\\n-----END CERTIFICATE-----\", \"existing_cf_info\": { \"distribution_id\": \"E1DACGTRXKKWCH\" } } ] } Response { \"statusCode\": 200, \"body\": \"21b370eb-6c6f-4f2a-8a84-e3cbfdc00318\" } Response parameters Name Type Description statusCode String 200 body String jobId of the backend processing, you can use returned jobId to get current status of backend workflow, please refer to get_ssl_job","title":"import-create-ssl"},{"location":"api-reference-guide/ssl-certificates/list-certificates/","text":"cert_list HTTP request method: GET Request /ssl_for_saas/cert_list Response [ { \"CertificateArn\": \"arn:aws:acm:us-east-1:596963228260:certificate/e73c12ee-1ea1-4607-8f38-e1fce284c48e\", \"DomainName\": \"test.omnimyo.store\", \"SubjectAlternativeNames\": \"test.omnimyo.store\", \"Issuer\": \"Amazon\", \"CreatedAt\": \"\\\"2022-07-13 05:24:46.152000+00:00\\\"\", \"IssuedAt\": \"\", \"Status\": \"ISSUED\", \"NotBefore\": \"\\\"2022-07-13 00:00:00+00:00\\\"\", \"NotAfter\": \"\\\"2023-08-12 23:59:59+00:00\\\"\", \"KeyAlgorithm\": \"RSA-2048\" }, { \"CertificateArn\": \"arn:aws:acm:us-east-1:596963228260:certificate/7559c140-a6e0-4c25-8605-c6525561471e\", \"DomainName\": \"web1.ssl-for-saas.demo.solutions.aws.a2z.org.cn\", \"SubjectAlternativeNames\": \"web1.ssl-for-saas.demo.solutions.aws.a2z.org.cn\", \"Issuer\": \"Amazon\", \"CreatedAt\": \"\\\"2022-08-01 09:48:48.246000+00:00\\\"\", \"IssuedAt\": \"\", \"Status\": \"ISSUED\", \"NotBefore\": \"\\\"2022-08-01 00:00:00+00:00\\\"\", \"NotAfter\": \"\\\"2023-08-30 23:59:59+00:00\\\"\", \"KeyAlgorithm\": \"RSA-2048\" }, { \"CertificateArn\": \"arn:aws:acm:us-east-1:596963228260:certificate/4389ceb0-271c-4a39-a59d-3ddf65705b68\", \"DomainName\": \"web2.ssl-for-saas.demo.solutions.aws.a2z.org.cn\", \"SubjectAlternativeNames\": \"web2.ssl-for-saas.demo.solutions.aws.a2z.org.cn\", \"Issuer\": \"Amazon\", \"CreatedAt\": \"\\\"2022-08-01 09:48:53.586000+00:00\\\"\", \"IssuedAt\": \"\", \"Status\": \"ISSUED\", \"NotBefore\": \"\\\"2022-08-01 00:00:00+00:00\\\"\", \"NotAfter\": \"\\\"2023-08-30 23:59:59+00:00\\\"\", \"KeyAlgorithm\": \"RSA-2048\" }, { \"CertificateArn\": \"arn:aws:acm:us-east-1:596963228260:certificate/cf3323cb-feab-4688-bdfa-412de32beaf4\", \"DomainName\": \"web3.ssl-for-saas.demo.solutions.aws.a2z.org.cn\", \"SubjectAlternativeNames\": \"web3.ssl-for-saas.demo.solutions.aws.a2z.org.cn\", \"Issuer\": \"Amazon\", \"CreatedAt\": \"\\\"2022-08-01 09:48:58.895000+00:00\\\"\", \"IssuedAt\": \"\", \"Status\": \"ISSUED\", \"NotBefore\": \"\\\"2022-08-01 00:00:00+00:00\\\"\", \"NotAfter\": \"\\\"2023-08-30 23:59:59+00:00\\\"\", \"KeyAlgorithm\": \"RSA-2048\" } ]","title":"List certificates"},{"location":"api-reference-guide/ssl-certificates/list-certificates/#cert_list","text":"HTTP request method: GET Request /ssl_for_saas/cert_list Response [ { \"CertificateArn\": \"arn:aws:acm:us-east-1:596963228260:certificate/e73c12ee-1ea1-4607-8f38-e1fce284c48e\", \"DomainName\": \"test.omnimyo.store\", \"SubjectAlternativeNames\": \"test.omnimyo.store\", \"Issuer\": \"Amazon\", \"CreatedAt\": \"\\\"2022-07-13 05:24:46.152000+00:00\\\"\", \"IssuedAt\": \"\", \"Status\": \"ISSUED\", \"NotBefore\": \"\\\"2022-07-13 00:00:00+00:00\\\"\", \"NotAfter\": \"\\\"2023-08-12 23:59:59+00:00\\\"\", \"KeyAlgorithm\": \"RSA-2048\" }, { \"CertificateArn\": \"arn:aws:acm:us-east-1:596963228260:certificate/7559c140-a6e0-4c25-8605-c6525561471e\", \"DomainName\": \"web1.ssl-for-saas.demo.solutions.aws.a2z.org.cn\", \"SubjectAlternativeNames\": \"web1.ssl-for-saas.demo.solutions.aws.a2z.org.cn\", \"Issuer\": \"Amazon\", \"CreatedAt\": \"\\\"2022-08-01 09:48:48.246000+00:00\\\"\", \"IssuedAt\": \"\", \"Status\": \"ISSUED\", \"NotBefore\": \"\\\"2022-08-01 00:00:00+00:00\\\"\", \"NotAfter\": \"\\\"2023-08-30 23:59:59+00:00\\\"\", \"KeyAlgorithm\": \"RSA-2048\" }, { \"CertificateArn\": \"arn:aws:acm:us-east-1:596963228260:certificate/4389ceb0-271c-4a39-a59d-3ddf65705b68\", \"DomainName\": \"web2.ssl-for-saas.demo.solutions.aws.a2z.org.cn\", \"SubjectAlternativeNames\": \"web2.ssl-for-saas.demo.solutions.aws.a2z.org.cn\", \"Issuer\": \"Amazon\", \"CreatedAt\": \"\\\"2022-08-01 09:48:53.586000+00:00\\\"\", \"IssuedAt\": \"\", \"Status\": \"ISSUED\", \"NotBefore\": \"\\\"2022-08-01 00:00:00+00:00\\\"\", \"NotAfter\": \"\\\"2023-08-30 23:59:59+00:00\\\"\", \"KeyAlgorithm\": \"RSA-2048\" }, { \"CertificateArn\": \"arn:aws:acm:us-east-1:596963228260:certificate/cf3323cb-feab-4688-bdfa-412de32beaf4\", \"DomainName\": \"web3.ssl-for-saas.demo.solutions.aws.a2z.org.cn\", \"SubjectAlternativeNames\": \"web3.ssl-for-saas.demo.solutions.aws.a2z.org.cn\", \"Issuer\": \"Amazon\", \"CreatedAt\": \"\\\"2022-08-01 09:48:58.895000+00:00\\\"\", \"IssuedAt\": \"\", \"Status\": \"ISSUED\", \"NotBefore\": \"\\\"2022-08-01 00:00:00+00:00\\\"\", \"NotAfter\": \"\\\"2023-08-30 23:59:59+00:00\\\"\", \"KeyAlgorithm\": \"RSA-2048\" } ]","title":"cert_list"},{"location":"api-reference-guide/ssl-certificates/list-cloudfront-arn-with-jobId/","text":"list_cloudfront_arn_with_jobId HTTP request method: GET Request /ssl_for_saas/list_cloudfront_arn_with_jobId?jobId=f48db3b2-90e4-43b2-a46d-bd0e8530bc42 Request body parameters jobId: String Response [ \"arn:aws:cloudfront::596963228260:distribution/E3I7SS3FT9440Q\", \"arn:aws:cloudfront::596963228260:distribution/EHZP3M6MW4FRU\", \"arn:aws:cloudfront::596963228260:distribution/E2OH67LDYUMZTG\" ]","title":"list cloudfront arn with jobId"},{"location":"api-reference-guide/ssl-certificates/list-cloudfront-arn-with-jobId/#list_cloudfront_arn_with_jobid","text":"HTTP request method: GET Request /ssl_for_saas/list_cloudfront_arn_with_jobId?jobId=f48db3b2-90e4-43b2-a46d-bd0e8530bc42 Request body parameters jobId: String Response [ \"arn:aws:cloudfront::596963228260:distribution/E3I7SS3FT9440Q\", \"arn:aws:cloudfront::596963228260:distribution/EHZP3M6MW4FRU\", \"arn:aws:cloudfront::596963228260:distribution/E2OH67LDYUMZTG\" ]","title":"list_cloudfront_arn_with_jobId"},{"location":"api-reference-guide/ssl-certificates/list-ssl_certification-with-jobId/","text":"list_ssl_certification_with_jobId HTTP request method: GET Request /ssl_for_saas/list_ssl_certification_with_jobId?jobId=f98d3afb-4956-4ddc-b227-88c7a1f2384c Request body parameters jobId: String Response [ \"arn:aws:acm:us-east-1:596963228260:certificate/7559c140-a6e0-4c25-8605-c6525561471e\", \"arn:aws:acm:us-east-1:596963228260:certificate/4389ceb0-271c-4a39-a59d-3ddf65705b68\", \"arn:aws:acm:us-east-1:596963228260:certificate/cf3323cb-feab-4688-bdfa-412de32beaf4\" ]","title":"list ssl certification with jobId"},{"location":"api-reference-guide/ssl-certificates/list-ssl_certification-with-jobId/#list_ssl_certification_with_jobid","text":"HTTP request method: GET Request /ssl_for_saas/list_ssl_certification_with_jobId?jobId=f98d3afb-4956-4ddc-b227-88c7a1f2384c Request body parameters jobId: String Response [ \"arn:aws:acm:us-east-1:596963228260:certificate/7559c140-a6e0-4c25-8605-c6525561471e\", \"arn:aws:acm:us-east-1:596963228260:certificate/4389ceb0-271c-4a39-a59d-3ddf65705b68\", \"arn:aws:acm:us-east-1:596963228260:certificate/cf3323cb-feab-4688-bdfa-412de32beaf4\" ]","title":"list_ssl_certification_with_jobId"},{"location":"api-reference-guide/ssl-certificates/list-ssl_jobs/","text":"list_ssl_jobs HTTP request method: GET Request /ssl_for_saas/list_ssl_jobs Response [ { \"distList\": [], \"jobId\": \"21b370eb-6c6f-4f2a-8a84-e3cbfdc00318\", \"creationDate\": \"2022-08-01-01-55-06\", \"cloudfront_distribution_total_number\": \"0\", \"certValidationStageStatus\": \"NOTSTART\", \"cert_total_number\": \"1\", \"certCreateStageStatus\": \"FAILED\", \"jobType\": \"create\", \"job_input\": \"{\\n \\\"acm_op\\\": \\\"create\\\",\\n \\\"auto_creation\\\": \\\"false\\\",\\n \\\"dist_aggregate\\\": \\\"false\\\",\\n \\\"enable_cname_check\\\": \\\"false\\\",\\n \\\"cnameList\\\": [\\n {\\n \\\"domainName\\\": \\\"ccc\\\",\\n \\\"sanList\\\": [\\n \\\"ccc\\\"\\n ],\\n \\\"originsItemsDomainName\\\": \\\"\\\",\\n \\\"existing_cf_info\\\": {\\n \\\"distribution_id\\\": \\\"\\\",\\n \\\"config_version_id\\\": \\\"1\\\"\\n }\\n }\\n ]\\n}\", \"certList\": [], \"cloudfront_distribution_created_number\": \"0\", \"promptInfo\": \"An error occurred (ValidationException) when calling the RequestCertificate operation: 2 validation errors detected: Value '[ccc]' at 'subjectAlternativeNames' failed to satisfy constraint: Member must satisfy constraint: [Member must have length less than or equal to 253, Member must have length greater than or equal to 1, Member must satisfy regular expression pattern: ^(\\\\*\\\\.)?(((?!-)[A-Za-z0-9-]{0,62}[A-Za-z0-9])\\\\.)+((?!-)[A-Za-z0-9-]{1,62}[A-Za-z0-9])$]; Value 'ccc' at 'domainName' failed to satisfy constraint: Member must satisfy regular expression pattern: ^(\\\\*\\\\.)?(((?!-)[A-Za-z0-9-]{0,62}[A-Za-z0-9])\\\\.)+((?!-)[A-Za-z0-9-]{1,62}[A-Za-z0-9])$\", \"cert_completed_number\": \"0\", \"distStageStatus\": \"NONEED\" }, { \"distList\": [], \"jobId\": \"f48db3b2-90e4-43b2-a46d-bd0e8530bc42\", \"creationDate\": \"2022-08-01-06-44-44\", \"cloudfront_distribution_total_number\": \"1\", \"certValidationStageStatus\": \"SUCCESS\", \"cert_total_number\": \"1\", \"certCreateStageStatus\": \"SUCCESS\", \"jobType\": \"create\", \"job_input\": \"{\\n \\\"acm_op\\\": \\\"create\\\",\\n \\\"auto_creation\\\": \\\"true\\\",\\n \\\"dist_aggregate\\\": \\\"false\\\",\\n \\\"enable_cname_check\\\": \\\"false\\\",\\n \\\"cnameList\\\": [\\n {\\n \\\"domainName\\\": \\\"web1.ssl-for-saas.demo.solutions.aws.a2z.org.cn\\\",\\n \\\"sanList\\\": [\\n \\\"web1.ssl-for-saas.demo.solutions.aws.a2z.org.cn\\\"\\n ],\\n \\\"originsItemsDomainName\\\": \\\"\\\",\\n \\\"existing_cf_info\\\": {\\n \\\"distribution_id\\\": \\\"E30J9PCOB6KHJV\\\",\\n \\\"config_version_id\\\": \\\"1\\\"\\n }\\n }\\n ],\\n \\\"aws_request_id\\\": \\\"f48db3b2-90e4-43b2-a46d-bd0e8530bc42\\\"\\n}\", \"certList\": [], \"cloudfront_distribution_created_number\": \"1\", \"promptInfo\": \"\", \"cert_completed_number\": \"1\", \"distStageStatus\": \"SUCCESS\" } ]","title":"List ssl jobs"},{"location":"api-reference-guide/ssl-certificates/list-ssl_jobs/#list_ssl_jobs","text":"HTTP request method: GET Request /ssl_for_saas/list_ssl_jobs Response [ { \"distList\": [], \"jobId\": \"21b370eb-6c6f-4f2a-8a84-e3cbfdc00318\", \"creationDate\": \"2022-08-01-01-55-06\", \"cloudfront_distribution_total_number\": \"0\", \"certValidationStageStatus\": \"NOTSTART\", \"cert_total_number\": \"1\", \"certCreateStageStatus\": \"FAILED\", \"jobType\": \"create\", \"job_input\": \"{\\n \\\"acm_op\\\": \\\"create\\\",\\n \\\"auto_creation\\\": \\\"false\\\",\\n \\\"dist_aggregate\\\": \\\"false\\\",\\n \\\"enable_cname_check\\\": \\\"false\\\",\\n \\\"cnameList\\\": [\\n {\\n \\\"domainName\\\": \\\"ccc\\\",\\n \\\"sanList\\\": [\\n \\\"ccc\\\"\\n ],\\n \\\"originsItemsDomainName\\\": \\\"\\\",\\n \\\"existing_cf_info\\\": {\\n \\\"distribution_id\\\": \\\"\\\",\\n \\\"config_version_id\\\": \\\"1\\\"\\n }\\n }\\n ]\\n}\", \"certList\": [], \"cloudfront_distribution_created_number\": \"0\", \"promptInfo\": \"An error occurred (ValidationException) when calling the RequestCertificate operation: 2 validation errors detected: Value '[ccc]' at 'subjectAlternativeNames' failed to satisfy constraint: Member must satisfy constraint: [Member must have length less than or equal to 253, Member must have length greater than or equal to 1, Member must satisfy regular expression pattern: ^(\\\\*\\\\.)?(((?!-)[A-Za-z0-9-]{0,62}[A-Za-z0-9])\\\\.)+((?!-)[A-Za-z0-9-]{1,62}[A-Za-z0-9])$]; Value 'ccc' at 'domainName' failed to satisfy constraint: Member must satisfy regular expression pattern: ^(\\\\*\\\\.)?(((?!-)[A-Za-z0-9-]{0,62}[A-Za-z0-9])\\\\.)+((?!-)[A-Za-z0-9-]{1,62}[A-Za-z0-9])$\", \"cert_completed_number\": \"0\", \"distStageStatus\": \"NONEED\" }, { \"distList\": [], \"jobId\": \"f48db3b2-90e4-43b2-a46d-bd0e8530bc42\", \"creationDate\": \"2022-08-01-06-44-44\", \"cloudfront_distribution_total_number\": \"1\", \"certValidationStageStatus\": \"SUCCESS\", \"cert_total_number\": \"1\", \"certCreateStageStatus\": \"SUCCESS\", \"jobType\": \"create\", \"job_input\": \"{\\n \\\"acm_op\\\": \\\"create\\\",\\n \\\"auto_creation\\\": \\\"true\\\",\\n \\\"dist_aggregate\\\": \\\"false\\\",\\n \\\"enable_cname_check\\\": \\\"false\\\",\\n \\\"cnameList\\\": [\\n {\\n \\\"domainName\\\": \\\"web1.ssl-for-saas.demo.solutions.aws.a2z.org.cn\\\",\\n \\\"sanList\\\": [\\n \\\"web1.ssl-for-saas.demo.solutions.aws.a2z.org.cn\\\"\\n ],\\n \\\"originsItemsDomainName\\\": \\\"\\\",\\n \\\"existing_cf_info\\\": {\\n \\\"distribution_id\\\": \\\"E30J9PCOB6KHJV\\\",\\n \\\"config_version_id\\\": \\\"1\\\"\\n }\\n }\\n ],\\n \\\"aws_request_id\\\": \\\"f48db3b2-90e4-43b2-a46d-bd0e8530bc42\\\"\\n}\", \"certList\": [], \"cloudfront_distribution_created_number\": \"1\", \"promptInfo\": \"\", \"cert_completed_number\": \"1\", \"distStageStatus\": \"SUCCESS\" } ]","title":"list_ssl_jobs"},{"location":"distribution-management/overview/","text":"Distribution Management The solution helps you manage CloudFront distribution configuration and SSL certificates. Snapshot SSL certificates","title":"Overview"},{"location":"distribution-management/overview/#distribution-management","text":"The solution helps you manage CloudFront distribution configuration and SSL certificates. Snapshot SSL certificates","title":"Distribution Management"},{"location":"distribution-management/snapshot/apply-snapshot/","text":"You can apply a snapshot to other CloudFront distributions. Important When you apply the snapshot, the target distribution configuration will be replaced. Log in to the web console. In the left sidebar, under Configuration , select Snapshot . Click a distribution (you can find it by CNAMEs) that you want to view its snapshots. From the snapshot list, select a snapshot. Choose Actions on the top right, and then choose Apply to other distributions . In the pop-up window, select one or more existing CloudFront distribution that you want to apply the configuration of this snapshot. Enter Confirm in the text box to confirm this action. Choose Apply .","title":"Apply a snapshot to other CloudFront distributions"},{"location":"distribution-management/snapshot/compare-snapshot/","text":"You can compare two snapshots to find their differences. Log in to the web console. In the left sidebar, under Configuration , select Snapshot . Click a distribution (you can find it by CNAMEs) that you want to compare its snapshots. From the snapshot list, select two snapshots that you want to compare. Choose Actions on the top right, and then choose Compare . You will be navigated to a different page, where you can view the difference between the two CloudFront distributions.","title":"Compare two snapshots"},{"location":"distribution-management/snapshot/delete-snapshot/","text":"If you do not need a snapshot any more, you can delete it. Log in to the web console. In the left sidebar, under Configuration , select Snapshot . Click a distribution (you can find it by CNAMEs) in which you want to delete a snapshot. From the snapshot list, select the snapshot you want to delete. Choose Actions on the top right, and then choose Delete Snapshot .","title":"Delete a snapshot"},{"location":"distribution-management/snapshot/overview/","text":"Snapshot A configuration of CloudFront distribution could be very complex, and you may want to save a specific configuration and apply it to current or other distributions in your AWS account. This solution allows you to save configuration as \u201csnapshot\u201d so that you can reuse it at any time. Why need to save Snapshot Cloudfront configuration is complex, when user spent some time updating the cloudfront configuration, he/she don't want configuration been accidentally updated to wrong configuration. So we provide this Snapshot feature to let user create a snapshot so in the future user can compare the current configuration with snapshot or compare different between any two snapshots. How does it work? When you create a snapshot, the solution automatically exports the current distribution configuration file in S3 bucket. A DynamoDB table is used to store the mapping of the config file and the snapshot names. How to work with snapshots? You can perform the following operations on snapshots on web console: Compare snapshot Apply snapshot Publish snapshot Delete snapshot You can also perform the following operations on snapshots via API: create_snapshot delete_snapshot list_snapshots diff_cloudfront_snapshot get_snapshot_link apply_snapshot config_snapshot_tag_update What does Snapshot saved? Snapshot saves Cloudfront configuration as a configuration file, you can get the same cloudfront configuration through CLI: get-distribution-config . Our solution will save the configuration file in S3 and url in DynamoDB. You can use list_snapshots api to list all snapshots of one distribution. How long will Snapshot been saved? The snapshot will be saved in S3 bucket and will not automatically been deleted. The snapshot can only be deleted in Web Console or through delete_snapshot api . How much will Snapshot cost? Cloudfront configuration file is in JSON format and is around 3KB. Refer to Cost for more details.","title":"Overview"},{"location":"distribution-management/snapshot/overview/#snapshot","text":"A configuration of CloudFront distribution could be very complex, and you may want to save a specific configuration and apply it to current or other distributions in your AWS account. This solution allows you to save configuration as \u201csnapshot\u201d so that you can reuse it at any time.","title":"Snapshot"},{"location":"distribution-management/snapshot/overview/#why-need-to-save-snapshot","text":"Cloudfront configuration is complex, when user spent some time updating the cloudfront configuration, he/she don't want configuration been accidentally updated to wrong configuration. So we provide this Snapshot feature to let user create a snapshot so in the future user can compare the current configuration with snapshot or compare different between any two snapshots.","title":"Why need to save Snapshot"},{"location":"distribution-management/snapshot/overview/#how-does-it-work","text":"When you create a snapshot, the solution automatically exports the current distribution configuration file in S3 bucket. A DynamoDB table is used to store the mapping of the config file and the snapshot names.","title":"How does it work?"},{"location":"distribution-management/snapshot/overview/#how-to-work-with-snapshots","text":"You can perform the following operations on snapshots on web console: Compare snapshot Apply snapshot Publish snapshot Delete snapshot You can also perform the following operations on snapshots via API: create_snapshot delete_snapshot list_snapshots diff_cloudfront_snapshot get_snapshot_link apply_snapshot config_snapshot_tag_update","title":"How to work with snapshots?"},{"location":"distribution-management/snapshot/overview/#what-does-snapshot-saved","text":"Snapshot saves Cloudfront configuration as a configuration file, you can get the same cloudfront configuration through CLI: get-distribution-config . Our solution will save the configuration file in S3 and url in DynamoDB. You can use list_snapshots api to list all snapshots of one distribution.","title":"What does Snapshot saved?"},{"location":"distribution-management/snapshot/overview/#how-long-will-snapshot-been-saved","text":"The snapshot will be saved in S3 bucket and will not automatically been deleted. The snapshot can only be deleted in Web Console or through delete_snapshot api .","title":"How long will Snapshot been saved?"},{"location":"distribution-management/snapshot/overview/#how-much-will-snapshot-cost","text":"Cloudfront configuration file is in JSON format and is around 3KB. Refer to Cost for more details.","title":"How much will Snapshot cost?"},{"location":"distribution-management/snapshot/publish-snapshot/","text":"Before using a snapshot, you must create a snapshot. Log in to the web console. In the left sidebar, under Configuration , select Snapshot . Click a distribution (you can find it by CNAMEs) that you want to take a snapshot to enter its page. Choose Create Snapshot . In the window that pops up, enter a Snapshot Name (a unique key used to identify this snapshot), and also Description. Choose Create .","title":"Publish a snapshot"},{"location":"distribution-management/ssl-certificates/add-record-for-cname/","text":"You can add the CloudFront record for CNAME with your DNS Provider. Add CName to point to CloudFront distribution in Route53 Once CloudFront distribution was created, the domain owner need to manually or use api to add the CloudFront distribution as a CNAME for the website domain, so that when someone access the website, the DNS provider will redirect the access to CloudFront distribution. Please refer to this AWS official documentation . Add CName to point to CloudFront distribution in GoDaddy Log in to GoDaddy . In the Domains* menu , select All Domains . Choose the domain that needs to update CNAME record. Add a new CNAME record, enter the Name with the CNAME and the Data with the corresponding CloudFront distribution. You should be able to retrieve both values in the SNS message sent by solution.","title":"Adding CloudFront record for CNAME with your DNS Provider"},{"location":"distribution-management/ssl-certificates/add-record-for-cname/#add-cname-to-point-to-cloudfront-distribution-in-route53","text":"Once CloudFront distribution was created, the domain owner need to manually or use api to add the CloudFront distribution as a CNAME for the website domain, so that when someone access the website, the DNS provider will redirect the access to CloudFront distribution. Please refer to this AWS official documentation .","title":"Add CName to point to CloudFront distribution in Route53"},{"location":"distribution-management/ssl-certificates/add-record-for-cname/#add-cname-to-point-to-cloudfront-distribution-in-godaddy","text":"Log in to GoDaddy . In the Domains* menu , select All Domains . Choose the domain that needs to update CNAME record. Add a new CNAME record, enter the Name with the CNAME and the Data with the corresponding CloudFront distribution. You should be able to retrieve both values in the SNS message sent by solution.","title":"Add CName to point to CloudFront distribution in GoDaddy"},{"location":"distribution-management/ssl-certificates/clean-up-resources/","text":"If a create job or an import job failed, you may want to clean up the SSL Certificates and CloudFront Distributions created by the job. Clean up certificates in AWS Certificate Manager On the Job Status page, choose View SSL certificates created in this job . You will be redirected to certificate list, where shows all the certificates created in this job. Click a specific certificate. You will be redirected to ACM web console. Delete the certificate. For all other certificates found in Step 1, delete them in ACM. Repeat Step 1 to check whether all certificates in this job were cleaned up. Clean up distributions in CloudFront On the Job Status page, choose View distributions created in this job . You will be redirected to distribution list, where shows all the distributions created in this job. Click a specific distribution. Delete the distribution. For all other distributions found in Step 1, delete them in CloudFront console. Repeat Step 1 to check whether all distributions in this job were cleaned up.","title":"Clean up resources"},{"location":"distribution-management/ssl-certificates/clean-up-resources/#clean-up-certificates-in-aws-certificate-manager","text":"On the Job Status page, choose View SSL certificates created in this job . You will be redirected to certificate list, where shows all the certificates created in this job. Click a specific certificate. You will be redirected to ACM web console. Delete the certificate. For all other certificates found in Step 1, delete them in ACM. Repeat Step 1 to check whether all certificates in this job were cleaned up.","title":"Clean up certificates in AWS Certificate Manager"},{"location":"distribution-management/ssl-certificates/clean-up-resources/#clean-up-distributions-in-cloudfront","text":"On the Job Status page, choose View distributions created in this job . You will be redirected to distribution list, where shows all the distributions created in this job. Click a specific distribution. Delete the distribution. For all other distributions found in Step 1, delete them in CloudFront console. Repeat Step 1 to check whether all distributions in this job were cleaned up.","title":"Clean up distributions in CloudFront"},{"location":"distribution-management/ssl-certificates/create-new-certificates/","text":"The solution will create one or multiple certificates in ACM and create the associated distributions in CloudFront. How does it work When you start a Create Certificates Job, the solution starts a workflow in AWS Step Functions that does the following: Create certificates in ACM: The solution will automatically create all ACM based on input. After all SSL Certificates were created, the solution will automatically sent SNS message to the designated email address or HTTP endpoint (depending on subscription). After this step, the domain owners are expected to complete DNS validation process. For more information, see DNS validation process with your DNS Provider . Check certificates status in ACM: The solution checks the progress of DNS validation status every 5 minutes. The DNS validation is a manual process, also known as Domain Control Validation. Domain owner needs to manually add a CNAME record for your domain name on the website of your DNS providers. ACM will check the DNS validation status every few minutes. Once done, ACM will issue certificates. Create new CloudFront distributions: Once all certificates were issued by ACM, the solution will automatically create CloudFront distributions. After all distributions were created, the solution will send an SNS message to the designated email address or HTTP endpoint. After this step, the domain owners are expected to add new CloudFront distribution to map to CNAME. For more information, see Adding CloudFront record for CNAME with your DNS Provider . Schedule a job for creating new certificates Log in to the web console. In the left sidebar, under Configuration , select SSL Certification . Choose Request New Certificate . In the page that opens, click Get Started . Enter a group of domain name list for a certificate. Click Add domain names for another certificate if you want to create another certificate. Choose Automatically create distributions , and select a snapshot of a distribution that you want to copy the config from. Click Add new tag to add a Tag for the resource such as certificates, CloudFront Distributions that will be created. Click Start job . Verify the generated input parameters and if everything is fine then enter \"Confirm\" in input box and click \"Apply\" button. View create certificate job status You can view job status on the web console or using API calls. Once the create job started, you will be redirected to a page where you can view the status of the job. For create certificate job, there are three steps in AWS Step functions workflow. After all steps are completed, the job will finish with success. If one of the steps failed, the job will fail. Step1 will be completed once all certificates were created in ACM. It usually takes less than a minute. Step2 will be completed once ACM had issued all expected certificates. ACM only issues the certificates if all DNS validation were done.(This step will be blocking until user do the DCV validation on all the domain names on related name servers, please refer to this link ) Step3 will be completed once all expected distributions were created in CloudFront. After Step1, the domain owners are expected to complete DNS validation process. See more details in DNS validation process with your DNS Provider . After Step3, the domain owners are expected to add new CloudFront distribution to map to CNAME. See more details in Adding CloudFront record for CNAME with your DNS Provider . If the job failed, refer to Clean up resources to clean up the created ACM and CloudFront distributions if needed.","title":"Create new certificates"},{"location":"distribution-management/ssl-certificates/create-new-certificates/#how-does-it-work","text":"When you start a Create Certificates Job, the solution starts a workflow in AWS Step Functions that does the following: Create certificates in ACM: The solution will automatically create all ACM based on input. After all SSL Certificates were created, the solution will automatically sent SNS message to the designated email address or HTTP endpoint (depending on subscription). After this step, the domain owners are expected to complete DNS validation process. For more information, see DNS validation process with your DNS Provider . Check certificates status in ACM: The solution checks the progress of DNS validation status every 5 minutes. The DNS validation is a manual process, also known as Domain Control Validation. Domain owner needs to manually add a CNAME record for your domain name on the website of your DNS providers. ACM will check the DNS validation status every few minutes. Once done, ACM will issue certificates. Create new CloudFront distributions: Once all certificates were issued by ACM, the solution will automatically create CloudFront distributions. After all distributions were created, the solution will send an SNS message to the designated email address or HTTP endpoint. After this step, the domain owners are expected to add new CloudFront distribution to map to CNAME. For more information, see Adding CloudFront record for CNAME with your DNS Provider .","title":"How does it work"},{"location":"distribution-management/ssl-certificates/create-new-certificates/#schedule-a-job-for-creating-new-certificates","text":"Log in to the web console. In the left sidebar, under Configuration , select SSL Certification . Choose Request New Certificate . In the page that opens, click Get Started . Enter a group of domain name list for a certificate. Click Add domain names for another certificate if you want to create another certificate. Choose Automatically create distributions , and select a snapshot of a distribution that you want to copy the config from. Click Add new tag to add a Tag for the resource such as certificates, CloudFront Distributions that will be created. Click Start job . Verify the generated input parameters and if everything is fine then enter \"Confirm\" in input box and click \"Apply\" button.","title":"Schedule a job for creating new certificates"},{"location":"distribution-management/ssl-certificates/create-new-certificates/#view-create-certificate-job-status","text":"You can view job status on the web console or using API calls. Once the create job started, you will be redirected to a page where you can view the status of the job. For create certificate job, there are three steps in AWS Step functions workflow. After all steps are completed, the job will finish with success. If one of the steps failed, the job will fail. Step1 will be completed once all certificates were created in ACM. It usually takes less than a minute. Step2 will be completed once ACM had issued all expected certificates. ACM only issues the certificates if all DNS validation were done.(This step will be blocking until user do the DCV validation on all the domain names on related name servers, please refer to this link ) Step3 will be completed once all expected distributions were created in CloudFront. After Step1, the domain owners are expected to complete DNS validation process. See more details in DNS validation process with your DNS Provider . After Step3, the domain owners are expected to add new CloudFront distribution to map to CNAME. See more details in Adding CloudFront record for CNAME with your DNS Provider . If the job failed, refer to Clean up resources to clean up the created ACM and CloudFront distributions if needed.","title":"View create certificate job status"},{"location":"distribution-management/ssl-certificates/dns-validation-process/","text":"When you create certificates, you need to complete DNS validation process. This process requires you to add/update CNAME record in DNS provider, such as Route 53 and GoDaddy. Email An email will be sent with information needed for DNS validation. The following is an example SNS notification: CNAME value need to add into DNS hostzone to finish DCV: [{'Name': '_1317a5f539939083b712d51b6b1676e5.web1.ssl-for-saas.demo.solutions.aws.a2z.org.cn.', 'Type': 'CNAME', 'Value': '_de026e5dc988d65312fe83616ef24249.hnyhpvdqhv.acm-validations.aws.'}] Sample Script for Route53 (Python): https://gist.github.com/yike5460/67c42ff4a0405c05e59737bd425a4806 Sample Script for Godaddy (Python): https://gist.github.com/alvindaiyan/262721fb3bc3284e3635ac5f9e860e93 If you do not know where the email was sent to, you can check it in CloudFormation stack that was deployed when you launch the solution. If you want to update the email, you need to update the email parameter in the CloudFormation stack. Adding CNAMEs record for DCV validation in Route53 Adding Through AWS Route53 Console Sign in to the AWS Management Console and access the Route 53 console . In the navigation pane, choose Hosted zones . If you already have a hosted zone for your domain, skip to step 5. If not, create a hosted zone first. To route internet traffic to your resources, such as Amazon S3 buckets or Amazon EC2 instances, see Creating a public hosted zone . To route traffic in your VPC, see Creating a private hosted zone . On the Hosted zones page, choose the name of the hosted zone that you want to create records in. Choose Create record . Enter the name and value in Create record form with type CNAME. Adding Through Provided Script Prepare python environment based on your os: install python . Download the file by this url and save to file route53Cert.py . Install python dependencies, you can follow this tutorial to setup your environment. Find out the hosted zone ID from the aws console under Route53/YOUR_DOMAIN_NAME/Hosted zone details tab. Open the file and update the data based on your email, for example: ```python import boto3 route53 = boto3.client('route53') def add_cname_record(cnameName, cnameValue, hostedZoneId): response = route53.change_resource_record_sets( ChangeBatch={ 'Changes': [ { 'Action': 'CREATE', 'ResourceRecordSet': { 'Name': cnameName, 'ResourceRecords': [ { 'Value': cnameValue, }, ], 'SetIdentifier': 'SaaS For SSL', 'TTL': 300, 'Type': 'CNAME', 'Weight': 100, }, } ], 'Comment': 'add cname record for certificate', }, HostedZoneId=hostedZoneId, ) if name == ' main ': # paste your data as the cnameList value cnameList = [{'Name': '_1317a5f539939083b712d51b6b1676e5.web1.ssl-for-saas.demo.solutions.aws.a2z.org.cn.', 'Type': 'CNAME', 'Value': '_de026e5dc988d65312fe83616ef24249.hnyhpvdqhv.acm-validations.aws.'}] for i, val in enumerate(cnameList): # change your host zone id add_cname_record(val['Name'], val['Value'], ' ') `` 6. Run your script by python route53Cert.py`. it will be success add record to your domain if there is no error output. Adding CNAMEs record for DCV validation in GoDaddy Adding Through GoDaddy Console Log in to GoDaddy . In the Domains menu, select All Domains *. Choose the domain that needs to update CNAME record. Add a new CNAME record, enter the Name with the CNAME and the Data with the corresponding CloudFront distribution. You should be able to retrieve both values in the SNS message sent by solution. Adding Through Provided Script Prepare python environment based on your os: install python . Download the file by this url and save to file goDaddyCert.py . Install python dependencies by following this tutorial . Download script and save as goDaddyCert.py . Find out goDaddy api Key and Secret from the goDaddy Console . Modify the godaddyCert.py with your api key, secret and the cname data: #!/usr/bin/env python from godaddypy import Client, Account # Remember to set your api key and secret userAccount = Account(api_key='your_api_key', api_secret='your_api_secret') userClient = Client(userAccount) # E.g.: to update your_record.yourdomain.com set domain and record to: domain = 'your_domain' def add_cname_record(cnameName, cnameValue, domain): updateResult = userClient.add_record(domain=domain, record={'data': cnameValue, 'name':cnameName,'ttl':3600, 'type':'CNAME'}) print(str(updateResult)) if __name__ == '__main__': # paste your data as the cnameList value cnameList = [{'Name': '_1317a5f539939083b712d51b6b1676e5.web1.ssl-for-saas.demo.solutions.aws.a2z.org.cn.', 'Type': 'CNAME', 'Value': '_de026e5dc988d65312fe83616ef24249.hnyhpvdqhv.acm-validations.aws.'}] for i, val in enumerate(cnameList): add_cname_record(val['Name'], val['Value'], domain) Run the script with 'python goDaddyCert.py'. If not error message displayed, then your script has been successfully executed.","title":"DNS validation process with your DNS Provider"},{"location":"distribution-management/ssl-certificates/dns-validation-process/#email","text":"An email will be sent with information needed for DNS validation. The following is an example SNS notification: CNAME value need to add into DNS hostzone to finish DCV: [{'Name': '_1317a5f539939083b712d51b6b1676e5.web1.ssl-for-saas.demo.solutions.aws.a2z.org.cn.', 'Type': 'CNAME', 'Value': '_de026e5dc988d65312fe83616ef24249.hnyhpvdqhv.acm-validations.aws.'}] Sample Script for Route53 (Python): https://gist.github.com/yike5460/67c42ff4a0405c05e59737bd425a4806 Sample Script for Godaddy (Python): https://gist.github.com/alvindaiyan/262721fb3bc3284e3635ac5f9e860e93 If you do not know where the email was sent to, you can check it in CloudFormation stack that was deployed when you launch the solution. If you want to update the email, you need to update the email parameter in the CloudFormation stack.","title":"Email"},{"location":"distribution-management/ssl-certificates/dns-validation-process/#adding-cnames-record-for-dcv-validation-in-route53","text":"","title":"Adding CNAMEs record for DCV validation in Route53"},{"location":"distribution-management/ssl-certificates/dns-validation-process/#adding-through-aws-route53-console","text":"Sign in to the AWS Management Console and access the Route 53 console . In the navigation pane, choose Hosted zones . If you already have a hosted zone for your domain, skip to step 5. If not, create a hosted zone first. To route internet traffic to your resources, such as Amazon S3 buckets or Amazon EC2 instances, see Creating a public hosted zone . To route traffic in your VPC, see Creating a private hosted zone . On the Hosted zones page, choose the name of the hosted zone that you want to create records in. Choose Create record . Enter the name and value in Create record form with type CNAME.","title":"Adding Through AWS Route53 Console"},{"location":"distribution-management/ssl-certificates/dns-validation-process/#adding-through-provided-script","text":"Prepare python environment based on your os: install python . Download the file by this url and save to file route53Cert.py . Install python dependencies, you can follow this tutorial to setup your environment. Find out the hosted zone ID from the aws console under Route53/YOUR_DOMAIN_NAME/Hosted zone details tab. Open the file and update the data based on your email, for example: ```python import boto3 route53 = boto3.client('route53') def add_cname_record(cnameName, cnameValue, hostedZoneId): response = route53.change_resource_record_sets( ChangeBatch={ 'Changes': [ { 'Action': 'CREATE', 'ResourceRecordSet': { 'Name': cnameName, 'ResourceRecords': [ { 'Value': cnameValue, }, ], 'SetIdentifier': 'SaaS For SSL', 'TTL': 300, 'Type': 'CNAME', 'Weight': 100, }, } ], 'Comment': 'add cname record for certificate', }, HostedZoneId=hostedZoneId, ) if name == ' main ': # paste your data as the cnameList value cnameList = [{'Name': '_1317a5f539939083b712d51b6b1676e5.web1.ssl-for-saas.demo.solutions.aws.a2z.org.cn.', 'Type': 'CNAME', 'Value': '_de026e5dc988d65312fe83616ef24249.hnyhpvdqhv.acm-validations.aws.'}] for i, val in enumerate(cnameList): # change your host zone id add_cname_record(val['Name'], val['Value'], ' ') `` 6. Run your script by python route53Cert.py`. it will be success add record to your domain if there is no error output.","title":"Adding Through Provided Script"},{"location":"distribution-management/ssl-certificates/dns-validation-process/#adding-cnames-record-for-dcv-validation-in-godaddy","text":"","title":"Adding CNAMEs record for DCV validation in GoDaddy"},{"location":"distribution-management/ssl-certificates/dns-validation-process/#adding-through-godaddy-console","text":"Log in to GoDaddy . In the Domains menu, select All Domains *. Choose the domain that needs to update CNAME record. Add a new CNAME record, enter the Name with the CNAME and the Data with the corresponding CloudFront distribution. You should be able to retrieve both values in the SNS message sent by solution.","title":"Adding Through GoDaddy Console"},{"location":"distribution-management/ssl-certificates/dns-validation-process/#adding-through-provided-script_1","text":"Prepare python environment based on your os: install python . Download the file by this url and save to file goDaddyCert.py . Install python dependencies by following this tutorial . Download script and save as goDaddyCert.py . Find out goDaddy api Key and Secret from the goDaddy Console . Modify the godaddyCert.py with your api key, secret and the cname data: #!/usr/bin/env python from godaddypy import Client, Account # Remember to set your api key and secret userAccount = Account(api_key='your_api_key', api_secret='your_api_secret') userClient = Client(userAccount) # E.g.: to update your_record.yourdomain.com set domain and record to: domain = 'your_domain' def add_cname_record(cnameName, cnameValue, domain): updateResult = userClient.add_record(domain=domain, record={'data': cnameValue, 'name':cnameName,'ttl':3600, 'type':'CNAME'}) print(str(updateResult)) if __name__ == '__main__': # paste your data as the cnameList value cnameList = [{'Name': '_1317a5f539939083b712d51b6b1676e5.web1.ssl-for-saas.demo.solutions.aws.a2z.org.cn.', 'Type': 'CNAME', 'Value': '_de026e5dc988d65312fe83616ef24249.hnyhpvdqhv.acm-validations.aws.'}] for i, val in enumerate(cnameList): add_cname_record(val['Name'], val['Value'], domain) Run the script with 'python goDaddyCert.py'. If not error message displayed, then your script has been successfully executed.","title":"Adding Through Provided Script"},{"location":"distribution-management/ssl-certificates/import-existing-certificates/","text":"The solution will automatically import one or multiple your existing issued certificates in ACM and create associated distributions in CloudFront. How does it work When you starts an Import Certificate Job, the solution starts a workflow in AWS Step Functions that does the following: Import certificates in ACM: The solution will automatically import certificate records in ACM. Create new CloudFront distributions: The solution will automatically create CloudFront distributions. After all distributions were created, the solution will send a SNS message to the designated email address or HTTP endpoint. Schedule a job for importing existing certificates Important Currently, the solution only supports importing one certificate in a job on the Web UI. But user can use api to import multiple certificates through our api. Please refer to the api documentation. Log in to the web console. In the left sidebar, under Configuration , select SSL Certification . Choose Import Existing Certificates . Choose Import One Certificate . Enter Certificate name, Certificate body, Certificate Private Body, and Certificate chain. Click Add new tag to add a Tag for the resource (certificate, CloudFront Distributions) that will be created. Click Start job . Verify the generated input parameters and if everything is fine then enter \"Confirm\" in input box and click \"Apply\" button. View import certificate job status Once the import job started, you will be redirected to a page where you can view the status of the job. For import certificate job, there are two steps in AWS Step Function workflow. After all steps are completed, the job will finish with success. If one of the steps failed, the job will fail. Step1 will be completed once all certificates were created in ACM. It usually takes less than a minute. Step2 will be completed once all expected distributions were created in CloudFront. After Step2, the domain owners are expected to add new CloudFront distribution to map to CNAME. For more information, see Adding CloudFront record for CNAME with your DNS Provider . If the job failed, refer to Clean up resources to clean up the created ACM and CloudFront distributions if needed.","title":"Import existing certificates"},{"location":"distribution-management/ssl-certificates/import-existing-certificates/#how-does-it-work","text":"When you starts an Import Certificate Job, the solution starts a workflow in AWS Step Functions that does the following: Import certificates in ACM: The solution will automatically import certificate records in ACM. Create new CloudFront distributions: The solution will automatically create CloudFront distributions. After all distributions were created, the solution will send a SNS message to the designated email address or HTTP endpoint.","title":"How does it work"},{"location":"distribution-management/ssl-certificates/import-existing-certificates/#schedule-a-job-for-importing-existing-certificates","text":"Important Currently, the solution only supports importing one certificate in a job on the Web UI. But user can use api to import multiple certificates through our api. Please refer to the api documentation. Log in to the web console. In the left sidebar, under Configuration , select SSL Certification . Choose Import Existing Certificates . Choose Import One Certificate . Enter Certificate name, Certificate body, Certificate Private Body, and Certificate chain. Click Add new tag to add a Tag for the resource (certificate, CloudFront Distributions) that will be created. Click Start job . Verify the generated input parameters and if everything is fine then enter \"Confirm\" in input box and click \"Apply\" button.","title":"Schedule a job for importing existing certificates"},{"location":"distribution-management/ssl-certificates/import-existing-certificates/#view-import-certificate-job-status","text":"Once the import job started, you will be redirected to a page where you can view the status of the job. For import certificate job, there are two steps in AWS Step Function workflow. After all steps are completed, the job will finish with success. If one of the steps failed, the job will fail. Step1 will be completed once all certificates were created in ACM. It usually takes less than a minute. Step2 will be completed once all expected distributions were created in CloudFront. After Step2, the domain owners are expected to add new CloudFront distribution to map to CNAME. For more information, see Adding CloudFront record for CNAME with your DNS Provider . If the job failed, refer to Clean up resources to clean up the created ACM and CloudFront distributions if needed.","title":"View import certificate job status"},{"location":"distribution-management/ssl-certificates/list-certificates/","text":"On the web console, you can search for the SSL certificates by CNAMEs. In the backend of the solution, it calls the ACM API to list all current certificates you have in this AWS account. Important One CNAME could be mapped to multiple SSL Certificates. However, when creating CloudFront distributions, you cannot have two distributions map to one CNAME (the alternative domain name). To list SSL certificates on the web console, do the following: Log in to the web console. In the left sidebar, under Configuration , select SSL Certification . View the listed SSL certificates. You can also get the SSL Certificate List via APIs. For more information, see API Reference Guide .","title":"List SSL certificates"},{"location":"distribution-management/ssl-certificates/overview/","text":"SSL Certificates You can use this solution to automatically create or import SSL Certificates and associate them to new CloudFront distributions. The solution provides two kinds of jobs: Create Certificates Job and Import Certificate Job. You can use then on web console or via API calls. This chapter covers the following topics: Create new certificates Import existing certificates List SSL certificates DNS validation process with your DNS Provider Adding CloudFront record for CNAME with your DNS Provider Clean up resources Prerequisites Before you create or import certificates, make sure to meet the Prerequisites listed by ACM.","title":"Overview"},{"location":"distribution-management/ssl-certificates/overview/#ssl-certificates","text":"You can use this solution to automatically create or import SSL Certificates and associate them to new CloudFront distributions. The solution provides two kinds of jobs: Create Certificates Job and Import Certificate Job. You can use then on web console or via API calls. This chapter covers the following topics: Create new certificates Import existing certificates List SSL certificates DNS validation process with your DNS Provider Adding CloudFront record for CNAME with your DNS Provider Clean up resources","title":"SSL Certificates"},{"location":"distribution-management/ssl-certificates/overview/#prerequisites","text":"Before you create or import certificates, make sure to meet the Prerequisites listed by ACM.","title":"Prerequisites"},{"location":"extension-repository/more-extension-in-sar/","text":"As for Lambda@Edge functions, you can also find and configure them by searching aws-cloudfront-extensions in the Amazon SAR. Please refer to deployment for more details.","title":"More Extensions in Serverless Application Repository (SAR)"},{"location":"extension-repository/overview/","text":"The solution provides a set of ready-to-use extensions (Lambda@Edge functions, CloudFront functions, CloudFormation templates) that could be useful when you use CloudFront. You can deploy them from the solution web console. After deployment, you can directly use it without programming or customize it when needed. You can use the following extensions: True Client IP Pre-warming Redirect by Country More extensions in Serverless Application Repository (SAR)","title":"Overview"},{"location":"extension-repository/pre-warming/","text":"What is Pre-warming? Pre-warming is also known as Pre-caching or Pre-fetching. It speeds up content delivery by warming the CloudFront cache. This is very useful when delivering large files. Pre-warming helps offload origin\u2019s traffic, as the same requests will hit the CloudFront cache, origin server receives less requests and consequently it's less likely that the origin server will fall over or become slow. How does it work? The solution deploys a CloudFormation template, that will install the below architecture in your AWS account. All the cloud resources will be automatically created. After deployed, you will get two REST APIs, one for triggering pre-warm action, the other one for getting pre-warm status. The CloudFormation template provides the following components and workflows: Scheduler Lambda function inserts initial pre-warm status into the DynamoDB table and invokes cache invalidator. Cache invalidator Lambda function invalidates CloudFront caches for all the URLs and sends messages with requestId, PoP and URLs, and so on into SQS. CloudWatch alarm monitors the messages in the queue and notifies the auto scaling group to scale out when messages are sent into the queue. Auto scaling group contains EC2 spot instances. Each instance sends requests to the edge locations and updates the prewarm status into DynamoDB table after consuming the messages from the SQS queue. StatusFetcher function gets the prewarm status from the DynamoDB table. Deployment on the web console (Recommended) The steps to deploy the extensions from the web console are similar. For more information, refer to the section True Client IP . Deployment via CloudFormation Time to deploy : Approximately 10 minutes Deployment overview Use the following steps to deploy this solution on AWS. Launch the CloudFormation template into your AWS account. Review the template parameters, and adjust them if necessary. Deployment steps Sign in to the AWS Management Console and select the button to launch the CloudFormation template. You can also download the template as a starting point for your own implementation. The template launches in the US East (N. Virginia) Region by default. To launch the solution in a different AWS Region, use the Region selector in the console navigation bar. Under Parameters, review the parameters for the template, and modify them as necessary. Parameter Default value Description ShowSuccessUrls false Show success url list in Prewarm status API (true or false). InstanceType m6g.large EC2 spot instance type to send pre-warm requests. ThreadNumber 6 Thread number to run in parallel in EC2. Choose Next . On the Configure stack options page, you can specify tags (key-value pairs) for resources in your stack and set additional options, and then choose Next . On the Review page, review and confirm the settings. Check the boxes acknowledging that the template will create AWS Identity and Access Management (IAM) resources and any additional capabilities required. Choose Create to deploy the stack. You can view the status of the stack in the CloudFormation Console in the Status column. You should receive a CREATE_COMPLETE status in approximately 10 minutes. To see details for the stack resources, choose the Outputs tab.","title":"Pre-warming"},{"location":"extension-repository/pre-warming/#what-is-pre-warming","text":"Pre-warming is also known as Pre-caching or Pre-fetching. It speeds up content delivery by warming the CloudFront cache. This is very useful when delivering large files. Pre-warming helps offload origin\u2019s traffic, as the same requests will hit the CloudFront cache, origin server receives less requests and consequently it's less likely that the origin server will fall over or become slow.","title":"What is Pre-warming?"},{"location":"extension-repository/pre-warming/#how-does-it-work","text":"The solution deploys a CloudFormation template, that will install the below architecture in your AWS account. All the cloud resources will be automatically created. After deployed, you will get two REST APIs, one for triggering pre-warm action, the other one for getting pre-warm status. The CloudFormation template provides the following components and workflows: Scheduler Lambda function inserts initial pre-warm status into the DynamoDB table and invokes cache invalidator. Cache invalidator Lambda function invalidates CloudFront caches for all the URLs and sends messages with requestId, PoP and URLs, and so on into SQS. CloudWatch alarm monitors the messages in the queue and notifies the auto scaling group to scale out when messages are sent into the queue. Auto scaling group contains EC2 spot instances. Each instance sends requests to the edge locations and updates the prewarm status into DynamoDB table after consuming the messages from the SQS queue. StatusFetcher function gets the prewarm status from the DynamoDB table.","title":"How does it work?"},{"location":"extension-repository/pre-warming/#deployment-on-the-web-console-recommended","text":"The steps to deploy the extensions from the web console are similar. For more information, refer to the section True Client IP .","title":"Deployment on the web console (Recommended)"},{"location":"extension-repository/pre-warming/#deployment-via-cloudformation","text":"Time to deploy : Approximately 10 minutes","title":"Deployment via CloudFormation"},{"location":"extension-repository/pre-warming/#deployment-overview","text":"Use the following steps to deploy this solution on AWS. Launch the CloudFormation template into your AWS account. Review the template parameters, and adjust them if necessary.","title":"Deployment overview"},{"location":"extension-repository/pre-warming/#deployment-steps","text":"Sign in to the AWS Management Console and select the button to launch the CloudFormation template. You can also download the template as a starting point for your own implementation. The template launches in the US East (N. Virginia) Region by default. To launch the solution in a different AWS Region, use the Region selector in the console navigation bar. Under Parameters, review the parameters for the template, and modify them as necessary. Parameter Default value Description ShowSuccessUrls false Show success url list in Prewarm status API (true or false). InstanceType m6g.large EC2 spot instance type to send pre-warm requests. ThreadNumber 6 Thread number to run in parallel in EC2. Choose Next . On the Configure stack options page, you can specify tags (key-value pairs) for resources in your stack and set additional options, and then choose Next . On the Review page, review and confirm the settings. Check the boxes acknowledging that the template will create AWS Identity and Access Management (IAM) resources and any additional capabilities required. Choose Create to deploy the stack. You can view the status of the stack in the CloudFormation Console in the Status column. You should receive a CREATE_COMPLETE status in approximately 10 minutes. To see details for the stack resources, choose the Outputs tab.","title":"Deployment steps"},{"location":"extension-repository/redirect-by-country/","text":"What is Redirect by Country? If you need to redirect your website user to a country-specific site based on the country of the user, you can deploy this extension. For example, if the user is located in Germany, a CloudFront function modifies the URL in request and redirects the user to the /de/index.html page, which is the Germany-specific version of the website. This function is building the whole URL (https://host/de/index.html) to redirect. How does it work? This extension makes use of the Cloudfront-Viewer-Country geo-location header which performs a lookup on the request to determine the user's country and includes that value in the Cloudfront-Viewer-Country request header. You can use any of the geo-location or device detection headers that are available from CloudFront. For the geo-location or device detection headers to appear in the request object within a function, you must allow these headers (or allow all viewer headers) in a CloudFront origin request policy or cache policy . The solution deploys a CloudFormation template that does the following: Deploy a CloudFront Functions named \u201credirect-by-country\u201d on your selected CloudFront distribution\u2019s behaviors. Create a CloudFront origin request policy named \"redirect-by-country\" that adds \"cloudfront-viewer-country\" header to the allowed header list. Add \"redirect-by-country\" origin request policy automatically to the CloudFront distribution's behaviors. Important If the CloudFront distribution already has an AWS origin request policy, then you need manually add it in the origin request policy. CloudFront Stage Viewer request Deployment on the web console (Recommended) The steps to deploy the extensions from the web console are similar. For more information, refer to the section True Client IP .","title":"Redirect by Country"},{"location":"extension-repository/redirect-by-country/#what-is-redirect-by-country","text":"If you need to redirect your website user to a country-specific site based on the country of the user, you can deploy this extension. For example, if the user is located in Germany, a CloudFront function modifies the URL in request and redirects the user to the /de/index.html page, which is the Germany-specific version of the website. This function is building the whole URL (https://host/de/index.html) to redirect.","title":"What is Redirect by Country?"},{"location":"extension-repository/redirect-by-country/#how-does-it-work","text":"This extension makes use of the Cloudfront-Viewer-Country geo-location header which performs a lookup on the request to determine the user's country and includes that value in the Cloudfront-Viewer-Country request header. You can use any of the geo-location or device detection headers that are available from CloudFront. For the geo-location or device detection headers to appear in the request object within a function, you must allow these headers (or allow all viewer headers) in a CloudFront origin request policy or cache policy . The solution deploys a CloudFormation template that does the following: Deploy a CloudFront Functions named \u201credirect-by-country\u201d on your selected CloudFront distribution\u2019s behaviors. Create a CloudFront origin request policy named \"redirect-by-country\" that adds \"cloudfront-viewer-country\" header to the allowed header list. Add \"redirect-by-country\" origin request policy automatically to the CloudFront distribution's behaviors. Important If the CloudFront distribution already has an AWS origin request policy, then you need manually add it in the origin request policy.","title":"How does it work?"},{"location":"extension-repository/redirect-by-country/#cloudfront-stage","text":"Viewer request","title":"CloudFront Stage"},{"location":"extension-repository/redirect-by-country/#deployment-on-the-web-console-recommended","text":"The steps to deploy the extensions from the web console are similar. For more information, refer to the section True Client IP .","title":"Deployment on the web console (Recommended)"},{"location":"extension-repository/true-client-ip/","text":"You can get the client IP by reading the True-Client-IP header in your origin server. What is True Client IP Extension? If your origin server needs to get the client\u2019s IP address, you can use this extension. The extension automatically adds an HTTP header named \u201cTrue-Client-IP\u201d in your request. With this header, the request can contain the IP address of the client that sent the request. Without this header, the request by default contains the IP address of the CloudFront server that sent the request to your origin. How does it work? The solution deploys a CloudFormation template that does the following: Install a CloudFront Function named \u201ctrue-client-ip\u201d on your selected CloudFront distribution\u2019s behaviors. Create a CloudFront origin request policy named \u201ctrue-client-ip\u201d that add this header to the allowed header list. Attach the policy to the above distribution. Important If the CloudFront distribution already has an AWS built-in policy attached, you need to manually add the created policy to the attachment. Note You don't have to use the header name True-Client-IP. You can change the name to any value that your origin requires (e.g. X-Real-IP). CloudFront also sends an X-Forwarded-For header to your origin, which contains the client's IP address along with any HTTP proxies or load balancers that the request passed through. CloudFront Stage Viewer request Deployment on the web console (Recommended) Log in to the web console. In the left sidebar, select Extensions repository . Select true-client-ip from the Extensions list, and click Deploy in the upper right corner. Choose a Distribution where you want to deploy this CloudFront extension. Choose a Behavior , and choose Next . Choose a CloudFront stage, and choose Next . Review the parameters and choose Deploy . Follow the guidance on the web console to check deployment status on CloudFormation console.","title":"True Client IP"},{"location":"extension-repository/true-client-ip/#what-is-true-client-ip-extension","text":"If your origin server needs to get the client\u2019s IP address, you can use this extension. The extension automatically adds an HTTP header named \u201cTrue-Client-IP\u201d in your request. With this header, the request can contain the IP address of the client that sent the request. Without this header, the request by default contains the IP address of the CloudFront server that sent the request to your origin.","title":"What is True Client IP Extension?"},{"location":"extension-repository/true-client-ip/#how-does-it-work","text":"The solution deploys a CloudFormation template that does the following: Install a CloudFront Function named \u201ctrue-client-ip\u201d on your selected CloudFront distribution\u2019s behaviors. Create a CloudFront origin request policy named \u201ctrue-client-ip\u201d that add this header to the allowed header list. Attach the policy to the above distribution. Important If the CloudFront distribution already has an AWS built-in policy attached, you need to manually add the created policy to the attachment. Note You don't have to use the header name True-Client-IP. You can change the name to any value that your origin requires (e.g. X-Real-IP). CloudFront also sends an X-Forwarded-For header to your origin, which contains the client's IP address along with any HTTP proxies or load balancers that the request passed through.","title":"How does it work?"},{"location":"extension-repository/true-client-ip/#cloudfront-stage","text":"Viewer request","title":"CloudFront Stage"},{"location":"extension-repository/true-client-ip/#deployment-on-the-web-console-recommended","text":"Log in to the web console. In the left sidebar, select Extensions repository . Select true-client-ip from the Extensions list, and click Deploy in the upper right corner. Choose a Distribution where you want to deploy this CloudFront extension. Choose a Behavior , and choose Next . Choose a CloudFront stage, and choose Next . Review the parameters and choose Deploy . Follow the guidance on the web console to check deployment status on CloudFormation console.","title":"Deployment on the web console (Recommended)"},{"location":"monitoring/metrics-dashboard/","text":"Metrics dashboard Metrics dashboard is customizable time range for Non-real time or Real time monitoring that you can use to track CloudFront traffic graphical metrics in a single dashboard. The dashboard uses CloudFront standard log or realtime log to get the metrics. The solution provides a metric API if you only need to get the metric data via RESTful API and don't need the dashboard. With the Metrics dashboard, you can do the following: View graphed metrics The CloudFront monitoring dashboard displays multiple metrics in each graphical chart for you to reference. Each chart related |one metric in CloudFront Monitoring API. Note The Graphed metrics type in the dashboard are the same with the CloudFront Monitoring API acquisition type when deploy the solution. Please see metrics description in the below list CloudFront Monitoring API Type Description Window Time Real time traffic metrics Realtime log for CloudFront distribution with 5-min delay 5 minutes Non-real time traffic metrics Non-Realtime log for CloudFront distribution with 1-hour delay 5 minutes You can navigate to the CloudFront monitoring dashboard from the left sidebar of the Web Console under Monitoring, and click distribution (you can find it by CNAMEs) that you want to view in the distribution list and specify a time period in the time picker. The traffic metrics will be show in the graphical charts in the dashboard. Setup monitoring domain list The monitoring domain list includes all tracked CloudFront distributions, this list can be configured in the CloudFormation template parameter during deployment, see Deployment . Once the CloudFormation stack deployed, you can set up/update the domain list in the Metrics dashboard web console. Note If you use 'ALL' to monitoring all domains in your AWS account in the deployment parameter, the update domain list function will override this setting if you change the selection in the dashboard. Log in to the web console. In the left sidebar, under monitoring, select CloudFront. Click 'Update Domain List' to open the configuration window. In the pop-up window, select existing CloudFront distributions that you want to add the monitoring list. Choose Apply. When the domain list changed, the distributions list in the dashboard will be updated accordingly, the tracked metrics will be displayed in the charts in about 5 minutes.","title":"Metrics Dashboard"},{"location":"monitoring/metrics-dashboard/#metrics-dashboard","text":"Metrics dashboard is customizable time range for Non-real time or Real time monitoring that you can use to track CloudFront traffic graphical metrics in a single dashboard. The dashboard uses CloudFront standard log or realtime log to get the metrics. The solution provides a metric API if you only need to get the metric data via RESTful API and don't need the dashboard. With the Metrics dashboard, you can do the following: View graphed metrics The CloudFront monitoring dashboard displays multiple metrics in each graphical chart for you to reference. Each chart related |one metric in CloudFront Monitoring API. Note The Graphed metrics type in the dashboard are the same with the CloudFront Monitoring API acquisition type when deploy the solution. Please see metrics description in the below list CloudFront Monitoring API Type Description Window Time Real time traffic metrics Realtime log for CloudFront distribution with 5-min delay 5 minutes Non-real time traffic metrics Non-Realtime log for CloudFront distribution with 1-hour delay 5 minutes You can navigate to the CloudFront monitoring dashboard from the left sidebar of the Web Console under Monitoring, and click distribution (you can find it by CNAMEs) that you want to view in the distribution list and specify a time period in the time picker. The traffic metrics will be show in the graphical charts in the dashboard. Setup monitoring domain list The monitoring domain list includes all tracked CloudFront distributions, this list can be configured in the CloudFormation template parameter during deployment, see Deployment . Once the CloudFormation stack deployed, you can set up/update the domain list in the Metrics dashboard web console. Note If you use 'ALL' to monitoring all domains in your AWS account in the deployment parameter, the update domain list function will override this setting if you change the selection in the dashboard. Log in to the web console. In the left sidebar, under monitoring, select CloudFront. Click 'Update Domain List' to open the configuration window. In the pop-up window, select existing CloudFront distributions that you want to add the monitoring list. Choose Apply. When the domain list changed, the distributions list in the dashboard will be updated accordingly, the tracked metrics will be displayed in the charts in about 5 minutes.","title":"Metrics dashboard"},{"location":"monitoring/non-real-time-monitoring/","text":"If you selected Non-real time monitoring when deploying the solution, the following architecture will be installed automatically to create the cloud resources in your account. Enable CloudFront standard logs. You need to specify a S3 bucket to store CloudFront standard logs. Remove unused fields in CloudFront standard logs and partition logs in S3 bucket. CloudFront standard logs contains more than 30 fields, and less than 10 fields are needed for getting CloudFront metrics. AWS Lambda function will read the logs in the S3 bucket and remove the unused fields to reduce the size of the log file. It can improve Athena query speed and save costs as well. AWS Lambda function will also move the logs into the folder for partition, such as year=2022/month=07/day=10/hour=09/. Query standard logs in S3 via Athena. In order to allow Athena to speed up data query through data partitioning, Amazon EventBridge will create all partitions for the next day every day, and delete the partitions of the previous day. The Lambda function MetricCollector is used to analyze standard logs and collect monitoring metrics. It will be executed every 5 minutes. Save the query results in DynamoDB. Query the corresponding monitoring indicator data through Athena, such as calculating CHR (cache hit rate) and download rate through bandwidth, and finally store the monitoring indicator data in the DynamoDB table. Call APIs via API Gateway. When users send API request to API Gateway, a Lambda function called MetricManager will be triggered. The function reads the monitoring indicators and returns the corresponding results from the DynamoDB table. In order to strengthen security management and restrict API accesses, API key is enabled in API Gateway by default. Users are required to pass an x-api-key when calling the APIs. Metrics The following metrics are provided: request: the number of requests from the client to CloudFront requestOrigin: the number of requests back to the origin statusCode: the status code from the client to CloudFront statusCodeOrigin: the status code of the back-to-origin bandwidth: the bandwidth from the client to CloudFront bandwidthOrigin: bandwidth back to origin chr: cache hit rate calculated by the number of requests chrBandWith: cache hit ratio calculated by bandwidth topNUrlRequests: top url calculated by the number of requests topNUrlSize: top url calculated by traffic downstreamTraffic: down stream traffic in response to the request","title":"Non-real time monitoring with Amazon S3 Standard Logs"},{"location":"monitoring/non-real-time-monitoring/#metrics","text":"The following metrics are provided: request: the number of requests from the client to CloudFront requestOrigin: the number of requests back to the origin statusCode: the status code from the client to CloudFront statusCodeOrigin: the status code of the back-to-origin bandwidth: the bandwidth from the client to CloudFront bandwidthOrigin: bandwidth back to origin chr: cache hit rate calculated by the number of requests chrBandWith: cache hit ratio calculated by bandwidth topNUrlRequests: top url calculated by the number of requests topNUrlSize: top url calculated by traffic downstreamTraffic: down stream traffic in response to the request","title":"Metrics"},{"location":"monitoring/overview/","text":"Monitoring The solution provides two kinds of monitoring: non-real time monitoring and real time monitoring. You can choose one of them to deploy. You can use the solution to view CloudFront traffic metrics via built-in dashboard or via API calls. Non-real time monitoring with Amazon S3 Standard Logs Real time monitoring with Amazon Kinesis Metrics dashboard","title":"Overview"},{"location":"monitoring/overview/#monitoring","text":"The solution provides two kinds of monitoring: non-real time monitoring and real time monitoring. You can choose one of them to deploy. You can use the solution to view CloudFront traffic metrics via built-in dashboard or via API calls. Non-real time monitoring with Amazon S3 Standard Logs Real time monitoring with Amazon Kinesis Metrics dashboard","title":"Monitoring"},{"location":"monitoring/real-time-monitoring/","text":"If you selected Real time monitoring when deploying the solution (CloudFormation stack), the following architecture will be installed, and the corresponding cloud resources will be automatically created in your account. Enable CloudFront real-time logs. You need to configure the corresponding data stream in Kinesis Data Stream. Set up Kinesis Data Firehose to complete data transfer quickly. This enables CloudFront's real-time logs to pass through Kinesis Data Stream and finally store them in S3 buckets through Kinesis Data Firehose. During this process, to monitor the download speed in each country and each ISP, Kinesis Data Firehose invokes the Amazon Lambda function Log Transformer to find the ISP and country code through the client IP, and cooperate with Kinesis Data Firehose to implement dynamic partitioning, that is, real-time logs are partitioned by partition key and stored in S3 bucket, such as year=2021/month=12/day=10/hour=09. Query real-time logs in S3 via Athena. In order to allow Athena to speed up data query through data partitioning, Amazon EventBridge will create all partitions for the next day every day, and delete the partitions of the previous day. The Lambda function MetricCollector is used to analyze real-time logs and collect monitoring metrics. It will be executed every 5 minutes. Save the query results in DynamoDB. Query the corresponding monitoring indicator data through Athena, such as calculating CHR (cache hit rate) and download rate through bandwidth, and finally store the monitoring indicator data in the DynamoDB table. Call APIs via API Gateway. When users send API request to API Gateway, a Lambda function called MetricManager will be triggered. The function reads the monitoring indicators and returns the corresponding results from the DynamoDB table. In order to strengthen security management and restrict API accesses, API key is enabled in API Gateway by default. Users are required to pass an x-api-key when calling the APIs. Active monitoring Open the CloudFront console to enable the Real-time configurations under Logs setting tab. Click Create configuration button to open configuration settings, input 100 in the Sampling rate field and all fields. PLEASE choose the fields by the default order Choose the cloudfront-real-time-log-data-stream in the Endpoint field. In Distributions select the distribution and in the Cache behaviors select Default(*) . Metrics The following metrics are provided: request: the number of requests from the client to CloudFront requestOrigin: the number of requests back to the origin statusCode: the status code from the client to CloudFront statusCodeOrigin: the status code of the back-to-origin bandwidth: the bandwidth from the client to CloudFront bandwidthOrigin: bandwidth back to origin chr: cache hit rate calculated by the number of requests chrBandWith: cache hit ratio calculated by bandwidth downloadSpeed: download speed from client to CloudFront downloadSpeedOrigin: the download speed of the back-to-origin topNUrlRequests: top url calculated by the number of requests topNUrlSize: top url calculated by traffic downstreamTraffic: down stream traffic in response to the request","title":"Real time monitoring with Amazon Kinesis"},{"location":"monitoring/real-time-monitoring/#active-monitoring","text":"Open the CloudFront console to enable the Real-time configurations under Logs setting tab. Click Create configuration button to open configuration settings, input 100 in the Sampling rate field and all fields. PLEASE choose the fields by the default order Choose the cloudfront-real-time-log-data-stream in the Endpoint field. In Distributions select the distribution and in the Cache behaviors select Default(*) .","title":"Active monitoring"},{"location":"monitoring/real-time-monitoring/#metrics","text":"The following metrics are provided: request: the number of requests from the client to CloudFront requestOrigin: the number of requests back to the origin statusCode: the status code from the client to CloudFront statusCodeOrigin: the status code of the back-to-origin bandwidth: the bandwidth from the client to CloudFront bandwidthOrigin: bandwidth back to origin chr: cache hit rate calculated by the number of requests chrBandWith: cache hit ratio calculated by bandwidth downloadSpeed: download speed from client to CloudFront downloadSpeedOrigin: the download speed of the back-to-origin topNUrlRequests: top url calculated by the number of requests topNUrlSize: top url calculated by traffic downstreamTraffic: down stream traffic in response to the request","title":"Metrics"}]}