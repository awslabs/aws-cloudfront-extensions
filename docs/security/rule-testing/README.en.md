---
title: Web ACLs and Managed Rules 
weight: 3
---

In this step of the workshop, you will see how the AWS WAF protects against common attacks, such as SQL injection or Command Line attacks.

## Introduction
### Web ACLs
A [web ACL (Web Access Control List)](https://docs.aws.amazon.com/waf/latest/developerguide/web-acl.html) is the core resource in an AWS WAF deployment. It contains rules that are evaluated for each request that it receives. [A web ACL is associated to your web application](https://docs.aws.amazon.com/waf/latest/developerguide/web-acl-associating-aws-resource.html) via either an Amazon CloudFront distribution, AWS API Gateway API or an AWS Application Load Balancer.

### Managed Rules
In the AWS WAF & Shield console, you will see there are a set of pre-configured rules, these rules provide protection against common types of attacks.
![Managed Rules](/images/managed_rules.png?width=50pc)


SQL Injection and XSS are two common attacks. The WAF & Shield Automations solution creates rules in AWS WAF to deny requests that contain SQL Injection or XSS. Let's try two attacks against the Juice Shop web application to demonstrate.

## SQL Injection protection
Attackers insert malicious SQL code into web requests in an effort to extract data from your database. This solution is designed to block web requests that contain potentially malicious SQL code.

1) First, you can find the `JuiceShopUrl` variable in the WAFWorkshopSampleWebApp stack in the AWS CloudFormation console and open it in your browser, you will see the Juice Shop site:
![JUICE SHOP MAIN](/images/juice_shop_main.png?width=50pc)

2) Go to the Login page via the ‘Account’ button in the top area of the Juice Shop web page.
Try to use `' OR true--` in the ‘Email’ field with any password and click the ‘Log in’ button, you will receive an HTML response stating the request was forbidden(403):
![SQL BLOCK](/images/sql_block.png?width=30pc)

3) Compare to open the official Juice Shop demo site: https://demo.owasp-juice.shop/ and use the same Email/Password to login, you will login success without any blocking.

## Cross-Site Scripting (XSS) protection
Also known as XSS, attackers use vulnerabilities in a benign website as a vehicle to inject malicious client-site scripts into a legitimate user’s web browser. This solution is designed to inspect commonly explored elements of incoming requests to identify and block XSS attacks.

You can test the XSS protection rule with the command below.

    # This imitates a Cross-Site Scripting attack
    # This request should be blocked.
    curl -X POST http://*********.cloudfront.net -F "<iframe src='javascript:alert(xss)'>"

If a request is blocked, you will receive an HTML response stating the request was forbidden. Here’s a snippet of what to expect

    <!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
    <HTML><HEAD><META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=iso-8859-1">
    <TITLE>ERROR: The request could not be satisfied</TITLE>
    </HEAD><BODY>
    <H1>403 ERROR</H1>
    <H2>The request could not be satisfied.</H2>
    <HR noshade size="1px">
    Request blocked.
    We can't connect to the server for this app or website at this time. There might be too much traffic or a configuration error. Try again later, or contact the app or website owner.
    <BR clear="all">
    If you provide content to customers through CloudFront, you can find steps to troubleshoot and help prevent this error by reviewing the CloudFront documentation.
    <BR clear="all">
    <HR noshade size="1px">
    <PRE>
    Generated by cloudfront (CloudFront)
    Request ID: Lgu2bFNEeSihV-XqkrxO7ObnLb6NkLbxiGhctzZVyQ-pQzvYWmEssA==
    </PRE>
    <ADDRESS>
    </ADDRESS>
    </BODY></HTML>%